{
    "sourceFile": "app/homedriver/dprofile.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 61,
            "patches": [
                {
                    "date": 1748350667311,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1748350714642,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,10 +10,10 @@\n         <Text>Passenger Profile Page</Text>\r\n         <View style={styles.bottomNav}>\r\n             <TouchableOpacity onPress={() => router.push(\"/homedriver/dhome\")}><Ionicons name=\"home-outline\" size={30} color=\"black\" /><Text>Home</Text></TouchableOpacity>\r\n             <TouchableOpacity onPress={() => router.push(\"/homedriver/dhistory\")}><Ionicons name=\"document-text-outline\" size={30} color=\"black\" /><Text>History</Text></TouchableOpacity>\r\n-            <TouchableOpacity onPress={() => router.push(\"/homedriver/dchats\")}><Ionicons name=\"chatbubbles\" size={30} color=\"black\" /><Text>Chats</Text></TouchableOpacity>\r\n-            <TouchableOpacity onPress={() => router.push(\"/homedriver/dprofile\")}><Ionicons name=\"person-outline\" size={30} color=\"black\" /><Text>Profile</Text></TouchableOpacity>\r\n+            <TouchableOpacity onPress={() => router.push(\"/homedriver/dchats\")}><Ionicons name=\"chatbubbles-outline\" size={30} color=\"black\" /><Text>Chats</Text></TouchableOpacity>\r\n+            <TouchableOpacity onPress={() => router.push(\"/homedriver/dprofile\")}><Ionicons name=\"person\" size={30} color=\"black\" /><Text>Profile</Text></TouchableOpacity>\r\n         </View>\r\n     </View>\r\n   );\r\n }\r\n"
                },
                {
                    "date": 1748448823236,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,273 @@\n+import React, { useState } from \"react\";\r\n+import { View, Text, StyleSheet, Dimensions, TouchableOpacity, Image, Alert, Platform, ActionSheetIOS } from \"react-native\";\r\n+import { Ionicons, MaterialIcons } from \"@expo/vector-icons\";\r\n+import { router } from 'expo-router';\r\n+import AsyncStorage from '@react-native-async-storage/async-storage';\r\n+import * as ImagePicker from \"expo-image-picker\";\r\n+import { ImagePickerAsset } from \"expo-image-picker\";\r\n+import { API_BASE_URL } from \"../../config\";\r\n+import { useFocusEffect } from \"@react-navigation/native\";\r\n+\r\n+const { width } = Dimensions.get(\"window\");\r\n+\r\n+export default function DProfile() {\r\n+  const [profile, setProfile] = useState<any>(null);\r\n+  const [profileImage, setProfileImage] = useState<ImagePickerAsset | null>(null);\r\n+\r\n+  const fetchProfile = async () => {\r\n+    try {\r\n+      const driverId = await AsyncStorage.getItem(\"driverId\");\r\n+      if (!driverId) return;\r\n+      const response = await fetch(`${API_BASE_URL}/api/driver/${driverId}`);\r\n+      const result = await response.json();\r\n+      if (result.driver) setProfile(result.driver);\r\n+    } catch (error) {\r\n+      console.error(\"❌ Failed to fetch driver profile:\", error);\r\n+    }\r\n+  };\r\n+\r\n+  useFocusEffect(\r\n+    React.useCallback(() => {\r\n+      fetchProfile();\r\n+    }, [])\r\n+  );\r\n+\r\n+  const pickSelfieImage = async () => {\r\n+    if (Platform.OS === \"ios\") {\r\n+      ActionSheetIOS.showActionSheetWithOptions(\r\n+        {\r\n+          options: [\"Take a Photo\", \"Choose from Gallery\", \"Cancel\"],\r\n+          cancelButtonIndex: 2,\r\n+        },\r\n+        async (buttonIndex) => {\r\n+          if (buttonIndex === 0) {\r\n+            const result = await ImagePicker.launchCameraAsync({\r\n+              mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n+              allowsEditing: true,\r\n+              quality: 1,\r\n+            });\r\n+            if (!result.canceled && result.assets.length > 0) {\r\n+              setProfileImage(result.assets[0]);\r\n+            }\r\n+          } else if (buttonIndex === 1) {\r\n+            const result = await ImagePicker.launchImageLibraryAsync({\r\n+              mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n+              allowsEditing: true,\r\n+              quality: 1,\r\n+            });\r\n+            if (!result.canceled && result.assets.length > 0) {\r\n+              setProfileImage(result.assets[0]);\r\n+            }\r\n+          }\r\n+        }\r\n+      );\r\n+    } else {\r\n+      Alert.alert(\"Select Option\", \"\", [\r\n+        {\r\n+          text: \"Take a Photo\", onPress: async () => {\r\n+            const result = await ImagePicker.launchCameraAsync({\r\n+              mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n+              allowsEditing: true,\r\n+              quality: 1,\r\n+            });\r\n+            if (!result.canceled && result.assets.length > 0) {\r\n+              setProfileImage(result.assets[0]);\r\n+            }\r\n+          }\r\n+        },\r\n+        {\r\n+          text: \"Choose from Gallery\", onPress: async () => {\r\n+            const result = await ImagePicker.launchImageLibraryAsync({\r\n+              mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n+              allowsEditing: true,\r\n+              quality: 1,\r\n+            });\r\n+            if (!result.canceled && result.assets.length > 0) {\r\n+              setProfileImage(result.assets[0]);\r\n+            }\r\n+          }\r\n+        },\r\n+        { text: \"Cancel\", style: \"cancel\" },\r\n+      ]);\r\n+    }\r\n+  };\r\n+\r\n+  const handleUploadSelfie = async () => {\r\n+    if (!profileImage) {\r\n+      Alert.alert(\"Error\", \"Please select an image first.\");\r\n+      return;\r\n+    }\r\n+    try {\r\n+      const driverId = await AsyncStorage.getItem(\"driverId\");\r\n+      if (!driverId) return;\r\n+      const formData = new FormData();\r\n+      formData.append(\"profileImage\", {\r\n+        uri: profileImage.uri,\r\n+        name: \"profile.jpg\",\r\n+        type: \"image/jpeg\",\r\n+      } as any);\r\n+      const res = await fetch(`${API_BASE_URL}/api/auth/driver/${driverId}/update-profile-image`, {\r\n+        method: \"PATCH\",\r\n+        body: formData,\r\n+      });\r\n+      if (res.ok) {\r\n+        Alert.alert(\"Success\", \"Profile image updated!\");\r\n+        const updatedProfile = await res.json();\r\n+        setProfile(updatedProfile.driver);\r\n+        setProfileImage(null);\r\n+      } else {\r\n+        Alert.alert(\"Error\", \"Failed to upload image.\");\r\n+      }\r\n+    } catch (error) {\r\n+      console.error(\"❌ Upload error:\", error);\r\n+      Alert.alert(\"Error\", \"Something went wrong. Try again.\");\r\n+    }\r\n+  };\r\n+\r\n+  const handleLogout = async () => {\r\n+    try {\r\n+      await AsyncStorage.removeItem(\"driverId\");\r\n+      Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n+      router.replace(\"../login_and_reg/dlogin\");\r\n+    } catch (error) {\r\n+      console.error(\"❌ Logout error:\", error);\r\n+      Alert.alert(\"Error\", \"Failed to log out. Try again.\");\r\n+    }\r\n+  };\r\n+\r\n+  // For drivers, show driver info (modify the fields as per your Driver model)\r\n+  return (\r\n+    <View style={styles.container}>\r\n+      <View style={styles.profileContainer}>\r\n+        <View style={styles.row}>\r\n+          <TouchableOpacity onPress={pickSelfieImage}>\r\n+            <Image\r\n+              source={\r\n+                profileImage\r\n+                  ? { uri: profileImage.uri }\r\n+                  : profile?.profileImage\r\n+                    ? { uri: `${API_BASE_URL}/${profile.profileImage.replace(/\\\\/g, \"/\")}` }\r\n+                    : require(\"../../assets/images/profile-placeholder.jpg\")\r\n+              }\r\n+              style={styles.profileImage}\r\n+            />\r\n+          </TouchableOpacity>\r\n+          <Text style={styles.username}>\r\n+            {profile?.firstName || \"\"} {profile?.lastName || \"\"}\r\n+          </Text>\r\n+        </View>\r\n+        <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n+          <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n+          <Text style={styles.lagout}>LogOut</Text>\r\n+        </TouchableOpacity>\r\n+        {profileImage && (\r\n+          <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n+            <Text style={{ color: \"#fff\" }}>Upload New Profile Image</Text>\r\n+          </TouchableOpacity>\r\n+        )}\r\n+      </View>\r\n+\r\n+      <View style={styles.accountContainer}>\r\n+        <Text style={styles.sectionTitle}>My Account</Text>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Full Name:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[\r\n+              styles.value,\r\n+              { color: (profile?.firstName || profile?.middleName || profile?.lastName) ? \"#000\" : \"#999\" },\r\n+            ]}>\r\n+              {profile?.firstName || \"\"} {profile?.middleName || \"\"} {profile?.lastName || \"\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Gender:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.gender ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.gender || \"Set Now\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Age:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.age ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.age || \"Set Now\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Contact Number:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.contact ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.contact || \"Set Now\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Birthday:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.birthday ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.birthday ? profile.birthday.slice(0, 10) : \"Not Provided\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Email Address:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.email ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.email || \"Set Now\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>License Number:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.licenseId ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.licenseId || \"Set Now\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n+        {/* Add more driver-specific fields as needed! */}\r\n+      </View>\r\n+\r\n+      <View style={styles.bottomNav}>\r\n+        <TouchableOpacity onPress={() => router.push(\"/homedriver/dhome\")}><Ionicons name=\"home-outline\" size={30} color=\"black\" /><Text>Home</Text></TouchableOpacity>\r\n+        <TouchableOpacity onPress={() => router.push(\"/homedriver/dhistory\")}><Ionicons name=\"document-text-outline\" size={30} color=\"black\" /><Text>History</Text></TouchableOpacity>\r\n+        <TouchableOpacity onPress={() => router.push(\"/homedriver/dchats\")}><Ionicons name=\"chatbubbles-outline\" size={30} color=\"black\" /><Text>Chats</Text></TouchableOpacity>\r\n+        <TouchableOpacity onPress={() => router.push(\"/homedriver/dprofile\")}><Ionicons name=\"person\" size={30} color=\"black\" /><Text>Profile</Text></TouchableOpacity>\r\n+      </View>\r\n+    </View>\r\n+  );\r\n+}\r\n+\r\n+const styles = StyleSheet.create({\r\n+  container: { flex: 1, backgroundColor: \"#fff\" },\r\n+  profileContainer: { alignItems: \"center\", paddingTop: 50, flexDirection: \"row\", marginHorizontal: 20, justifyContent: \"space-between\" },\r\n+  profileImage: { width: 100, height: 100, borderRadius: 50, marginBottom: 10 },\r\n+  username: { fontSize: 18, fontWeight: \"bold\", marginBottom: 10, paddingLeft: 20 },\r\n+  lagout: { fontSize: 14, fontWeight: \"bold\" },\r\n+  uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n+  accountContainer: { marginTop: 20, paddingHorizontal: 20 },\r\n+  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginBottom: 10 },\r\n+  infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n+  row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n+  label: { fontSize: 14, color: \"#333\" },\r\n+  value: { fontSize: 14, color: \"#333\" },\r\n+  deleteButton: { flexDirection: \"row\", justifyContent: 'flex-end', alignItems: \"center\", marginTop: 20, width: width - 40 },\r\n+  bottomNav: { position: \"absolute\", bottom: 0, flexDirection: \"row\", justifyContent: \"space-around\", width: width, height: 70, backgroundColor: \"white\", borderTopLeftRadius: 30, borderTopRightRadius: 30, alignItems: \"center\", borderWidth: 1, borderColor: \"black\" },\r\n+});\r\n"
                },
                {
                    "date": 1748449542505,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,9 +11,9 @@\n const { width } = Dimensions.get(\"window\");\r\n \r\n export default function DProfile() {\r\n   const [profile, setProfile] = useState<any>(null);\r\n-  const [profileImage, setProfileImage] = useState<ImagePickerAsset | null>(null);\r\n+  const [selfieImage, setProfileImage] = useState<ImagePickerAsset | null>(null);\r\n \r\n   const fetchProfile = async () => {\r\n     try {\r\n       const driverId = await AsyncStorage.getItem(\"driverId\");\r\n@@ -92,18 +92,18 @@\n     }\r\n   };\r\n \r\n   const handleUploadSelfie = async () => {\r\n-    if (!profileImage) {\r\n+    if (!selfieImage) {\r\n       Alert.alert(\"Error\", \"Please select an image first.\");\r\n       return;\r\n     }\r\n     try {\r\n       const driverId = await AsyncStorage.getItem(\"driverId\");\r\n       if (!driverId) return;\r\n       const formData = new FormData();\r\n       formData.append(\"profileImage\", {\r\n-        uri: profileImage.uri,\r\n+        uri: selfieImage.uri,\r\n         name: \"profile.jpg\",\r\n         type: \"image/jpeg\",\r\n       } as any);\r\n       const res = await fetch(`${API_BASE_URL}/api/auth/driver/${driverId}/update-profile-image`, {\r\n@@ -142,12 +142,12 @@\n         <View style={styles.row}>\r\n           <TouchableOpacity onPress={pickSelfieImage}>\r\n             <Image\r\n               source={\r\n-                profileImage\r\n-                  ? { uri: profileImage.uri }\r\n-                  : profile?.profileImage\r\n-                    ? { uri: `${API_BASE_URL}/${profile.profileImage.replace(/\\\\/g, \"/\")}` }\r\n+                selfieImage\r\n+                  ? { uri: selfieImage.uri }\r\n+                  : profile?.selfieImage\r\n+                    ? { uri: `${API_BASE_URL}/${profile.selfieImage.replace(/\\\\/g, \"/\")}` }\r\n                     : require(\"../../assets/images/profile-placeholder.jpg\")\r\n               }\r\n               style={styles.profileImage}\r\n             />\r\n@@ -159,9 +159,9 @@\n         <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n           <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n           <Text style={styles.lagout}>LogOut</Text>\r\n         </TouchableOpacity>\r\n-        {profileImage && (\r\n+        {selfieImage && (\r\n           <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n             <Text style={{ color: \"#fff\" }}>Upload New Profile Image</Text>\r\n           </TouchableOpacity>\r\n         )}\r\n@@ -270,28 +270,4 @@\n   value: { fontSize: 14, color: \"#333\" },\r\n   deleteButton: { flexDirection: \"row\", justifyContent: 'flex-end', alignItems: \"center\", marginTop: 20, width: width - 40 },\r\n   bottomNav: { position: \"absolute\", bottom: 0, flexDirection: \"row\", justifyContent: \"space-around\", width: width, height: 70, backgroundColor: \"white\", borderTopLeftRadius: 30, borderTopRightRadius: 30, alignItems: \"center\", borderWidth: 1, borderColor: \"black\" },\r\n });\r\n-import React from 'react';\r\n-import { View, Text, StyleSheet, TouchableOpacity, Dimensions } from 'react-native';\r\n-import { Ionicons, MaterialIcons } from \"@expo/vector-icons\";\r\n-import { router } from 'expo-router'; \r\n-const { width, height } = Dimensions.get(\"window\");\r\n-\r\n-export default function PHistory() {\r\n-  return (\r\n-    <View style={styles.container}>\r\n-        <Text>Passenger Profile Page</Text>\r\n-        <View style={styles.bottomNav}>\r\n-            <TouchableOpacity onPress={() => router.push(\"/homedriver/dhome\")}><Ionicons name=\"home-outline\" size={30} color=\"black\" /><Text>Home</Text></TouchableOpacity>\r\n-            <TouchableOpacity onPress={() => router.push(\"/homedriver/dhistory\")}><Ionicons name=\"document-text-outline\" size={30} color=\"black\" /><Text>History</Text></TouchableOpacity>\r\n-            <TouchableOpacity onPress={() => router.push(\"/homedriver/dchats\")}><Ionicons name=\"chatbubbles-outline\" size={30} color=\"black\" /><Text>Chats</Text></TouchableOpacity>\r\n-            <TouchableOpacity onPress={() => router.push(\"/homedriver/dprofile\")}><Ionicons name=\"person\" size={30} color=\"black\" /><Text>Profile</Text></TouchableOpacity>\r\n-        </View>\r\n-    </View>\r\n-  );\r\n-}\r\n-\r\n-const styles = StyleSheet.create({\r\n-  container: { flex: 1, justifyContent: 'center', alignItems: 'center' },\r\n-  bottomNav: { position: \"absolute\", bottom: 0, flexDirection: \"row\", justifyContent: \"space-around\", width: width, height: 70, backgroundColor: \"white\", borderTopLeftRadius: 30, borderTopRightRadius: 30, alignItems: \"center\", borderWidth: 1, borderColor: \"black\" },\r\n-});\r\n"
                },
                {
                    "date": 1748454439783,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -152,9 +152,9 @@\n               style={styles.profileImage}\r\n             />\r\n           </TouchableOpacity>\r\n           <Text style={styles.username}>\r\n-            {profile?.firstName || \"\"} {profile?.lastName || \"\"}\r\n+            {profile?.driverFirstName || \"\"} {profile?.lastName || \"\"}\r\n           </Text>\r\n         </View>\r\n         <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n           <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n"
                },
                {
                    "date": 1748454449816,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -152,9 +152,9 @@\n               style={styles.profileImage}\r\n             />\r\n           </TouchableOpacity>\r\n           <Text style={styles.username}>\r\n-            {profile?.driverFirstName || \"\"} {profile?.lastName || \"\"}\r\n+            {profile?.driverFirstName || \"\"} {profile?.driverLastName || \"\"}\r\n           </Text>\r\n         </View>\r\n         <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n           <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n"
                },
                {
                    "date": 1748454488572,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -152,9 +152,9 @@\n               style={styles.profileImage}\r\n             />\r\n           </TouchableOpacity>\r\n           <Text style={styles.username}>\r\n-            {profile?.driverFirstName || \"\"} {profile?.driverLastName || \"\"}\r\n+            {profile?.driverFirstName || \"\"}{profile?.driverLastName || \"\"}\r\n           </Text>\r\n         </View>\r\n         <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n           <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n@@ -174,9 +174,9 @@\n           <Text style={styles.label}>Full Name:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[\r\n               styles.value,\r\n-              { color: (profile?.firstName || profile?.middleName || profile?.lastName) ? \"#000\" : \"#999\" },\r\n+              { color: (profile?.driverFirstName || profile?.driverMiddleName || profile?.lastName) ? \"#000\" : \"#999\" },\r\n             ]}>\r\n               {profile?.firstName || \"\"} {profile?.middleName || \"\"} {profile?.lastName || \"\"}\r\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n"
                },
                {
                    "date": 1748454502582,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -174,9 +174,9 @@\n           <Text style={styles.label}>Full Name:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[\r\n               styles.value,\r\n-              { color: (profile?.driverFirstName || profile?.driverMiddleName || profile?.lastName) ? \"#000\" : \"#999\" },\r\n+              { color: (profile?.driverFirstName || profile?.driverMiddleName || profile?.driverLastName) ? \"#000\" : \"#999\" },\r\n             ]}>\r\n               {profile?.firstName || \"\"} {profile?.middleName || \"\"} {profile?.lastName || \"\"}\r\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n"
                },
                {
                    "date": 1748454522297,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -176,9 +176,9 @@\n             <Text style={[\r\n               styles.value,\r\n               { color: (profile?.driverFirstName || profile?.driverMiddleName || profile?.driverLastName) ? \"#000\" : \"#999\" },\r\n             ]}>\r\n-              {profile?.firstName || \"\"} {profile?.middleName || \"\"} {profile?.lastName || \"\"}\r\n+              {profile?.driverFirstName || \"\"} {profile?.driverMiddleName || \"\"} {profile?.driverLastName || \"\"}\r\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n"
                },
                {
                    "date": 1748454631558,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -192,23 +192,23 @@\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n \r\n-        <View style={styles.infoRow}>\r\n+        {/* <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Age:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.age ? \"#000\" : \"#999\" }]}>\r\n               {profile?.age || \"Set Now\"}\r\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n-        </View>\r\n+        </View> */}\r\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Contact Number:</Text>\r\n           <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.contact ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.contact || \"Set Now\"}\r\n+            <Text style={[styles.value, { color: profile?.driverPhone ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.driverPhone || \"Set Now\"}\r\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n"
                },
                {
                    "date": 1748454667482,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -216,9 +216,9 @@\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Birthday:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.birthday ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.birthday ? profile.birthday.slice(0, 10) : \"Not Provided\"}\r\n+              {profile?.driverBirthday ? profile.driverBirthday.slice(0, 10) : \"Not Provided\"}\r\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n"
                },
                {
                    "date": 1748454694172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -215,10 +215,10 @@\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Birthday:</Text>\r\n           <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.birthday ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.driverBirthday ? profile.driverBirthday.slice(0, 10) : \"Not Provided\"}\r\n+            <Text style={[styles.value, { color: profile?.driverBirthdate ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.driverBirthdate ? profile.driverBirthdate.slice(0, 10) : \"Not Provided\"}\r\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n"
                },
                {
                    "date": 1748454710405,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -241,8 +241,18 @@\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>License Number:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.licenseId ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.licenseId || \"Set Now\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n         {/* Add more driver-specific fields as needed! */}\r\n       </View>\r\n \r\n       <View style={styles.bottomNav}>\r\n"
                },
                {
                    "date": 1748454721353,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -243,9 +243,9 @@\n           </View>\r\n         </View>\r\n \r\n         <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>License Number:</Text>\r\n+          <Text style={styles.label}>Francise Number:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.licenseId ? \"#000\" : \"#999\" }]}>\r\n               {profile?.licenseId || \"Set Now\"}\r\n             </Text>\r\n"
                },
                {
                    "date": 1748454854686,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -245,10 +245,10 @@\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Francise Number:</Text>\r\n           <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.licenseId ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.licenseId || \"Set Now\"}\r\n+            <Text style={[styles.value, { color: profile?.franchiseNumber ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.franchiseNumber || \"Set Now\"}\r\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n"
                },
                {
                    "date": 1748454917671,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -167,9 +167,9 @@\n         )}\r\n       </View>\r\n \r\n       <View style={styles.accountContainer}>\r\n-        <Text style={styles.sectionTitle}>My Account</Text>\r\n+        <Text style={styles.sectionTitle}>Personal Information</Text>\r\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Full Name:</Text>\r\n           <View style={styles.row}>\r\n@@ -251,8 +251,18 @@\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Francise Number:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.franchiseNumber ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.franchiseNumber || \"Set Now\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n         {/* Add more driver-specific fields as needed! */}\r\n       </View>\r\n \r\n       <View style={styles.bottomNav}>\r\n"
                },
                {
                    "date": 1748454931015,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -251,8 +251,10 @@\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n+        \r\n+        <Text style={styles.sectionTitle}>Personal Information</Text>\r\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Francise Number:</Text>\r\n           <View style={styles.row}>\r\n"
                },
                {
                    "date": 1748454953038,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -251,9 +251,9 @@\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n-        \r\n+\r\n         <Text style={styles.sectionTitle}>Personal Information</Text>\r\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Francise Number:</Text>\r\n@@ -284,9 +284,9 @@\n   username: { fontSize: 18, fontWeight: \"bold\", marginBottom: 10, paddingLeft: 20 },\r\n   lagout: { fontSize: 14, fontWeight: \"bold\" },\r\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n   accountContainer: { marginTop: 20, paddingHorizontal: 20 },\r\n-  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginBottom: 10 },\r\n+  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginHorizontal: 10 },\r\n   infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n   row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n   label: { fontSize: 14, color: \"#333\" },\r\n   value: { fontSize: 14, color: \"#333\" },\r\n"
                },
                {
                    "date": 1748454959999,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -284,9 +284,9 @@\n   username: { fontSize: 18, fontWeight: \"bold\", marginBottom: 10, paddingLeft: 20 },\r\n   lagout: { fontSize: 14, fontWeight: \"bold\" },\r\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n   accountContainer: { marginTop: 20, paddingHorizontal: 20 },\r\n-  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginHorizontal: 10 },\r\n+  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 10 },\r\n   infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n   row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n   label: { fontSize: 14, color: \"#333\" },\r\n   value: { fontSize: 14, color: \"#333\" },\r\n"
                },
                {
                    "date": 1748454979160,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -284,9 +284,9 @@\n   username: { fontSize: 18, fontWeight: \"bold\", marginBottom: 10, paddingLeft: 20 },\r\n   lagout: { fontSize: 14, fontWeight: \"bold\" },\r\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n   accountContainer: { marginTop: 20, paddingHorizontal: 20 },\r\n-  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 10 },\r\n+  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 15 },\r\n   infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n   row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n   label: { fontSize: 14, color: \"#333\" },\r\n   value: { fontSize: 14, color: \"#333\" },\r\n"
                },
                {
                    "date": 1748454984636,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -284,9 +284,9 @@\n   username: { fontSize: 18, fontWeight: \"bold\", marginBottom: 10, paddingLeft: 20 },\r\n   lagout: { fontSize: 14, fontWeight: \"bold\" },\r\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n   accountContainer: { marginTop: 20, paddingHorizontal: 20 },\r\n-  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 15 },\r\n+  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 10 },\r\n   infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n   row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n   label: { fontSize: 14, color: \"#333\" },\r\n   value: { fontSize: 14, color: \"#333\" },\r\n"
                },
                {
                    "date": 1748455024219,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -252,9 +252,9 @@\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n \r\n-        <Text style={styles.sectionTitle}>Personal Information</Text>\r\n+        <Text style={styles.sectionTitle}>???? Information</Text>\r\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Francise Number:</Text>\r\n           <View style={styles.row}>\r\n"
                },
                {
                    "date": 1748455081349,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -232,8 +232,10 @@\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n \r\n+        <Text style={styles.sectionTitle}>???? Information</Text>\r\n+\r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>License Number:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.licenseId ? \"#000\" : \"#999\" }]}>\r\n@@ -252,15 +254,13 @@\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n \r\n-        <Text style={styles.sectionTitle}>???? Information</Text>\r\n-\r\n         <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Francise Number:</Text>\r\n+          <Text style={styles.label}>Toda Name:</Text>\r\n           <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.franchiseNumber ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.franchiseNumber || \"Set Now\"}\r\n+            <Text style={[styles.value, { color: profile?.todaName ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.todaName || \"Set Now\"}\r\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n"
                },
                {
                    "date": 1748455111919,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -263,8 +263,18 @@\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Sector:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.sector ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.sector || \"Set Now\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n         {/* Add more driver-specific fields as needed! */}\r\n       </View>\r\n \r\n       <View style={styles.bottomNav}>\r\n"
                },
                {
                    "date": 1748455156457,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -273,8 +273,18 @@\n             </Text>\r\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n+\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Experiece:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.experienceYears ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.experienceYears || \"Set Now\"}\r\n+            </Text>\r\n+            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+          </View>\r\n+        </View>\r\n         {/* Add more driver-specific fields as needed! */}\r\n       </View>\r\n \r\n       <View style={styles.bottomNav}>\r\n"
                },
                {
                    "date": 1748455187778,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -232,9 +232,9 @@\n             <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n           </View>\r\n         </View>\r\n \r\n-        <Text style={styles.sectionTitle}>???? Information</Text>\r\n+        <Text style={styles.sectionTitle}>Vehicle Details</Text>\r\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>License Number:</Text>\r\n           <View style={styles.row}>\r\n"
                },
                {
                    "date": 1748455884966,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -298,9 +298,9 @@\n }\r\n \r\n const styles = StyleSheet.create({\r\n   container: { flex: 1, backgroundColor: \"#fff\" },\r\n-  profileContainer: { alignItems: \"center\", paddingTop: 50, flexDirection: \"row\", marginHorizontal: 20, justifyContent: \"space-between\" },\r\n+  profileContainer: { alignItems: \"center\", paddingTop: 50, flexDirection:\"row\", marginHorizontal:20, justifyContent: \"space-between\"},\r\n   profileImage: { width: 100, height: 100, borderRadius: 50, marginBottom: 10 },\r\n   username: { fontSize: 18, fontWeight: \"bold\", marginBottom: 10, paddingLeft: 20 },\r\n   lagout: { fontSize: 14, fontWeight: \"bold\" },\r\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n"
                },
                {
                    "date": 1748455915055,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -300,16 +300,16 @@\n const styles = StyleSheet.create({\r\n   container: { flex: 1, backgroundColor: \"#fff\" },\r\n   profileContainer: { alignItems: \"center\", paddingTop: 50, flexDirection:\"row\", marginHorizontal:20, justifyContent: \"space-between\"},\r\n   profileImage: { width: 100, height: 100, borderRadius: 50, marginBottom: 10 },\r\n-  username: { fontSize: 18, fontWeight: \"bold\", marginBottom: 10, paddingLeft: 20 },\r\n-  lagout: { fontSize: 14, fontWeight: \"bold\" },\r\n+  username: { fontSize: 18, fontWeight: \"bold\", marginBottom: 10, paddingLeft:20 },\r\n+  lagout: { fontSize: 14, fontWeight: \"bold\"},\r\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n   accountContainer: { marginTop: 20, paddingHorizontal: 20 },\r\n-  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 10 },\r\n+  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginBottom: 10 },\r\n   infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n-  row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n+  row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\"},\r\n   label: { fontSize: 14, color: \"#333\" },\r\n   value: { fontSize: 14, color: \"#333\" },\r\n-  deleteButton: { flexDirection: \"row\", justifyContent: 'flex-end', alignItems: \"center\", marginTop: 20, width: width - 40 },\r\n+  deleteButton: { flexDirection: \"row\", justifyContent:'flex-end', alignItems: \"center\", marginTop: 20, width: width-40},\r\n   bottomNav: { position: \"absolute\", bottom: 0, flexDirection: \"row\", justifyContent: \"space-around\", width: width, height: 70, backgroundColor: \"white\", borderTopLeftRadius: 30, borderTopRightRadius: 30, alignItems: \"center\", borderWidth: 1, borderColor: \"black\" },\r\n-});\r\n+});\n\\ No newline at end of file\n"
                },
                {
                    "date": 1748455959106,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -159,13 +159,9 @@\n         <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n           <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n           <Text style={styles.lagout}>LogOut</Text>\r\n         </TouchableOpacity>\r\n-        {selfieImage && (\r\n-          <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n-            <Text style={{ color: \"#fff\" }}>Upload New Profile Image</Text>\r\n-          </TouchableOpacity>\r\n-        )}\r\n+        \r\n       </View>\r\n \r\n       <View style={styles.accountContainer}>\r\n         <Text style={styles.sectionTitle}>Personal Information</Text>\r\n"
                },
                {
                    "date": 1748455985197,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -154,8 +154,13 @@\n           </TouchableOpacity>\r\n           <Text style={styles.username}>\r\n             {profile?.driverFirstName || \"\"}{profile?.driverLastName || \"\"}\r\n           </Text>\r\n+          {selfieImage && (\r\n+            <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n+              <Text style={{ color: \"#fff\" }}>Upload New Profile Image</Text>\r\n+            </TouchableOpacity>\r\n+          )}\r\n         </View>\r\n         <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n           <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n           <Text style={styles.lagout}>LogOut</Text>\r\n"
                },
                {
                    "date": 1748456004605,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -151,16 +151,19 @@\n               }\r\n               style={styles.profileImage}\r\n             />\r\n           </TouchableOpacity>\r\n-          <Text style={styles.username}>\r\n-            {profile?.driverFirstName || \"\"}{profile?.driverLastName || \"\"}\r\n-          </Text>\r\n-          {selfieImage && (\r\n-            <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n-              <Text style={{ color: \"#fff\" }}>Upload New Profile Image</Text>\r\n-            </TouchableOpacity>\r\n-          )}\r\n+          <View>\r\n+            <Text style={styles.username}>\r\n+              {profile?.driverFirstName || \"\"}{profile?.driverLastName || \"\"}\r\n+            </Text>\r\n+            {selfieImage && (\r\n+              <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n+                <Text style={{ color: \"#fff\" }}>Upload New Profile Image</Text>\r\n+              </TouchableOpacity>\r\n+            )}\r\n+          </View>\r\n+          \r\n         </View>\r\n         <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n           <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n           <Text style={styles.lagout}>LogOut</Text>\r\n"
                },
                {
                    "date": 1748456019816,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -157,9 +157,9 @@\n               {profile?.driverFirstName || \"\"}{profile?.driverLastName || \"\"}\r\n             </Text>\r\n             {selfieImage && (\r\n               <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n-                <Text style={{ color: \"#fff\" }}>Upload New Profile Image</Text>\r\n+                <Text style={{ color: \"#fff\" }}>Upload Profile</Text>\r\n               </TouchableOpacity>\r\n             )}\r\n           </View>\r\n           \r\n"
                },
                {
                    "date": 1748456026312,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -157,9 +157,9 @@\n               {profile?.driverFirstName || \"\"}{profile?.driverLastName || \"\"}\r\n             </Text>\r\n             {selfieImage && (\r\n               <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n-                <Text style={{ color: \"#fff\" }}>Upload Profile</Text>\r\n+                <Text style={{ color: \"#fff\" }}>Upload Profile Pic</Text>\r\n               </TouchableOpacity>\r\n             )}\r\n           </View>\r\n           \r\n"
                },
                {
                    "date": 1748456083122,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -303,10 +303,10 @@\n \r\n const styles = StyleSheet.create({\r\n   container: { flex: 1, backgroundColor: \"#fff\" },\r\n   profileContainer: { alignItems: \"center\", paddingTop: 50, flexDirection:\"row\", marginHorizontal:20, justifyContent: \"space-between\"},\r\n-  profileImage: { width: 100, height: 100, borderRadius: 50, marginBottom: 10 },\r\n-  username: { fontSize: 18, fontWeight: \"bold\", marginBottom: 10, paddingLeft:20 },\r\n+  profileImage: { width: 100, height: 100, borderRadius: 50},\r\n+  username: { fontSize: 18, fontWeight: \"bold\", paddingLeft:20 },\r\n   lagout: { fontSize: 14, fontWeight: \"bold\"},\r\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n   accountContainer: { marginTop: 20, paddingHorizontal: 20 },\r\n   sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginBottom: 10 },\r\n"
                },
                {
                    "date": 1748456130116,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -307,9 +307,9 @@\n   profileImage: { width: 100, height: 100, borderRadius: 50},\r\n   username: { fontSize: 18, fontWeight: \"bold\", paddingLeft:20 },\r\n   lagout: { fontSize: 14, fontWeight: \"bold\"},\r\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n-  accountContainer: { marginTop: 20, paddingHorizontal: 20 },\r\n+  accountContainer: { marginTop: 10, paddingHorizontal: 20 },\r\n   sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginBottom: 10 },\r\n   infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n   row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\"},\r\n   label: { fontSize: 14, color: \"#333\" },\r\n"
                },
                {
                    "date": 1748456166784,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -308,9 +308,9 @@\n   username: { fontSize: 18, fontWeight: \"bold\", paddingLeft:20 },\r\n   lagout: { fontSize: 14, fontWeight: \"bold\"},\r\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n   accountContainer: { marginTop: 10, paddingHorizontal: 20 },\r\n-  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginBottom: 10 },\r\n+  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 10 },\r\n   infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n   row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\"},\r\n   label: { fontSize: 14, color: \"#333\" },\r\n   value: { fontSize: 14, color: \"#333\" },\r\n"
                },
                {
                    "date": 1756649707480,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,8 +12,9 @@\n \r\n export default function DProfile() {\r\n   const [profile, setProfile] = useState<any>(null);\r\n   const [selfieImage, setProfileImage] = useState<ImagePickerAsset | null>(null);\r\n+  const [emailSending, setEmailSending] = useState(false);\r\n \r\n   const fetchProfile = async () => {\r\n     try {\r\n       const driverId = await AsyncStorage.getItem(\"driverId\");\r\n@@ -289,15 +290,8 @@\n           </View>\r\n         </View>\r\n         {/* Add more driver-specific fields as needed! */}\r\n       </View>\r\n-\r\n-      <View style={styles.bottomNav}>\r\n-        <TouchableOpacity onPress={() => router.push(\"/homedriver/dhome\")}><Ionicons name=\"home-outline\" size={30} color=\"black\" /><Text>Home</Text></TouchableOpacity>\r\n-        <TouchableOpacity onPress={() => router.push(\"/homedriver/dhistory\")}><Ionicons name=\"document-text-outline\" size={30} color=\"black\" /><Text>History</Text></TouchableOpacity>\r\n-        <TouchableOpacity onPress={() => router.push(\"/homedriver/dchats\")}><Ionicons name=\"chatbubbles-outline\" size={30} color=\"black\" /><Text>Chats</Text></TouchableOpacity>\r\n-        <TouchableOpacity onPress={() => router.push(\"/homedriver/dprofile\")}><Ionicons name=\"person\" size={30} color=\"black\" /><Text>Profile</Text></TouchableOpacity>\r\n-      </View>\r\n     </View>\r\n   );\r\n }\r\n \r\n"
                },
                {
                    "date": 1756649721128,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,8 +14,27 @@\n   const [profile, setProfile] = useState<any>(null);\r\n   const [selfieImage, setProfileImage] = useState<ImagePickerAsset | null>(null);\r\n   const [emailSending, setEmailSending] = useState(false);\r\n \r\n+  const resendDriverEmail = async () => {\r\n+    if (!profile?.email) return Alert.alert(\"Error\", \"No email on file.\");\r\n+    try {\r\n+      setEmailSending(true);\r\n+      const r = await fetch(`${API_BASE_URL}/api/auth/driver/resend-verification`, {\r\n+        method: \"POST\",\r\n+        headers: { \"Content-Type\": \"application/json\" },\r\n+        body: JSON.stringify({ email: profile.email }),\r\n+      });\r\n+      const j = await r.json();\r\n+      if (r.ok) Alert.alert(\"Sent\", j.message || \"Verification email sent.\");\r\n+      else Alert.alert(\"Error\", j.message || j.error || \"Failed to send email.\");\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Network error\");\r\n+    } finally {\r\n+      setEmailSending(false);\r\n+    }\r\n+  };\r\n+\r\n   const fetchProfile = async () => {\r\n     try {\r\n       const driverId = await AsyncStorage.getItem(\"driverId\");\r\n       if (!driverId) return;\r\n"
                },
                {
                    "date": 1756649746717,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -248,16 +248,49 @@\n         </View>\r\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Email Address:</Text>\r\n-          <View style={styles.row}>\r\n+          <View style={{ alignItems: \"flex-end\" }}>\r\n             <Text style={[styles.value, { color: profile?.email ? \"#000\" : \"#999\" }]}>\r\n               {profile?.email || \"Set Now\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+\r\n+            <View style={{ flexDirection: \"row\", alignItems: \"center\", marginTop: 4 }}>\r\n+              <View\r\n+                style={{\r\n+                  paddingHorizontal: 8,\r\n+                  paddingVertical: 2,\r\n+                  borderRadius: 12,\r\n+                  backgroundColor: profile?.isVerified ? \"#E6F7E9\" : \"#FFF4E5\",\r\n+                  marginRight: 8,\r\n+                }}\r\n+              >\r\n+                <Text style={{ color: profile?.isVerified ? \"#2E7D32\" : \"#B26A00\", fontSize: 12 }}>\r\n+                  {profile?.isVerified ? \"Verified\" : \"Not verified\"}\r\n+                </Text>\r\n+              </View>\r\n+\r\n+              {!profile?.isVerified && (\r\n+                <TouchableOpacity\r\n+                  disabled={emailSending}\r\n+                  onPress={resendDriverEmail}\r\n+                  style={{\r\n+                    paddingHorizontal: 10,\r\n+                    paddingVertical: 6,\r\n+                    borderRadius: 8,\r\n+                    backgroundColor: emailSending ? \"#ccc\" : \"#5089A3\",\r\n+                  }}\r\n+                >\r\n+                  <Text style={{ color: \"#fff\", fontSize: 12 }}>\r\n+                    {emailSending ? \"Sending...\" : \"Verify email\"}\r\n+                  </Text>\r\n+                </TouchableOpacity>\r\n+              )}\r\n+            </View>\r\n           </View>\r\n         </View>\r\n \r\n+\r\n         <Text style={styles.sectionTitle}>Vehicle Details</Text>\r\n \r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>License Number:</Text>\r\n"
                },
                {
                    "date": 1756813038678,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -112,39 +112,38 @@\n     }\r\n   };\r\n \r\n   const handleUploadSelfie = async () => {\r\n-    if (!selfieImage) {\r\n-      Alert.alert(\"Error\", \"Please select an image first.\");\r\n-      return;\r\n-    }\r\n+    if (!selfieImage) return Alert.alert(\"Error\", \"Please select an image first.\");\r\n     try {\r\n       const driverId = await AsyncStorage.getItem(\"driverId\");\r\n       if (!driverId) return;\r\n+\r\n       const formData = new FormData();\r\n-      formData.append(\"profileImage\", {\r\n+      formData.append(\"selfieImage\", {\r\n         uri: selfieImage.uri,\r\n-        name: \"profile.jpg\",\r\n+        name: \"selfie.jpg\",\r\n         type: \"image/jpeg\",\r\n       } as any);\r\n-      const res = await fetch(`${API_BASE_URL}/api/auth/driver/${driverId}/update-profile-image`, {\r\n-        method: \"PATCH\",\r\n+\r\n+      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}/photo`, {\r\n+        method: \"POST\",\r\n         body: formData,\r\n       });\r\n-      if (res.ok) {\r\n-        Alert.alert(\"Success\", \"Profile image updated!\");\r\n-        const updatedProfile = await res.json();\r\n-        setProfile(updatedProfile.driver);\r\n-        setProfileImage(null);\r\n-      } else {\r\n-        Alert.alert(\"Error\", \"Failed to upload image.\");\r\n-      }\r\n-    } catch (error) {\r\n-      console.error(\"❌ Upload error:\", error);\r\n-      Alert.alert(\"Error\", \"Something went wrong. Try again.\");\r\n+\r\n+      const j = await res.json();\r\n+      if (!res.ok) throw new Error(j?.message || \"Failed to upload image\");\r\n+\r\n+      setProfile(j.driver);\r\n+      setProfileImage(null);\r\n+      Alert.alert(\"Success\", \"Profile image updated!\");\r\n+    } catch (e: any) {\r\n+      console.error(\"❌ Upload error:\", e);\r\n+      Alert.alert(\"Error\", e.message || \"Something went wrong. Try again.\");\r\n     }\r\n   };\r\n \r\n+\r\n   const handleLogout = async () => {\r\n     try {\r\n       await AsyncStorage.removeItem(\"driverId\");\r\n       Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n"
                },
                {
                    "date": 1756814307315,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -172,9 +172,9 @@\n             />\r\n           </TouchableOpacity>\r\n           <View>\r\n             <Text style={styles.username}>\r\n-              {profile?.driverFirstName || \"\"}{profile?.driverLastName || \"\"}\r\n+              {[profile?.driverFirstName, profile?.driverLastName].filter(Boolean).join(\" \")}\r\n             </Text>\r\n             {selfieImage && (\r\n               <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n                 <Text style={{ color: \"#fff\" }}>Upload Profile Pic</Text>\r\n"
                },
                {
                    "date": 1757010073207,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,21 +1,62 @@\n import React, { useState } from \"react\";\r\n-import { View, Text, StyleSheet, Dimensions, TouchableOpacity, Image, Alert, Platform, ActionSheetIOS } from \"react-native\";\r\n+import {\r\n+  View, Text, StyleSheet, Dimensions, TouchableOpacity, Image, Alert,\r\n+  Platform, ActionSheetIOS, Modal, TextInput, ActivityIndicator, ScrollView\r\n+} from \"react-native\";\r\n import { Ionicons, MaterialIcons } from \"@expo/vector-icons\";\r\n import { router } from 'expo-router';\r\n import AsyncStorage from '@react-native-async-storage/async-storage';\r\n import * as ImagePicker from \"expo-image-picker\";\r\n import { ImagePickerAsset } from \"expo-image-picker\";\r\n import { API_BASE_URL } from \"../../config\";\r\n import { useFocusEffect } from \"@react-navigation/native\";\r\n+import DateTimePicker from \"@react-native-community/datetimepicker\";\r\n \r\n const { width } = Dimensions.get(\"window\");\r\n \r\n+// enums (mirror backend)\r\n+const SECTORS = [\"East\", \"West\", \"North\", \"South\", \"Other\"] as const;\r\n+const EXP_YEARS = [\"1-5 taon\", \"6-10 taon\", \"16-20 taon\", \"20 taon pataas\"] as const;\r\n+\r\n export default function DProfile() {\r\n   const [profile, setProfile] = useState<any>(null);\r\n   const [selfieImage, setProfileImage] = useState<ImagePickerAsset | null>(null);\r\n   const [emailSending, setEmailSending] = useState(false);\r\n \r\n+  // Modals state\r\n+  const [nameOpen, setNameOpen] = useState(false);\r\n+  const [firstNameEdit, setFirstNameEdit] = useState(\"\");\r\n+  const [middleNameEdit, setMiddleNameEdit] = useState(\"\");\r\n+  const [lastNameEdit, setLastNameEdit] = useState(\"\");\r\n+  const [savingName, setSavingName] = useState(false);\r\n+\r\n+  const [genderOpen, setGenderOpen] = useState(false);\r\n+  const [genderChoice, setGenderChoice] = useState<string>(\"\");\r\n+  const [genderOther, setGenderOther] = useState(\"\");\r\n+  const [savingGender, setSavingGender] = useState(false);\r\n+\r\n+  const [bdayOpen, setBdayOpen] = useState(false);          // iOS custom modal\r\n+  const [bdayValue, setBdayValue] = useState<Date | null>(null);\r\n+  const [savingBday, setSavingBday] = useState(false);\r\n+  const [showAndroidBday, setShowAndroidBday] = useState(false); // Android native dialog\r\n+\r\n+  const [phoneOpen, setPhoneOpen] = useState(false);\r\n+  const [phoneValue, setPhoneValue] = useState(\"\");\r\n+  const [savingPhone, setSavingPhone] = useState(false);\r\n+\r\n+  const [addrOpen, setAddrOpen] = useState(false);\r\n+  const [addrValue, setAddrValue] = useState(\"\");\r\n+  const [savingAddr, setSavingAddr] = useState(false);\r\n+\r\n+  const [vehOpen, setVehOpen] = useState(false);\r\n+  const [franchiseValue, setFranchiseValue] = useState(\"\");\r\n+  const [todaValue, setTodaValue] = useState(\"\");\r\n+  const [sectorValue, setSectorValue] = useState<string>(\"\");\r\n+  const [expValue, setExpValue] = useState<string>(\"\");\r\n+  const [licenseValue, setLicenseValue] = useState(\"\");\r\n+  const [savingVeh, setSavingVeh] = useState(false);\r\n+\r\n   const resendDriverEmail = async () => {\r\n     if (!profile?.email) return Alert.alert(\"Error\", \"No email on file.\");\r\n     try {\r\n       setEmailSending(true);\r\n@@ -51,63 +92,33 @@\n       fetchProfile();\r\n     }, [])\r\n   );\r\n \r\n+  // ---- Selfie upload (unchanged) ----\r\n   const pickSelfieImage = async () => {\r\n     if (Platform.OS === \"ios\") {\r\n       ActionSheetIOS.showActionSheetWithOptions(\r\n-        {\r\n-          options: [\"Take a Photo\", \"Choose from Gallery\", \"Cancel\"],\r\n-          cancelButtonIndex: 2,\r\n-        },\r\n+        { options: [\"Take a Photo\", \"Choose from Gallery\", \"Cancel\"], cancelButtonIndex: 2 },\r\n         async (buttonIndex) => {\r\n           if (buttonIndex === 0) {\r\n-            const result = await ImagePicker.launchCameraAsync({\r\n-              mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n-              allowsEditing: true,\r\n-              quality: 1,\r\n-            });\r\n-            if (!result.canceled && result.assets.length > 0) {\r\n-              setProfileImage(result.assets[0]);\r\n-            }\r\n+            const result = await ImagePicker.launchCameraAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n+            if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n           } else if (buttonIndex === 1) {\r\n-            const result = await ImagePicker.launchImageLibraryAsync({\r\n-              mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n-              allowsEditing: true,\r\n-              quality: 1,\r\n-            });\r\n-            if (!result.canceled && result.assets.length > 0) {\r\n-              setProfileImage(result.assets[0]);\r\n-            }\r\n+            const result = await ImagePicker.launchImageLibraryAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n+            if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n           }\r\n         }\r\n       );\r\n     } else {\r\n       Alert.alert(\"Select Option\", \"\", [\r\n-        {\r\n-          text: \"Take a Photo\", onPress: async () => {\r\n-            const result = await ImagePicker.launchCameraAsync({\r\n-              mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n-              allowsEditing: true,\r\n-              quality: 1,\r\n-            });\r\n-            if (!result.canceled && result.assets.length > 0) {\r\n-              setProfileImage(result.assets[0]);\r\n-            }\r\n-          }\r\n-        },\r\n-        {\r\n-          text: \"Choose from Gallery\", onPress: async () => {\r\n-            const result = await ImagePicker.launchImageLibraryAsync({\r\n-              mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n-              allowsEditing: true,\r\n-              quality: 1,\r\n-            });\r\n-            if (!result.canceled && result.assets.length > 0) {\r\n-              setProfileImage(result.assets[0]);\r\n-            }\r\n-          }\r\n-        },\r\n+        { text: \"Take a Photo\", onPress: async () => {\r\n+          const result = await ImagePicker.launchCameraAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n+          if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n+        }},\r\n+        { text: \"Choose from Gallery\", onPress: async () => {\r\n+          const result = await ImagePicker.launchImageLibraryAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n+          if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n+        }},\r\n         { text: \"Cancel\", style: \"cancel\" },\r\n       ]);\r\n     }\r\n   };\r\n@@ -118,19 +129,11 @@\n       const driverId = await AsyncStorage.getItem(\"driverId\");\r\n       if (!driverId) return;\r\n \r\n       const formData = new FormData();\r\n-      formData.append(\"selfieImage\", {\r\n-        uri: selfieImage.uri,\r\n-        name: \"selfie.jpg\",\r\n-        type: \"image/jpeg\",\r\n-      } as any);\r\n+      formData.append(\"selfieImage\", { uri: selfieImage.uri, name: \"selfie.jpg\", type: \"image/jpeg\" } as any);\r\n \r\n-      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}/photo`, {\r\n-        method: \"POST\",\r\n-        body: formData,\r\n-      });\r\n-\r\n+      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}/photo`, { method: \"POST\", body: formData });\r\n       const j = await res.json();\r\n       if (!res.ok) throw new Error(j?.message || \"Failed to upload image\");\r\n \r\n       setProfile(j.driver);\r\n@@ -141,9 +144,181 @@\n       Alert.alert(\"Error\", e.message || \"Something went wrong. Try again.\");\r\n     }\r\n   };\r\n \r\n+  // ---- Helpers ----\r\n+  const fmtDate = (iso?: string) => {\r\n+    if (!iso) return null;\r\n+    const d = new Date(iso);\r\n+    if (Number.isNaN(d.getTime())) return null;\r\n+    return d.toLocaleDateString(undefined, { year: \"numeric\", month: \"short\", day: \"2-digit\" });\r\n+  };\r\n \r\n+  const patchDriver = async (payload: Record<string, any>) => {\r\n+    const driverId = await AsyncStorage.getItem(\"driverId\");\r\n+    if (!driverId) throw new Error(\"Missing driverId\");\r\n+    const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}`, {\r\n+      method: \"PATCH\",\r\n+      headers: { \"Content-Type\": \"application/json\" },\r\n+      body: JSON.stringify(payload),\r\n+    });\r\n+    const j = await res.json();\r\n+    if (!res.ok) throw new Error(j?.message || \"Update failed\");\r\n+    setProfile(j.driver);\r\n+  };\r\n+\r\n+  // ---- Name modal ----\r\n+  const openName = () => {\r\n+    setFirstNameEdit(profile?.driverFirstName || \"\");\r\n+    setMiddleNameEdit(profile?.driverMiddleName || \"\");\r\n+    setLastNameEdit(profile?.driverLastName || \"\");\r\n+    setNameOpen(true);\r\n+  };\r\n+  const saveName = async () => {\r\n+    try {\r\n+      setSavingName(true);\r\n+      await patchDriver({\r\n+        driverFirstName: firstNameEdit.trim(),\r\n+        driverMiddleName: middleNameEdit.trim(),\r\n+        driverLastName: lastNameEdit.trim(),\r\n+      });\r\n+      setNameOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save name\");\r\n+    } finally {\r\n+      setSavingName(false);\r\n+    }\r\n+  };\r\n+\r\n+  // ---- Gender modal ----\r\n+  const openGender = () => {\r\n+    const current = profile?.gender || \"\";\r\n+    const known = [\"Male\",\"Female\",\"Nonbinary\",\"Prefer not to say\"];\r\n+    if (known.includes(current)) {\r\n+      setGenderChoice(current);\r\n+      setGenderOther(\"\");\r\n+    } else if (current) {\r\n+      setGenderChoice(\"Other\");\r\n+      setGenderOther(current);\r\n+    } else {\r\n+      setGenderChoice(\"\");\r\n+      setGenderOther(\"\");\r\n+    }\r\n+    setGenderOpen(true);\r\n+  };\r\n+  const saveGender = async () => {\r\n+    const value = genderChoice === \"Other\" ? genderOther.trim() : genderChoice;\r\n+    if (!value) return Alert.alert(\"Gender\", \"Please choose an option.\");\r\n+    if (genderChoice === \"Other\" && !genderOther.trim()) {\r\n+      return Alert.alert(\"Gender\", \"Please enter a custom gender.\");\r\n+    }\r\n+    try {\r\n+      setSavingGender(true);\r\n+      await patchDriver({ gender: value });\r\n+      setGenderOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save gender\");\r\n+    } finally {\r\n+      setSavingGender(false);\r\n+    }\r\n+  };\r\n+\r\n+  // ---- Birthday modal / picker ----\r\n+  const openBday = () => {\r\n+    const d = profile?.driverBirthdate ? new Date(profile.driverBirthdate) : null;\r\n+    const initial = d && !Number.isNaN(d.getTime()) ? d : new Date();\r\n+    setBdayValue(initial);\r\n+    if (Platform.OS === \"android\") {\r\n+      setShowAndroidBday(true);\r\n+    } else {\r\n+      setBdayOpen(true);\r\n+    }\r\n+  };\r\n+  const saveBday = async () => {\r\n+    if (!bdayValue) return;\r\n+    const yyyy = bdayValue.getFullYear();\r\n+    const mm = String(bdayValue.getMonth()+1).padStart(2,\"0\");\r\n+    const dd = String(bdayValue.getDate()).padStart(2,\"0\");\r\n+    const iso = `${yyyy}-${mm}-${dd}`;\r\n+    try {\r\n+      setSavingBday(true);\r\n+      await patchDriver({ driverBirthdate: iso });\r\n+      setBdayOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save birthday\");\r\n+    } finally {\r\n+      setSavingBday(false);\r\n+    }\r\n+  };\r\n+\r\n+  // ---- Phone ----\r\n+  const openPhone = () => {\r\n+    setPhoneValue(profile?.driverPhone || \"\");\r\n+    setPhoneOpen(true);\r\n+  };\r\n+  const savePhone = async () => {\r\n+    if (!phoneValue.trim()) return Alert.alert(\"Phone\", \"Enter a phone number.\");\r\n+    try {\r\n+      setSavingPhone(true);\r\n+      await patchDriver({ driverPhone: phoneValue.trim() });\r\n+      setPhoneOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save phone\");\r\n+    } finally {\r\n+      setSavingPhone(false);\r\n+    }\r\n+  };\r\n+\r\n+  // ---- Address ----\r\n+  const openAddr = () => {\r\n+    setAddrValue(profile?.homeAddress || \"\");\r\n+    setAddrOpen(true);\r\n+  };\r\n+  const saveAddr = async () => {\r\n+    try {\r\n+      setSavingAddr(true);\r\n+      await patchDriver({ homeAddress: addrValue.trim() });\r\n+      setAddrOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save address\");\r\n+    } finally {\r\n+      setSavingAddr(false);\r\n+    }\r\n+  };\r\n+\r\n+  // ---- Vehicle block (franchise/toda/sector/experience/licenseId) ----\r\n+  const openVeh = () => {\r\n+    setFranchiseValue(profile?.franchiseNumber || \"\");\r\n+    setTodaValue(profile?.todaName || \"\");\r\n+    setSectorValue(profile?.sector || \"\");\r\n+    setExpValue(profile?.experienceYears || \"\");\r\n+    setLicenseValue(profile?.licenseId || \"\");\r\n+    setVehOpen(true);\r\n+  };\r\n+  const saveVeh = async () => {\r\n+    if (sectorValue && !SECTORS.includes(sectorValue as any)) {\r\n+      return Alert.alert(\"Sector\", \"Please select a valid sector.\");\r\n+    }\r\n+    if (expValue && !EXP_YEARS.includes(expValue as any)) {\r\n+      return Alert.alert(\"Experience\", \"Please select a valid experience range.\");\r\n+    }\r\n+    try {\r\n+      setSavingVeh(true);\r\n+      await patchDriver({\r\n+        franchiseNumber: franchiseValue.trim(),\r\n+        todaName: todaValue.trim(),\r\n+        sector: sectorValue.trim(),\r\n+        experienceYears: expValue.trim(),\r\n+        licenseId: licenseValue.trim(),\r\n+      });\r\n+      setVehOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save vehicle details\");\r\n+    } finally {\r\n+      setSavingVeh(false);\r\n+    }\r\n+  };\r\n+\r\n   const handleLogout = async () => {\r\n     try {\r\n       await AsyncStorage.removeItem(\"driverId\");\r\n       Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n@@ -153,9 +328,8 @@\n       Alert.alert(\"Error\", \"Failed to log out. Try again.\");\r\n     }\r\n   };\r\n \r\n-  // For drivers, show driver info (modify the fields as per your Driver model)\r\n   return (\r\n     <View style={styles.container}>\r\n       <View style={styles.profileContainer}>\r\n         <View style={styles.row}>\r\n@@ -180,105 +354,95 @@\n                 <Text style={{ color: \"#fff\" }}>Upload Profile Pic</Text>\r\n               </TouchableOpacity>\r\n             )}\r\n           </View>\r\n-          \r\n         </View>\r\n         <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n           <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n           <Text style={styles.lagout}>LogOut</Text>\r\n         </TouchableOpacity>\r\n-        \r\n       </View>\r\n \r\n-      <View style={styles.accountContainer}>\r\n+      <ScrollView style={styles.accountContainer} contentContainerStyle={{ paddingBottom: 40 }}>\r\n         <Text style={styles.sectionTitle}>Personal Information</Text>\r\n \r\n+        {/* Full Name */}\r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Full Name:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[\r\n               styles.value,\r\n-              { color: (profile?.driverFirstName || profile?.driverMiddleName || profile?.driverLastName) ? \"#000\" : \"#999\" },\r\n+              { color: (profile?.driverFirstName || profile?.driverMiddleName || profile?.driverLastName) ? \"#000\" : \"#999\" }\r\n             ]}>\r\n               {profile?.driverFirstName || \"\"} {profile?.driverMiddleName || \"\"} {profile?.driverLastName || \"\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+            <TouchableOpacity onPress={openName} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n           </View>\r\n         </View>\r\n \r\n+        {/* Gender */}\r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Gender:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.gender ? \"#000\" : \"#999\" }]}>\r\n               {profile?.gender || \"Set Now\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+            <TouchableOpacity onPress={openGender} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n           </View>\r\n         </View>\r\n \r\n-        {/* <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Age:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.age ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.age || \"Set Now\"}\r\n-            </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n-          </View>\r\n-        </View> */}\r\n-\r\n+        {/* Phone */}\r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Contact Number:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.driverPhone ? \"#000\" : \"#999\" }]}>\r\n               {profile?.driverPhone || \"Set Now\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+            <TouchableOpacity onPress={openPhone} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n           </View>\r\n         </View>\r\n \r\n+        {/* Birthday */}\r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Birthday:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.driverBirthdate ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.driverBirthdate ? profile.driverBirthdate.slice(0, 10) : \"Not Provided\"}\r\n+              {profile?.driverBirthdate ? (fmtDate(profile.driverBirthdate) || profile.driverBirthdate) : \"Not Provided\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+            <TouchableOpacity onPress={openBday} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n           </View>\r\n         </View>\r\n \r\n+        {/* Email + verify */}\r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Email Address:</Text>\r\n           <View style={{ alignItems: \"flex-end\" }}>\r\n             <Text style={[styles.value, { color: profile?.email ? \"#000\" : \"#999\" }]}>\r\n               {profile?.email || \"Set Now\"}\r\n             </Text>\r\n-\r\n             <View style={{ flexDirection: \"row\", alignItems: \"center\", marginTop: 4 }}>\r\n-              <View\r\n-                style={{\r\n-                  paddingHorizontal: 8,\r\n-                  paddingVertical: 2,\r\n-                  borderRadius: 12,\r\n-                  backgroundColor: profile?.isVerified ? \"#E6F7E9\" : \"#FFF4E5\",\r\n-                  marginRight: 8,\r\n-                }}\r\n-              >\r\n+              <View style={{\r\n+                paddingHorizontal: 8, paddingVertical: 2, borderRadius: 12,\r\n+                backgroundColor: profile?.isVerified ? \"#E6F7E9\" : \"#FFF4E5\",\r\n+                marginRight: 8,\r\n+              }}>\r\n                 <Text style={{ color: profile?.isVerified ? \"#2E7D32\" : \"#B26A00\", fontSize: 12 }}>\r\n                   {profile?.isVerified ? \"Verified\" : \"Not verified\"}\r\n                 </Text>\r\n               </View>\r\n-\r\n               {!profile?.isVerified && (\r\n                 <TouchableOpacity\r\n                   disabled={emailSending}\r\n                   onPress={resendDriverEmail}\r\n-                  style={{\r\n-                    paddingHorizontal: 10,\r\n-                    paddingVertical: 6,\r\n-                    borderRadius: 8,\r\n-                    backgroundColor: emailSending ? \"#ccc\" : \"#5089A3\",\r\n-                  }}\r\n+                  style={{ paddingHorizontal: 10, paddingVertical: 6, borderRadius: 8, backgroundColor: emailSending ? \"#ccc\" : \"#5089A3\" }}\r\n                 >\r\n                   <Text style={{ color: \"#fff\", fontSize: 12 }}>\r\n                     {emailSending ? \"Sending...\" : \"Verify email\"}\r\n                   </Text>\r\n@@ -287,62 +451,253 @@\n             </View>\r\n           </View>\r\n         </View>\r\n \r\n+        {/* Address */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Home Address:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.homeAddress ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.homeAddress || \"Set Now\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openAddr} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n \r\n         <Text style={styles.sectionTitle}>Vehicle Details</Text>\r\n \r\n+        {/* License ID */}\r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>License Number:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.licenseId ? \"#000\" : \"#999\" }]}>\r\n               {profile?.licenseId || \"Set Now\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n           </View>\r\n         </View>\r\n \r\n+        {/* Franchise */}\r\n         <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Francise Number:</Text>\r\n+          <Text style={styles.label}>Franchise Number:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.franchiseNumber ? \"#000\" : \"#999\" }]}>\r\n               {profile?.franchiseNumber || \"Set Now\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n           </View>\r\n         </View>\r\n \r\n+        {/* TODA */}\r\n         <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Toda Name:</Text>\r\n+          <Text style={styles.label}>TODA Name:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.todaName ? \"#000\" : \"#999\" }]}>\r\n               {profile?.todaName || \"Set Now\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n           </View>\r\n         </View>\r\n \r\n+        {/* Sector */}\r\n         <View style={styles.infoRow}>\r\n           <Text style={styles.label}>Sector:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.sector ? \"#000\" : \"#999\" }]}>\r\n               {profile?.sector || \"Set Now\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n           </View>\r\n         </View>\r\n \r\n+        {/* Experience */}\r\n         <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Experiece:</Text>\r\n+          <Text style={styles.label}>Experience:</Text>\r\n           <View style={styles.row}>\r\n             <Text style={[styles.value, { color: profile?.experienceYears ? \"#000\" : \"#999\" }]}>\r\n               {profile?.experienceYears || \"Set Now\"}\r\n             </Text>\r\n-            <MaterialIcons name=\"edit\" size={20} color=\"#888\" style={{ marginLeft: 5 }} />\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n           </View>\r\n         </View>\r\n-        {/* Add more driver-specific fields as needed! */}\r\n-      </View>\r\n+      </ScrollView>\r\n+\r\n+      {/* ------- Modals ------- */}\r\n+\r\n+      {/* Name */}\r\n+      <Modal transparent visible={nameOpen} animationType=\"fade\" onRequestClose={() => !savingName && setNameOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Edit Name</Text>\r\n+\r\n+            <TextInput placeholder=\"First name\" value={firstNameEdit} onChangeText={setFirstNameEdit} style={styles.input} />\r\n+            <TextInput placeholder=\"Middle name (optional)\" value={middleNameEdit} onChangeText={setMiddleNameEdit} style={styles.input} />\r\n+            <TextInput placeholder=\"Last name\" value={lastNameEdit} onChangeText={setLastNameEdit} style={styles.input} />\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingName} onPress={() => setNameOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingName} onPress={saveName} style={styles.btnPrimary}>\r\n+                {savingName ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Gender */}\r\n+      <Modal transparent visible={genderOpen} animationType=\"fade\" onRequestClose={() => !savingGender && setGenderOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Select Gender</Text>\r\n+\r\n+            {[\"Male\",\"Female\",\"Nonbinary\",\"Prefer not to say\",\"Other\"].map((opt) => (\r\n+              <TouchableOpacity key={opt} onPress={() => setGenderChoice(opt)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:8 }}>\r\n+                <View style={styles.radioOuter}>\r\n+                  {genderChoice === opt ? <View style={styles.radioInner} /> : null}\r\n+                </View>\r\n+                <Text>{opt}</Text>\r\n+              </TouchableOpacity>\r\n+            ))}\r\n+\r\n+            {genderChoice === \"Other\" && (\r\n+              <TextInput placeholder=\"Enter your gender\" value={genderOther} onChangeText={setGenderOther} style={[styles.input, { marginTop:8 }]} />\r\n+            )}\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingGender} onPress={() => setGenderOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingGender} onPress={saveGender} style={styles.btnPrimary}>\r\n+                {savingGender ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Birthday (iOS styled modal) */}\r\n+      <Modal transparent visible={bdayOpen && Platform.OS === \"ios\"} animationType=\"fade\" onRequestClose={() => !savingBday && setBdayOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Select Birthday</Text>\r\n+\r\n+            {bdayValue && (\r\n+              <DateTimePicker\r\n+                mode=\"date\"\r\n+                value={bdayValue}\r\n+                display=\"spinner\"\r\n+                onChange={(_, d) => d && setBdayValue(d)}\r\n+                maximumDate={new Date()}\r\n+              />\r\n+            )}\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingBday} onPress={() => setBdayOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingBday} onPress={saveBday} style={styles.btnPrimary}>\r\n+                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Android Date Picker */}\r\n+      {Platform.OS === \"android\" && showAndroidBday && (\r\n+        <DateTimePicker\r\n+          mode=\"date\"\r\n+          value={bdayValue ?? new Date()}\r\n+          display=\"calendar\"\r\n+          maximumDate={new Date()}\r\n+          onChange={(_, date) => {\r\n+            setShowAndroidBday(false);\r\n+            if (date) {\r\n+              setBdayValue(date);\r\n+              saveBday();\r\n+            }\r\n+          }}\r\n+        />\r\n+      )}\r\n+\r\n+      {/* Phone */}\r\n+      <Modal transparent visible={phoneOpen} animationType=\"fade\" onRequestClose={() => !savingPhone && setPhoneOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Edit Contact Number</Text>\r\n+            <TextInput placeholder=\"Phone number\" keyboardType=\"phone-pad\" value={phoneValue} onChangeText={setPhoneValue} style={styles.input} />\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingPhone} onPress={() => setPhoneOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingPhone} onPress={savePhone} style={styles.btnPrimary}>\r\n+                {savingPhone ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Address */}\r\n+      <Modal transparent visible={addrOpen} animationType=\"fade\" onRequestClose={() => !savingAddr && setAddrOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Edit Home Address</Text>\r\n+            <TextInput placeholder=\"Home address\" value={addrValue} onChangeText={setAddrValue} style={styles.input} />\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingAddr} onPress={() => setAddrOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingAddr} onPress={saveAddr} style={styles.btnPrimary}>\r\n+                {savingAddr ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Vehicle details */}\r\n+      <Modal transparent visible={vehOpen} animationType=\"fade\" onRequestClose={() => !savingVeh && setVehOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Vehicle / Franchise</Text>\r\n+\r\n+            <TextInput placeholder=\"License Number\" value={licenseValue} onChangeText={setLicenseValue} style={styles.input} />\r\n+            <TextInput placeholder=\"Franchise Number\" value={franchiseValue} onChangeText={setFranchiseValue} style={styles.input} />\r\n+            <TextInput placeholder=\"TODA Name\" value={todaValue} onChangeText={setTodaValue} style={styles.input} />\r\n+\r\n+            <Text style={{ marginTop: 8, marginBottom: 6, fontWeight: \"600\" }}>Sector</Text>\r\n+            {SECTORS.map((s) => (\r\n+              <TouchableOpacity key={s} onPress={() => setSectorValue(s)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:6 }}>\r\n+                <View style={styles.radioOuter}>{sectorValue === s ? <View style={styles.radioInner} /> : null}</View>\r\n+                <Text>{s}</Text>\r\n+              </TouchableOpacity>\r\n+            ))}\r\n+\r\n+            <Text style={{ marginTop: 12, marginBottom: 6, fontWeight: \"600\" }}>Experience</Text>\r\n+            {EXP_YEARS.map((e) => (\r\n+              <TouchableOpacity key={e} onPress={() => setExpValue(e)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:6 }}>\r\n+                <View style={styles.radioOuter}>{expValue === e ? <View style={styles.radioInner} /> : null}</View>\r\n+                <Text>{e}</Text>\r\n+              </TouchableOpacity>\r\n+            ))}\r\n+\r\n+            <View style={[styles.modalBtns, { marginTop: 12 }]}>\r\n+              <TouchableOpacity disabled={savingVeh} onPress={() => setVehOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingVeh} onPress={saveVeh} style={styles.btnPrimary}>\r\n+                {savingVeh ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n     </View>\r\n   );\r\n }\r\n \r\n@@ -355,10 +710,21 @@\n   uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n   accountContainer: { marginTop: 10, paddingHorizontal: 20 },\r\n   sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 10 },\r\n   infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n-  row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\"},\r\n+  row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n   label: { fontSize: 14, color: \"#333\" },\r\n-  value: { fontSize: 14, color: \"#333\" },\r\n-  deleteButton: { flexDirection: \"row\", justifyContent:'flex-end', alignItems: \"center\", marginTop: 20, width: width-40},\r\n-  bottomNav: { position: \"absolute\", bottom: 0, flexDirection: \"row\", justifyContent: \"space-around\", width: width, height: 70, backgroundColor: \"white\", borderTopLeftRadius: 30, borderTopRightRadius: 30, alignItems: \"center\", borderWidth: 1, borderColor: \"black\" },\r\n\\ No newline at end of file\n-});\n+  value: { fontSize: 14, color: \"#333\", maxWidth: width * 0.55 },\r\n+\r\n+  // modal\r\n+  modalBack: { flex:1, backgroundColor:\"rgba(0,0,0,0.4)\", justifyContent:\"center\", alignItems:\"center\", padding:20 },\r\n+  modalCard: { width:\"100%\", maxWidth:420, backgroundColor:\"#fff\", borderRadius:12, padding:16 },\r\n+  modalTitle: { fontWeight:\"bold\", fontSize:16, marginBottom:8 },\r\n+  input: { borderWidth:1, borderColor:\"#ddd\", borderRadius:8, paddingHorizontal:12, paddingVertical:10, marginBottom:8 },\r\n+\r\n+  modalBtns: { flexDirection:\"row\", justifyContent:\"flex-end\", gap: 12 },\r\n+  btnGhost: { paddingVertical:10, paddingHorizontal:14 },\r\n+  btnPrimary: { backgroundColor:\"#5089A3\", paddingVertical:10, paddingHorizontal:14, borderRadius:8, minWidth:90, alignItems:\"center\" },\r\n+\r\n+  radioOuter: { width:18, height:18, borderRadius:9, borderWidth:2, borderColor:\"#5089A3\", alignItems:\"center\", justifyContent:\"center\", marginRight:10 },\r\n+  radioInner: { width:10, height:10, borderRadius:5, backgroundColor:\"#5089A3\" },\r\n+});\r\n"
                },
                {
                    "date": 1757010422819,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -226,14 +226,11 @@\n   const openBday = () => {\r\n     const d = profile?.driverBirthdate ? new Date(profile.driverBirthdate) : null;\r\n     const initial = d && !Number.isNaN(d.getTime()) ? d : new Date();\r\n     setBdayValue(initial);\r\n-    if (Platform.OS === \"android\") {\r\n-      setShowAndroidBday(true);\r\n-    } else {\r\n-      setBdayOpen(true);\r\n-    }\r\n+    setBdayOpen(true);   // ✅ always use the modal\r\n   };\r\n+\r\n   const saveBday = async () => {\r\n     if (!bdayValue) return;\r\n     const yyyy = bdayValue.getFullYear();\r\n     const mm = String(bdayValue.getMonth()+1).padStart(2,\"0\");\r\n"
                },
                {
                    "date": 1757010568511,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -623,8 +623,49 @@\n           }}\r\n         />\r\n       )}\r\n \r\n+      <Modal\r\n+        transparent\r\n+        visible={bdayOpen}\r\n+        animationType=\"fade\"\r\n+        onRequestClose={() => !savingBday && setBdayOpen(false)}\r\n+      >\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Select Birthday</Text>\r\n+\r\n+            {bdayValue && (\r\n+              <DateTimePicker\r\n+                mode=\"date\"\r\n+                value={bdayValue}\r\n+                display={Platform.OS === \"ios\" ? \"spinner\" : \"calendar\"}\r\n+                maximumDate={new Date()}\r\n+                onChange={(_, d) => d && setBdayValue(d)}  // ✅ only update date\r\n+              />\r\n+            )}\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity\r\n+                disabled={savingBday}\r\n+                onPress={() => setBdayOpen(false)}\r\n+                style={styles.btnGhost}\r\n+              >\r\n+                <Text>Cancel</Text>\r\n+              </TouchableOpacity>\r\n+              <TouchableOpacity\r\n+                disabled={savingBday}\r\n+                onPress={saveBday}              // ✅ explicit Save\r\n+                style={styles.btnPrimary}\r\n+              >\r\n+                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+\r\n       {/* Phone */}\r\n       <Modal transparent visible={phoneOpen} animationType=\"fade\" onRequestClose={() => !savingPhone && setPhoneOpen(false)}>\r\n         <View style={styles.modalBack}>\r\n           <View style={styles.modalCard}>\r\n"
                },
                {
                    "date": 1757011049452,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,12 +34,13 @@\n   const [genderChoice, setGenderChoice] = useState<string>(\"\");\r\n   const [genderOther, setGenderOther] = useState(\"\");\r\n   const [savingGender, setSavingGender] = useState(false);\r\n \r\n-  const [bdayOpen, setBdayOpen] = useState(false);          // iOS custom modal\r\n+  const [bdayOpen, setBdayOpen] = useState(false);           // if you don’t already have it\r\n   const [bdayValue, setBdayValue] = useState<Date | null>(null);\r\n   const [savingBday, setSavingBday] = useState(false);\r\n-  const [showAndroidBday, setShowAndroidBday] = useState(false); // Android native dialog\r\n+  const [showAndroidBday, setShowAndroidBday] = useState(false);\r\n+  const [androidBdayConfirmOpen, setAndroidBdayConfirmOpen] = useState(false);\r\n \r\n   const [phoneOpen, setPhoneOpen] = useState(false);\r\n   const [phoneValue, setPhoneValue] = useState(\"\");\r\n   const [savingPhone, setSavingPhone] = useState(false);\r\n"
                },
                {
                    "date": 1757011131632,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -227,11 +227,17 @@\n   const openBday = () => {\r\n     const d = profile?.driverBirthdate ? new Date(profile.driverBirthdate) : null;\r\n     const initial = d && !Number.isNaN(d.getTime()) ? d : new Date();\r\n     setBdayValue(initial);\r\n-    setBdayOpen(true);   // ✅ always use the modal\r\n+\r\n+    if (Platform.OS === \"android\") {\r\n+      setShowAndroidBday(true);               // native calendar -> then confirm modal\r\n+    } else {\r\n+      setBdayOpen(true);                      // iOS: your existing modal with Save/Cancel\r\n+    }\r\n   };\r\n \r\n+\r\n   const saveBday = async () => {\r\n     if (!bdayValue) return;\r\n     const yyyy = bdayValue.getFullYear();\r\n     const mm = String(bdayValue.getMonth()+1).padStart(2,\"0\");\r\n"
                },
                {
                    "date": 1757011165496,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -229,11 +229,11 @@\n     const initial = d && !Number.isNaN(d.getTime()) ? d : new Date();\r\n     setBdayValue(initial);\r\n \r\n     if (Platform.OS === \"android\") {\r\n-      setShowAndroidBday(true);               // native calendar -> then confirm modal\r\n+      setShowAndroidBday(true);               \r\n     } else {\r\n-      setBdayOpen(true);                      // iOS: your existing modal with Save/Cancel\r\n+      setBdayOpen(true);                      \r\n     }\r\n   };\r\n \r\n \r\n"
                },
                {
                    "date": 1757011210227,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -621,58 +621,19 @@\n           value={bdayValue ?? new Date()}\r\n           display=\"calendar\"\r\n           maximumDate={new Date()}\r\n           onChange={(_, date) => {\r\n-            setShowAndroidBday(false);\r\n+            setShowAndroidBday(false);            // always close picker\r\n             if (date) {\r\n-              setBdayValue(date);\r\n-              saveBday();\r\n+              setBdayValue(date);                 // keep picked date\r\n+              setAndroidBdayConfirmOpen(true);    // now show confirm modal\r\n             }\r\n           }}\r\n         />\r\n       )}\r\n \r\n-      <Modal\r\n-        transparent\r\n-        visible={bdayOpen}\r\n-        animationType=\"fade\"\r\n-        onRequestClose={() => !savingBday && setBdayOpen(false)}\r\n-      >\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Select Birthday</Text>\r\n \r\n-            {bdayValue && (\r\n-              <DateTimePicker\r\n-                mode=\"date\"\r\n-                value={bdayValue}\r\n-                display={Platform.OS === \"ios\" ? \"spinner\" : \"calendar\"}\r\n-                maximumDate={new Date()}\r\n-                onChange={(_, d) => d && setBdayValue(d)}  // ✅ only update date\r\n-              />\r\n-            )}\r\n \r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity\r\n-                disabled={savingBday}\r\n-                onPress={() => setBdayOpen(false)}\r\n-                style={styles.btnGhost}\r\n-              >\r\n-                <Text>Cancel</Text>\r\n-              </TouchableOpacity>\r\n-              <TouchableOpacity\r\n-                disabled={savingBday}\r\n-                onPress={saveBday}              // ✅ explicit Save\r\n-                style={styles.btnPrimary}\r\n-              >\r\n-                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n-\r\n-\r\n       {/* Phone */}\r\n       <Modal transparent visible={phoneOpen} animationType=\"fade\" onRequestClose={() => !savingPhone && setPhoneOpen(false)}>\r\n         <View style={styles.modalBack}>\r\n           <View style={styles.modalCard}>\r\n"
                },
                {
                    "date": 1757011219499,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -621,12 +621,12 @@\n           value={bdayValue ?? new Date()}\r\n           display=\"calendar\"\r\n           maximumDate={new Date()}\r\n           onChange={(_, date) => {\r\n-            setShowAndroidBday(false);            // always close picker\r\n+            setShowAndroidBday(false);            \r\n             if (date) {\r\n-              setBdayValue(date);                 // keep picked date\r\n-              setAndroidBdayConfirmOpen(true);    // now show confirm modal\r\n+              setBdayValue(date);                 \r\n+              setAndroidBdayConfirmOpen(true);    \r\n             }\r\n           }}\r\n         />\r\n       )}\r\n"
                },
                {
                    "date": 1757011233505,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -630,10 +630,51 @@\n           }}\r\n         />\r\n       )}\r\n \r\n+      <Modal\r\n+        transparent\r\n+        visible={androidBdayConfirmOpen}\r\n+        animationType=\"fade\"\r\n+        onRequestClose={() => !savingBday && setAndroidBdayConfirmOpen(false)}\r\n+      >\r\n+        <View style={{ flex:1, backgroundColor:\"rgba(0,0,0,0.4)\", justifyContent:\"center\", alignItems:\"center\", padding:20 }}>\r\n+          <View style={{ width:\"100%\", maxWidth:420, backgroundColor:\"#fff\", borderRadius:12, padding:16 }}>\r\n+            <Text style={{ fontWeight:\"bold\", fontSize:16, marginBottom:12 }}>Confirm Birthday</Text>\r\n \r\n+            <Text style={{ fontSize:14, marginBottom:16 }}>\r\n+              {bdayValue\r\n+                ? bdayValue.toLocaleDateString(undefined, { year:\"numeric\", month:\"short\", day:\"2-digit\" })\r\n+                : \"—\"}\r\n+            </Text>\r\n \r\n+            <View style={{ flexDirection:\"row\", justifyContent:\"flex-end\" }}>\r\n+              <TouchableOpacity\r\n+                disabled={savingBday}\r\n+                onPress={() => setAndroidBdayConfirmOpen(false)}\r\n+                style={{ padding:10, marginRight:8 }}\r\n+              >\r\n+                <Text>Cancel</Text>\r\n+              </TouchableOpacity>\r\n+\r\n+              <TouchableOpacity\r\n+                disabled={savingBday}\r\n+                onPress={async () => {\r\n+                  await saveBday();                 // uses your existing saveBday()\r\n+                  setAndroidBdayConfirmOpen(false); // close after save\r\n+                }}\r\n+                style={{ backgroundColor:\"#5089A3\", padding:10, borderRadius:8, minWidth:90, alignItems:\"center\" }}\r\n+              >\r\n+                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+\r\n+\r\n+\r\n       {/* Phone */}\r\n       <Modal transparent visible={phoneOpen} animationType=\"fade\" onRequestClose={() => !savingPhone && setPhoneOpen(false)}>\r\n         <View style={styles.modalBack}>\r\n           <View style={styles.modalCard}>\r\n"
                },
                {
                    "date": 1761922672578,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,11 +10,22 @@\n import { ImagePickerAsset } from \"expo-image-picker\";\r\n import { API_BASE_URL } from \"../../config\";\r\n import { useFocusEffect } from \"@react-navigation/native\";\r\n import DateTimePicker from \"@react-native-community/datetimepicker\";\r\n+import { clearAuth } from \"../utils/authStorage\";\r\n \r\n const { width } = Dimensions.get(\"window\");\r\n \r\n+const asFile = (a: ImagePickerAsset | null, fallback = \"photo.jpg\") =>\r\n+  a\r\n+    ? ({\r\n+        uri: a.uri,\r\n+        name: (a as any).fileName || fallback,\r\n+        type: (a as any).mimeType || \"image/jpeg\",\r\n+      } as any)\r\n+    : null;\r\n+\r\n+\r\n // enums (mirror backend)\r\n const SECTORS = [\"East\", \"West\", \"North\", \"South\", \"Other\"] as const;\r\n const EXP_YEARS = [\"1-5 taon\", \"6-10 taon\", \"16-20 taon\", \"20 taon pataas\"] as const;\r\n \r\n@@ -324,8 +335,9 @@\n \r\n   const handleLogout = async () => {\r\n     try {\r\n       await AsyncStorage.removeItem(\"driverId\");\r\n+      await clearAuth();\r\n       Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n       router.replace(\"../login_and_reg/dlogin\");\r\n     } catch (error) {\r\n       console.error(\"❌ Logout error:\", error);\r\n@@ -544,11 +556,11 @@\n         <View style={styles.modalBack}>\r\n           <View style={styles.modalCard}>\r\n             <Text style={styles.modalTitle}>Edit Name</Text>\r\n \r\n-            <TextInput placeholder=\"First name\" value={firstNameEdit} onChangeText={setFirstNameEdit} style={styles.input} />\r\n-            <TextInput placeholder=\"Middle name (optional)\" value={middleNameEdit} onChangeText={setMiddleNameEdit} style={styles.input} />\r\n-            <TextInput placeholder=\"Last name\" value={lastNameEdit} onChangeText={setLastNameEdit} style={styles.input} />\r\n+            <TextInput placeholder=\"First name\" placeholderTextColor=\"#A0A0A0\" value={firstNameEdit} onChangeText={setFirstNameEdit} style={styles.input} />\r\n+            <TextInput placeholder=\"Middle name (optional)\" placeholderTextColor=\"#A0A0A0\" value={middleNameEdit} onChangeText={setMiddleNameEdit} style={styles.input} />\r\n+            <TextInput placeholder=\"Last name\" placeholderTextColor=\"#A0A0A0\" value={lastNameEdit} onChangeText={setLastNameEdit} style={styles.input} />\r\n \r\n             <View style={styles.modalBtns}>\r\n               <TouchableOpacity disabled={savingName} onPress={() => setNameOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n               <TouchableOpacity disabled={savingName} onPress={saveName} style={styles.btnPrimary}>\r\n@@ -574,9 +586,9 @@\n               </TouchableOpacity>\r\n             ))}\r\n \r\n             {genderChoice === \"Other\" && (\r\n-              <TextInput placeholder=\"Enter your gender\" value={genderOther} onChangeText={setGenderOther} style={[styles.input, { marginTop:8 }]} />\r\n+              <TextInput placeholder=\"Enter your gender\" placeholderTextColor=\"#A0A0A0\" value={genderOther} onChangeText={setGenderOther} style={[styles.input, { marginTop:8 }]} />\r\n             )}\r\n \r\n             <View style={styles.modalBtns}>\r\n               <TouchableOpacity disabled={savingGender} onPress={() => setGenderOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n@@ -678,9 +690,9 @@\n       <Modal transparent visible={phoneOpen} animationType=\"fade\" onRequestClose={() => !savingPhone && setPhoneOpen(false)}>\r\n         <View style={styles.modalBack}>\r\n           <View style={styles.modalCard}>\r\n             <Text style={styles.modalTitle}>Edit Contact Number</Text>\r\n-            <TextInput placeholder=\"Phone number\" keyboardType=\"phone-pad\" value={phoneValue} onChangeText={setPhoneValue} style={styles.input} />\r\n+            <TextInput placeholder=\"Phone number\" placeholderTextColor=\"#A0A0A0\" keyboardType=\"phone-pad\" value={phoneValue} onChangeText={setPhoneValue} style={styles.input} />\r\n \r\n             <View style={styles.modalBtns}>\r\n               <TouchableOpacity disabled={savingPhone} onPress={() => setPhoneOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n               <TouchableOpacity disabled={savingPhone} onPress={savePhone} style={styles.btnPrimary}>\r\n@@ -695,9 +707,9 @@\n       <Modal transparent visible={addrOpen} animationType=\"fade\" onRequestClose={() => !savingAddr && setAddrOpen(false)}>\r\n         <View style={styles.modalBack}>\r\n           <View style={styles.modalCard}>\r\n             <Text style={styles.modalTitle}>Edit Home Address</Text>\r\n-            <TextInput placeholder=\"Home address\" value={addrValue} onChangeText={setAddrValue} style={styles.input} />\r\n+            <TextInput placeholder=\"Home address\" placeholderTextColor=\"#A0A0A0\" value={addrValue} onChangeText={setAddrValue} style={styles.input} />\r\n \r\n             <View style={styles.modalBtns}>\r\n               <TouchableOpacity disabled={savingAddr} onPress={() => setAddrOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n               <TouchableOpacity disabled={savingAddr} onPress={saveAddr} style={styles.btnPrimary}>\r\n@@ -713,11 +725,11 @@\n         <View style={styles.modalBack}>\r\n           <View style={styles.modalCard}>\r\n             <Text style={styles.modalTitle}>Vehicle / Franchise</Text>\r\n \r\n-            <TextInput placeholder=\"License Number\" value={licenseValue} onChangeText={setLicenseValue} style={styles.input} />\r\n-            <TextInput placeholder=\"Franchise Number\" value={franchiseValue} onChangeText={setFranchiseValue} style={styles.input} />\r\n-            <TextInput placeholder=\"TODA Name\" value={todaValue} onChangeText={setTodaValue} style={styles.input} />\r\n+            <TextInput placeholder=\"License Number\" placeholderTextColor=\"#A0A0A0\" value={licenseValue} onChangeText={setLicenseValue} style={styles.input} />\r\n+            <TextInput placeholder=\"Franchise Number\" placeholderTextColor=\"#A0A0A0\" value={franchiseValue} onChangeText={setFranchiseValue} style={styles.input} />\r\n+            <TextInput placeholder=\"TODA Name\" placeholderTextColor=\"#A0A0A0\" value={todaValue} onChangeText={setTodaValue} style={styles.input} />\r\n \r\n             <Text style={{ marginTop: 8, marginBottom: 6, fontWeight: \"600\" }}>Sector</Text>\r\n             {SECTORS.map((s) => (\r\n               <TouchableOpacity key={s} onPress={() => setSectorValue(s)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:6 }}>\r\n"
                },
                {
                    "date": 1761922733569,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -350,17 +350,18 @@\n       <View style={styles.profileContainer}>\r\n         <View style={styles.row}>\r\n           <TouchableOpacity onPress={pickSelfieImage}>\r\n             <Image\r\n-              source={\r\n-                selfieImage\r\n-                  ? { uri: selfieImage.uri }\r\n-                  : profile?.selfieImage\r\n-                    ? { uri: `${API_BASE_URL}/${profile.selfieImage.replace(/\\\\/g, \"/\")}` }\r\n-                    : require(\"../../assets/images/profile-placeholder.jpg\")\r\n-              }\r\n-              style={styles.profileImage}\r\n-            />\r\n+  source={\r\n+    selfieImage\r\n+      ? { uri: selfieImage.uri }\r\n+      : profile?.selfieImage\r\n+        ? { uri: profile.selfieImage } // Cloudinary URL stored in DB\r\n+        : require(\"../../assets/images/profile-placeholder.jpg\")\r\n+  }\r\n+  style={styles.profileImage}\r\n+/>\r\n+\r\n           </TouchableOpacity>\r\n           <View>\r\n             <Text style={styles.username}>\r\n               {[profile?.driverFirstName, profile?.driverLastName].filter(Boolean).join(\" \")}\r\n"
                },
                {
                    "date": 1761922777259,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,20 +135,37 @@\n     }\r\n   };\r\n \r\n   const handleUploadSelfie = async () => {\r\n-    if (!selfieImage) return Alert.alert(\"Error\", \"Please select an image first.\");\r\n+    if (!selfieImage) {\r\n+      Alert.alert(\"Error\", \"Please select an image first.\");\r\n+      return;\r\n+    }\r\n+\r\n     try {\r\n       const driverId = await AsyncStorage.getItem(\"driverId\");\r\n-      if (!driverId) return;\r\n+      if (!driverId) {\r\n+        Alert.alert(\"Error\", \"Missing driver ID.\");\r\n+        return;\r\n+      }\r\n \r\n-      const formData = new FormData();\r\n-      formData.append(\"selfieImage\", { uri: selfieImage.uri, name: \"selfie.jpg\", type: \"image/jpeg\" } as any);\r\n+      const fd = new FormData();\r\n+      const S = asFile(selfieImage, \"selfie.jpg\");\r\n+      if (S) fd.append(\"selfie\", S); // backend expects \"selfie\"\r\n \r\n-      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}/photo`, { method: \"POST\", body: formData });\r\n-      const j = await res.json();\r\n-      if (!res.ok) throw new Error(j?.message || \"Failed to upload image\");\r\n+      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}/photo/selfie`, {\r\n+        method: \"POST\",\r\n+        headers: { Accept: \"application/json\" }, // let RN set the multipart boundary\r\n+        body: fd,\r\n+      });\r\n \r\n+      const text = await res.text();\r\n+      let j: any;\r\n+      try { j = JSON.parse(text); } catch { throw new Error(text || \"Non-JSON response\"); }\r\n+\r\n+      if (!res.ok) throw new Error(j?.error || j?.message || \"Upload failed\");\r\n+\r\n+      // Update local profile with the returned driver doc (now has new Cloudinary URL)\r\n       setProfile(j.driver);\r\n       setProfileImage(null);\r\n       Alert.alert(\"Success\", \"Profile image updated!\");\r\n     } catch (e: any) {\r\n@@ -156,8 +173,9 @@\n       Alert.alert(\"Error\", e.message || \"Something went wrong. Try again.\");\r\n     }\r\n   };\r\n \r\n+\r\n   // ---- Helpers ----\r\n   const fmtDate = (iso?: string) => {\r\n     if (!iso) return null;\r\n     const d = new Date(iso);\r\n@@ -350,18 +368,17 @@\n       <View style={styles.profileContainer}>\r\n         <View style={styles.row}>\r\n           <TouchableOpacity onPress={pickSelfieImage}>\r\n             <Image\r\n-  source={\r\n-    selfieImage\r\n-      ? { uri: selfieImage.uri }\r\n-      : profile?.selfieImage\r\n-        ? { uri: profile.selfieImage } // Cloudinary URL stored in DB\r\n-        : require(\"../../assets/images/profile-placeholder.jpg\")\r\n-  }\r\n-  style={styles.profileImage}\r\n-/>\r\n-\r\n+              source={\r\n+                selfieImage\r\n+                  ? { uri: selfieImage.uri }\r\n+                  : profile?.selfieImage\r\n+                    ? { uri: profile.selfieImage } // Cloudinary URL stored in DB\r\n+                    : require(\"../../assets/images/profile-placeholder.jpg\")\r\n+              }\r\n+              style={styles.profileImage}\r\n+            />\r\n           </TouchableOpacity>\r\n           <View>\r\n             <Text style={styles.username}>\r\n               {[profile?.driverFirstName, profile?.driverLastName].filter(Boolean).join(\" \")}\r\n"
                },
                {
                    "date": 1761930643148,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -77,9 +77,9 @@\n         headers: { \"Content-Type\": \"application/json\" },\r\n         body: JSON.stringify({ email: profile.email }),\r\n       });\r\n       const j = await r.json();\r\n-      if (r.ok) Alert.alert(\"Sent\", j.message || \"Verification email sent.\");\r\n+      if (r.ok) Alert.alert(\"Sent\", j.message || \"Verification email sent. Check your Spam Messages\");\r\n       else Alert.alert(\"Error\", j.message || j.error || \"Failed to send email.\");\r\n     } catch (e:any) {\r\n       Alert.alert(\"Error\", e.message || \"Network error\");\r\n     } finally {\r\n"
                },
                {
                    "date": 1761931610822,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -77,9 +77,9 @@\n         headers: { \"Content-Type\": \"application/json\" },\r\n         body: JSON.stringify({ email: profile.email }),\r\n       });\r\n       const j = await r.json();\r\n-      if (r.ok) Alert.alert(\"Sent\", j.message || \"Verification email sent. Check your Spam Messages\");\r\n+      if (r.ok) Alert.alert(\"Sent\", j.message || \"Verification email sent. Check your Spam Mail\");\r\n       else Alert.alert(\"Error\", j.message || j.error || \"Failed to send email.\");\r\n     } catch (e:any) {\r\n       Alert.alert(\"Error\", e.message || \"Network error\");\r\n     } finally {\r\n"
                },
                {
                    "date": 1761938702385,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,812 @@\n+import React, { useState } from \"react\";\r\n+import {\r\n+  View, Text, StyleSheet, Dimensions, TouchableOpacity, Image, Alert,\r\n+  Platform, ActionSheetIOS, Modal, TextInput, ActivityIndicator, ScrollView\r\n+} from \"react-native\";\r\n+import { Ionicons, MaterialIcons } from \"@expo/vector-icons\";\r\n+import { router } from 'expo-router';\r\n+import AsyncStorage from '@react-native-async-storage/async-storage';\r\n+import * as ImagePicker from \"expo-image-picker\";\r\n+import { ImagePickerAsset } from \"expo-image-picker\";\r\n+import { API_BASE_URL } from \"../../config\";\r\n+import { useFocusEffect } from \"@react-navigation/native\";\r\n+import DateTimePicker from \"@react-native-community/datetimepicker\";\r\n+import { clearAuth } from \"../utils/authStorage\";\r\n+\r\n+const { width } = Dimensions.get(\"window\");\r\n+\r\n+const asFile = (a: ImagePickerAsset | null, fallback = \"photo.jpg\") =>\r\n+  a\r\n+    ? ({\r\n+        uri: a.uri,\r\n+        name: (a as any).fileName || fallback,\r\n+        type: (a as any).mimeType || \"image/jpeg\",\r\n+      } as any)\r\n+    : null;\r\n+\r\n+\r\n+// enums (mirror backend)\r\n+const SECTORS = [\"East\", \"West\", \"North\", \"South\", \"Other\"] as const;\r\n+const EXP_YEARS = [\"1-5 taon\", \"6-10 taon\", \"16-20 taon\", \"20 taon pataas\"] as const;\r\n+\r\n+export default function DProfile() {\r\n+  const [profile, setProfile] = useState<any>(null);\r\n+  const [selfieImage, setProfileImage] = useState<ImagePickerAsset | null>(null);\r\n+  const [emailSending, setEmailSending] = useState(false);\r\n+\r\n+  // Modals state\r\n+  const [nameOpen, setNameOpen] = useState(false);\r\n+  const [firstNameEdit, setFirstNameEdit] = useState(\"\");\r\n+  const [middleNameEdit, setMiddleNameEdit] = useState(\"\");\r\n+  const [lastNameEdit, setLastNameEdit] = useState(\"\");\r\n+  const [savingName, setSavingName] = useState(false);\r\n+\r\n+  const [genderOpen, setGenderOpen] = useState(false);\r\n+  const [genderChoice, setGenderChoice] = useState<string>(\"\");\r\n+  const [genderOther, setGenderOther] = useState(\"\");\r\n+  const [savingGender, setSavingGender] = useState(false);\r\n+\r\n+  const [bdayOpen, setBdayOpen] = useState(false);           // if you don’t already have it\r\n+  const [bdayValue, setBdayValue] = useState<Date | null>(null);\r\n+  const [savingBday, setSavingBday] = useState(false);\r\n+  const [showAndroidBday, setShowAndroidBday] = useState(false);\r\n+  const [androidBdayConfirmOpen, setAndroidBdayConfirmOpen] = useState(false);\r\n+\r\n+  const [phoneOpen, setPhoneOpen] = useState(false);\r\n+  const [phoneValue, setPhoneValue] = useState(\"\");\r\n+  const [savingPhone, setSavingPhone] = useState(false);\r\n+\r\n+  const [addrOpen, setAddrOpen] = useState(false);\r\n+  const [addrValue, setAddrValue] = useState(\"\");\r\n+  const [savingAddr, setSavingAddr] = useState(false);\r\n+\r\n+  const [vehOpen, setVehOpen] = useState(false);\r\n+  const [franchiseValue, setFranchiseValue] = useState(\"\");\r\n+  const [todaValue, setTodaValue] = useState(\"\");\r\n+  const [sectorValue, setSectorValue] = useState<string>(\"\");\r\n+  const [expValue, setExpValue] = useState<string>(\"\");\r\n+  const [licenseValue, setLicenseValue] = useState(\"\");\r\n+  const [savingVeh, setSavingVeh] = useState(false);\r\n+\r\n+  const resendDriverEmail = async () => {\r\n+    if (!profile?.email) return Alert.alert(\"Error\", \"No email on file.\");\r\n+    try {\r\n+      setEmailSending(true);\r\n+      const r = await fetch(`${API_BASE_URL}/api/auth/driver/resend-verification`, {\r\n+        method: \"POST\",\r\n+        headers: { \"Content-Type\": \"application/json\" },\r\n+        body: JSON.stringify({ email: profile.email }),\r\n+      });\r\n+      const j = await r.json();\r\n+      if (r.ok) Alert.alert(\"Sent\", j.message || \"Verification email sent. Check your Spam Mail\");\r\n+      else Alert.alert(\"Error\", j.message || j.error || \"Failed to send email.\");\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Network error\");\r\n+    } finally {\r\n+      setEmailSending(false);\r\n+    }\r\n+  };\r\n+\r\n+  const fetchProfile = async () => {\r\n+    try {\r\n+      const driverId = await AsyncStorage.getItem(\"driverId\");\r\n+      if (!driverId) return;\r\n+      const response = await fetch(`${API_BASE_URL}/api/driver/${driverId}`);\r\n+      const result = await response.json();\r\n+      if (result.driver) setProfile(result.driver);\r\n+    } catch (error) {\r\n+      console.error(\"❌ Failed to fetch driver profile:\", error);\r\n+    }\r\n+  };\r\n+\r\n+  useFocusEffect(\r\n+    React.useCallback(() => {\r\n+      fetchProfile();\r\n+    }, [])\r\n+  );\r\n+\r\n+  // ---- Selfie upload (unchanged) ----\r\n+  const pickSelfieImage = async () => {\r\n+    if (Platform.OS === \"ios\") {\r\n+      ActionSheetIOS.showActionSheetWithOptions(\r\n+        { options: [\"Take a Photo\", \"Choose from Gallery\", \"Cancel\"], cancelButtonIndex: 2 },\r\n+        async (buttonIndex) => {\r\n+          if (buttonIndex === 0) {\r\n+            const result = await ImagePicker.launchCameraAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n+            if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n+          } else if (buttonIndex === 1) {\r\n+            const result = await ImagePicker.launchImageLibraryAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n+            if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n+          }\r\n+        }\r\n+      );\r\n+    } else {\r\n+      Alert.alert(\"Select Option\", \"\", [\r\n+        { text: \"Take a Photo\", onPress: async () => {\r\n+          const result = await ImagePicker.launchCameraAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n+          if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n+        }},\r\n+        { text: \"Choose from Gallery\", onPress: async () => {\r\n+          const result = await ImagePicker.launchImageLibraryAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n+          if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n+        }},\r\n+        { text: \"Cancel\", style: \"cancel\" },\r\n+      ]);\r\n+    }\r\n+  };\r\n+\r\n+  const handleUploadSelfie = async () => {\r\n+    if (!selfieImage) {\r\n+      Alert.alert(\"Error\", \"Please select an image first.\");\r\n+      return;\r\n+    }\r\n+\r\n+    try {\r\n+      const driverId = await AsyncStorage.getItem(\"driverId\");\r\n+      if (!driverId) {\r\n+        Alert.alert(\"Error\", \"Missing driver ID.\");\r\n+        return;\r\n+      }\r\n+\r\n+      const fd = new FormData();\r\n+      const S = asFile(selfieImage, \"selfie.jpg\");\r\n+      if (S) fd.append(\"selfie\", S); // backend expects \"selfie\"\r\n+\r\n+      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}/photo/selfie`, {\r\n+        method: \"POST\",\r\n+        headers: { Accept: \"application/json\" }, // let RN set the multipart boundary\r\n+        body: fd,\r\n+      });\r\n+\r\n+      const text = await res.text();\r\n+      let j: any;\r\n+      try { j = JSON.parse(text); } catch { throw new Error(text || \"Non-JSON response\"); }\r\n+\r\n+      if (!res.ok) throw new Error(j?.error || j?.message || \"Upload failed\");\r\n+\r\n+      // Update local profile with the returned driver doc (now has new Cloudinary URL)\r\n+      setProfile(j.driver);\r\n+      setProfileImage(null);\r\n+      Alert.alert(\"Success\", \"Profile image updated!\");\r\n+    } catch (e: any) {\r\n+      console.error(\"❌ Upload error:\", e);\r\n+      Alert.alert(\"Error\", e.message || \"Something went wrong. Try again.\");\r\n+    }\r\n+  };\r\n+\r\n+\r\n+  // ---- Helpers ----\r\n+  const fmtDate = (iso?: string) => {\r\n+    if (!iso) return null;\r\n+    const d = new Date(iso);\r\n+    if (Number.isNaN(d.getTime())) return null;\r\n+    return d.toLocaleDateString(undefined, { year: \"numeric\", month: \"short\", day: \"2-digit\" });\r\n+  };\r\n+\r\n+  const patchDriver = async (payload: Record<string, any>) => {\r\n+    const driverId = await AsyncStorage.getItem(\"driverId\");\r\n+    if (!driverId) throw new Error(\"Missing driverId\");\r\n+    const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}`, {\r\n+      method: \"PATCH\",\r\n+      headers: { \"Content-Type\": \"application/json\" },\r\n+      body: JSON.stringify(payload),\r\n+    });\r\n+    const j = await res.json();\r\n+    if (!res.ok) throw new Error(j?.message || \"Update failed\");\r\n+    setProfile(j.driver);\r\n+  };\r\n+\r\n+  // ---- Name modal ----\r\n+  const openName = () => {\r\n+    setFirstNameEdit(profile?.driverFirstName || \"\");\r\n+    setMiddleNameEdit(profile?.driverMiddleName || \"\");\r\n+    setLastNameEdit(profile?.driverLastName || \"\");\r\n+    setNameOpen(true);\r\n+  };\r\n+  const saveName = async () => {\r\n+    try {\r\n+      setSavingName(true);\r\n+      await patchDriver({\r\n+        driverFirstName: firstNameEdit.trim(),\r\n+        driverMiddleName: middleNameEdit.trim(),\r\n+        driverLastName: lastNameEdit.trim(),\r\n+      });\r\n+      setNameOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save name\");\r\n+    } finally {\r\n+      setSavingName(false);\r\n+    }\r\n+  };\r\n+  const selfieUri =\r\n+    selfieImage?.uri ??\r\n+    profile?.selfieImage ??\r\n+    profile?.selfie ??\r\n+    null;\r\n+\r\n+  // ---- Gender modal ----\r\n+  const openGender = () => {\r\n+    const current = profile?.gender || \"\";\r\n+    const known = [\"Male\",\"Female\",\"Nonbinary\",\"Prefer not to say\"];\r\n+    if (known.includes(current)) {\r\n+      setGenderChoice(current);\r\n+      setGenderOther(\"\");\r\n+    } else if (current) {\r\n+      setGenderChoice(\"Other\");\r\n+      setGenderOther(current);\r\n+    } else {\r\n+      setGenderChoice(\"\");\r\n+      setGenderOther(\"\");\r\n+    }\r\n+    setGenderOpen(true);\r\n+  };\r\n+  const saveGender = async () => {\r\n+    const value = genderChoice === \"Other\" ? genderOther.trim() : genderChoice;\r\n+    if (!value) return Alert.alert(\"Gender\", \"Please choose an option.\");\r\n+    if (genderChoice === \"Other\" && !genderOther.trim()) {\r\n+      return Alert.alert(\"Gender\", \"Please enter a custom gender.\");\r\n+    }\r\n+    try {\r\n+      setSavingGender(true);\r\n+      await patchDriver({ gender: value });\r\n+      setGenderOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save gender\");\r\n+    } finally {\r\n+      setSavingGender(false);\r\n+    }\r\n+  };\r\n+\r\n+  // ---- Birthday modal / picker ----\r\n+  const openBday = () => {\r\n+    const d = profile?.driverBirthdate ? new Date(profile.driverBirthdate) : null;\r\n+    const initial = d && !Number.isNaN(d.getTime()) ? d : new Date();\r\n+    setBdayValue(initial);\r\n+\r\n+    if (Platform.OS === \"android\") {\r\n+      setShowAndroidBday(true);               \r\n+    } else {\r\n+      setBdayOpen(true);                      \r\n+    }\r\n+  };\r\n+\r\n+\r\n+  const saveBday = async () => {\r\n+    if (!bdayValue) return;\r\n+    const yyyy = bdayValue.getFullYear();\r\n+    const mm = String(bdayValue.getMonth()+1).padStart(2,\"0\");\r\n+    const dd = String(bdayValue.getDate()).padStart(2,\"0\");\r\n+    const iso = `${yyyy}-${mm}-${dd}`;\r\n+    try {\r\n+      setSavingBday(true);\r\n+      await patchDriver({ driverBirthdate: iso });\r\n+      setBdayOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save birthday\");\r\n+    } finally {\r\n+      setSavingBday(false);\r\n+    }\r\n+  };\r\n+\r\n+  // ---- Phone ----\r\n+  const openPhone = () => {\r\n+    setPhoneValue(profile?.driverPhone || \"\");\r\n+    setPhoneOpen(true);\r\n+  };\r\n+  const savePhone = async () => {\r\n+    if (!phoneValue.trim()) return Alert.alert(\"Phone\", \"Enter a phone number.\");\r\n+    try {\r\n+      setSavingPhone(true);\r\n+      await patchDriver({ driverPhone: phoneValue.trim() });\r\n+      setPhoneOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save phone\");\r\n+    } finally {\r\n+      setSavingPhone(false);\r\n+    }\r\n+  };\r\n+\r\n+  // ---- Address ----\r\n+  const openAddr = () => {\r\n+    setAddrValue(profile?.homeAddress || \"\");\r\n+    setAddrOpen(true);\r\n+  };\r\n+  const saveAddr = async () => {\r\n+    try {\r\n+      setSavingAddr(true);\r\n+      await patchDriver({ homeAddress: addrValue.trim() });\r\n+      setAddrOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save address\");\r\n+    } finally {\r\n+      setSavingAddr(false);\r\n+    }\r\n+  };\r\n+\r\n+  // ---- Vehicle block (franchise/toda/sector/experience/licenseId) ----\r\n+  const openVeh = () => {\r\n+    setFranchiseValue(profile?.franchiseNumber || \"\");\r\n+    setTodaValue(profile?.todaName || \"\");\r\n+    setSectorValue(profile?.sector || \"\");\r\n+    setExpValue(profile?.experienceYears || \"\");\r\n+    setLicenseValue(profile?.licenseId || \"\");\r\n+    setVehOpen(true);\r\n+  };\r\n+  const saveVeh = async () => {\r\n+    if (sectorValue && !SECTORS.includes(sectorValue as any)) {\r\n+      return Alert.alert(\"Sector\", \"Please select a valid sector.\");\r\n+    }\r\n+    if (expValue && !EXP_YEARS.includes(expValue as any)) {\r\n+      return Alert.alert(\"Experience\", \"Please select a valid experience range.\");\r\n+    }\r\n+    try {\r\n+      setSavingVeh(true);\r\n+      await patchDriver({\r\n+        franchiseNumber: franchiseValue.trim(),\r\n+        todaName: todaValue.trim(),\r\n+        sector: sectorValue.trim(),\r\n+        experienceYears: expValue.trim(),\r\n+        licenseId: licenseValue.trim(),\r\n+      });\r\n+      setVehOpen(false);\r\n+    } catch (e:any) {\r\n+      Alert.alert(\"Error\", e.message || \"Failed to save vehicle details\");\r\n+    } finally {\r\n+      setSavingVeh(false);\r\n+    }\r\n+  };\r\n+\r\n+  const handleLogout = async () => {\r\n+    try {\r\n+      await AsyncStorage.removeItem(\"driverId\");\r\n+      await clearAuth();\r\n+      Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n+      router.replace(\"../login_and_reg/dlogin\");\r\n+    } catch (error) {\r\n+      console.error(\"❌ Logout error:\", error);\r\n+      Alert.alert(\"Error\", \"Failed to log out. Try again.\");\r\n+    }\r\n+  };\r\n+\r\n+  return (\r\n+    <View style={styles.container}>\r\n+      <View style={styles.profileContainer}>\r\n+        <View style={styles.row}>\r\n+          <TouchableOpacity onPress={pickSelfieImage}>\r\n+            <Image\r\n+              source={\r\n+                selfieImage\r\n+                  ? { uri: selfieImage.uri }\r\n+                  : profile?.selfieImage\r\n+                    ? { uri: profile.selfieImage } // Cloudinary URL stored in DB\r\n+                    : require(\"../../assets/images/profile-placeholder.jpg\")\r\n+              }\r\n+              style={styles.profileImage}\r\n+            />\r\n+          </TouchableOpacity>\r\n+          <View>\r\n+            <Text style={styles.username}>\r\n+              {[profile?.driverFirstName, profile?.driverLastName].filter(Boolean).join(\" \")}\r\n+            </Text>\r\n+            {selfieImage && (\r\n+              <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n+                <Text style={{ color: \"#fff\" }}>Upload Profile Pic</Text>\r\n+              </TouchableOpacity>\r\n+            )}\r\n+          </View>\r\n+        </View>\r\n+        <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n+          <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n+          <Text style={styles.lagout}>LogOut</Text>\r\n+        </TouchableOpacity>\r\n+      </View>\r\n+\r\n+      <ScrollView style={styles.accountContainer} contentContainerStyle={{ paddingBottom: 40 }}>\r\n+        <Text style={styles.sectionTitle}>Personal Information</Text>\r\n+\r\n+        {/* Full Name */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Full Name:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[\r\n+              styles.value,\r\n+              { color: (profile?.driverFirstName || profile?.driverMiddleName || profile?.driverLastName) ? \"#000\" : \"#999\" }\r\n+            ]}>\r\n+              {profile?.driverFirstName || \"\"} {profile?.driverMiddleName || \"\"} {profile?.driverLastName || \"\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openName} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        {/* Gender */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Gender:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.gender ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.gender || \"Set Now\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openGender} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        {/* Phone */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Contact Number:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.driverPhone ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.driverPhone || \"Set Now\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openPhone} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        {/* Birthday */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Birthday:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.driverBirthdate ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.driverBirthdate ? (fmtDate(profile.driverBirthdate) || profile.driverBirthdate) : \"Not Provided\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openBday} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        {/* Email + verify */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Email Address:</Text>\r\n+          <View style={{ alignItems: \"flex-end\" }}>\r\n+            <Text style={[styles.value, { color: profile?.email ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.email || \"Set Now\"}\r\n+            </Text>\r\n+            <View style={{ flexDirection: \"row\", alignItems: \"center\", marginTop: 4 }}>\r\n+              <View style={{\r\n+                paddingHorizontal: 8, paddingVertical: 2, borderRadius: 12,\r\n+                backgroundColor: profile?.isVerified ? \"#E6F7E9\" : \"#FFF4E5\",\r\n+                marginRight: 8,\r\n+              }}>\r\n+                <Text style={{ color: profile?.isVerified ? \"#2E7D32\" : \"#B26A00\", fontSize: 12 }}>\r\n+                  {profile?.isVerified ? \"Verified\" : \"Not verified\"}\r\n+                </Text>\r\n+              </View>\r\n+              {!profile?.isVerified && (\r\n+                <TouchableOpacity\r\n+                  disabled={emailSending}\r\n+                  onPress={resendDriverEmail}\r\n+                  style={{ paddingHorizontal: 10, paddingVertical: 6, borderRadius: 8, backgroundColor: emailSending ? \"#ccc\" : \"#5089A3\" }}\r\n+                >\r\n+                  <Text style={{ color: \"#fff\", fontSize: 12 }}>\r\n+                    {emailSending ? \"Sending...\" : \"Verify email\"}\r\n+                  </Text>\r\n+                </TouchableOpacity>\r\n+              )}\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        {/* Address */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Home Address:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.homeAddress ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.homeAddress || \"Set Now\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openAddr} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        <Text style={styles.sectionTitle}>Vehicle Details</Text>\r\n+\r\n+        {/* License ID */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>License Number:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.licenseId ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.licenseId || \"Set Now\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        {/* Franchise */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Franchise Number:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.franchiseNumber ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.franchiseNumber || \"Set Now\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        {/* TODA */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>TODA Name:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.todaName ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.todaName || \"Set Now\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        {/* Sector */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Sector:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.sector ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.sector || \"Set Now\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+\r\n+        {/* Experience */}\r\n+        <View style={styles.infoRow}>\r\n+          <Text style={styles.label}>Experience:</Text>\r\n+          <View style={styles.row}>\r\n+            <Text style={[styles.value, { color: profile?.experienceYears ? \"#000\" : \"#999\" }]}>\r\n+              {profile?.experienceYears || \"Set Now\"}\r\n+            </Text>\r\n+            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n+              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+            </TouchableOpacity>\r\n+          </View>\r\n+        </View>\r\n+      </ScrollView>\r\n+\r\n+      {/* ------- Modals ------- */}\r\n+\r\n+      {/* Name */}\r\n+      <Modal transparent visible={nameOpen} animationType=\"fade\" onRequestClose={() => !savingName && setNameOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Edit Name</Text>\r\n+\r\n+            <TextInput placeholder=\"First name\" placeholderTextColor=\"#A0A0A0\" value={firstNameEdit} onChangeText={setFirstNameEdit} style={styles.input} />\r\n+            <TextInput placeholder=\"Middle name (optional)\" placeholderTextColor=\"#A0A0A0\" value={middleNameEdit} onChangeText={setMiddleNameEdit} style={styles.input} />\r\n+            <TextInput placeholder=\"Last name\" placeholderTextColor=\"#A0A0A0\" value={lastNameEdit} onChangeText={setLastNameEdit} style={styles.input} />\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingName} onPress={() => setNameOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingName} onPress={saveName} style={styles.btnPrimary}>\r\n+                {savingName ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Gender */}\r\n+      <Modal transparent visible={genderOpen} animationType=\"fade\" onRequestClose={() => !savingGender && setGenderOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Select Gender</Text>\r\n+\r\n+            {[\"Male\",\"Female\",\"Nonbinary\",\"Prefer not to say\",\"Other\"].map((opt) => (\r\n+              <TouchableOpacity key={opt} onPress={() => setGenderChoice(opt)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:8 }}>\r\n+                <View style={styles.radioOuter}>\r\n+                  {genderChoice === opt ? <View style={styles.radioInner} /> : null}\r\n+                </View>\r\n+                <Text>{opt}</Text>\r\n+              </TouchableOpacity>\r\n+            ))}\r\n+\r\n+            {genderChoice === \"Other\" && (\r\n+              <TextInput placeholder=\"Enter your gender\" placeholderTextColor=\"#A0A0A0\" value={genderOther} onChangeText={setGenderOther} style={[styles.input, { marginTop:8 }]} />\r\n+            )}\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingGender} onPress={() => setGenderOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingGender} onPress={saveGender} style={styles.btnPrimary}>\r\n+                {savingGender ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Birthday (iOS styled modal) */}\r\n+      <Modal transparent visible={bdayOpen && Platform.OS === \"ios\"} animationType=\"fade\" onRequestClose={() => !savingBday && setBdayOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Select Birthday</Text>\r\n+\r\n+            {bdayValue && (\r\n+              <DateTimePicker\r\n+                mode=\"date\"\r\n+                value={bdayValue}\r\n+                display=\"spinner\"\r\n+                onChange={(_, d) => d && setBdayValue(d)}\r\n+                maximumDate={new Date()}\r\n+              />\r\n+            )}\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingBday} onPress={() => setBdayOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingBday} onPress={saveBday} style={styles.btnPrimary}>\r\n+                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Android Date Picker */}\r\n+      {Platform.OS === \"android\" && showAndroidBday && (\r\n+        <DateTimePicker\r\n+          mode=\"date\"\r\n+          value={bdayValue ?? new Date()}\r\n+          display=\"calendar\"\r\n+          maximumDate={new Date()}\r\n+          onChange={(_, date) => {\r\n+            setShowAndroidBday(false);            \r\n+            if (date) {\r\n+              setBdayValue(date);                 \r\n+              setAndroidBdayConfirmOpen(true);    \r\n+            }\r\n+          }}\r\n+        />\r\n+      )}\r\n+\r\n+      <Modal\r\n+        transparent\r\n+        visible={androidBdayConfirmOpen}\r\n+        animationType=\"fade\"\r\n+        onRequestClose={() => !savingBday && setAndroidBdayConfirmOpen(false)}\r\n+      >\r\n+        <View style={{ flex:1, backgroundColor:\"rgba(0,0,0,0.4)\", justifyContent:\"center\", alignItems:\"center\", padding:20 }}>\r\n+          <View style={{ width:\"100%\", maxWidth:420, backgroundColor:\"#fff\", borderRadius:12, padding:16 }}>\r\n+            <Text style={{ fontWeight:\"bold\", fontSize:16, marginBottom:12 }}>Confirm Birthday</Text>\r\n+\r\n+            <Text style={{ fontSize:14, marginBottom:16 }}>\r\n+              {bdayValue\r\n+                ? bdayValue.toLocaleDateString(undefined, { year:\"numeric\", month:\"short\", day:\"2-digit\" })\r\n+                : \"—\"}\r\n+            </Text>\r\n+\r\n+            <View style={{ flexDirection:\"row\", justifyContent:\"flex-end\" }}>\r\n+              <TouchableOpacity\r\n+                disabled={savingBday}\r\n+                onPress={() => setAndroidBdayConfirmOpen(false)}\r\n+                style={{ padding:10, marginRight:8 }}\r\n+              >\r\n+                <Text>Cancel</Text>\r\n+              </TouchableOpacity>\r\n+\r\n+              <TouchableOpacity\r\n+                disabled={savingBday}\r\n+                onPress={async () => {\r\n+                  await saveBday();                 // uses your existing saveBday()\r\n+                  setAndroidBdayConfirmOpen(false); // close after save\r\n+                }}\r\n+                style={{ backgroundColor:\"#5089A3\", padding:10, borderRadius:8, minWidth:90, alignItems:\"center\" }}\r\n+              >\r\n+                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+\r\n+\r\n+\r\n+      {/* Phone */}\r\n+      <Modal transparent visible={phoneOpen} animationType=\"fade\" onRequestClose={() => !savingPhone && setPhoneOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Edit Contact Number</Text>\r\n+            <TextInput placeholder=\"Phone number\" placeholderTextColor=\"#A0A0A0\" keyboardType=\"phone-pad\" value={phoneValue} onChangeText={setPhoneValue} style={styles.input} />\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingPhone} onPress={() => setPhoneOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingPhone} onPress={savePhone} style={styles.btnPrimary}>\r\n+                {savingPhone ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Address */}\r\n+      <Modal transparent visible={addrOpen} animationType=\"fade\" onRequestClose={() => !savingAddr && setAddrOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Edit Home Address</Text>\r\n+            <TextInput placeholder=\"Home address\" placeholderTextColor=\"#A0A0A0\" value={addrValue} onChangeText={setAddrValue} style={styles.input} />\r\n+\r\n+            <View style={styles.modalBtns}>\r\n+              <TouchableOpacity disabled={savingAddr} onPress={() => setAddrOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingAddr} onPress={saveAddr} style={styles.btnPrimary}>\r\n+                {savingAddr ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+      {/* Vehicle details */}\r\n+      <Modal transparent visible={vehOpen} animationType=\"fade\" onRequestClose={() => !savingVeh && setVehOpen(false)}>\r\n+        <View style={styles.modalBack}>\r\n+          <View style={styles.modalCard}>\r\n+            <Text style={styles.modalTitle}>Vehicle / Franchise</Text>\r\n+\r\n+            <TextInput placeholder=\"License Number\" placeholderTextColor=\"#A0A0A0\" value={licenseValue} onChangeText={setLicenseValue} style={styles.input} />\r\n+            <TextInput placeholder=\"Franchise Number\" placeholderTextColor=\"#A0A0A0\" value={franchiseValue} onChangeText={setFranchiseValue} style={styles.input} />\r\n+            <TextInput placeholder=\"TODA Name\" placeholderTextColor=\"#A0A0A0\" value={todaValue} onChangeText={setTodaValue} style={styles.input} />\r\n+\r\n+            <Text style={{ marginTop: 8, marginBottom: 6, fontWeight: \"600\" }}>Sector</Text>\r\n+            {SECTORS.map((s) => (\r\n+              <TouchableOpacity key={s} onPress={() => setSectorValue(s)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:6 }}>\r\n+                <View style={styles.radioOuter}>{sectorValue === s ? <View style={styles.radioInner} /> : null}</View>\r\n+                <Text>{s}</Text>\r\n+              </TouchableOpacity>\r\n+            ))}\r\n+\r\n+            <Text style={{ marginTop: 12, marginBottom: 6, fontWeight: \"600\" }}>Experience</Text>\r\n+            {EXP_YEARS.map((e) => (\r\n+              <TouchableOpacity key={e} onPress={() => setExpValue(e)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:6 }}>\r\n+                <View style={styles.radioOuter}>{expValue === e ? <View style={styles.radioInner} /> : null}</View>\r\n+                <Text>{e}</Text>\r\n+              </TouchableOpacity>\r\n+            ))}\r\n+\r\n+            <View style={[styles.modalBtns, { marginTop: 12 }]}>\r\n+              <TouchableOpacity disabled={savingVeh} onPress={() => setVehOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n+              <TouchableOpacity disabled={savingVeh} onPress={saveVeh} style={styles.btnPrimary}>\r\n+                {savingVeh ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+              </TouchableOpacity>\r\n+            </View>\r\n+          </View>\r\n+        </View>\r\n+      </Modal>\r\n+\r\n+    </View>\r\n+  );\r\n+}\r\n+\r\n+const styles = StyleSheet.create({\r\n+  container: { flex: 1, backgroundColor: \"#fff\" },\r\n+  profileContainer: { alignItems: \"center\", paddingTop: 50, flexDirection:\"row\", marginHorizontal:20, justifyContent: \"space-between\"},\r\n+  profileImage: { width: 100, height: 100, borderRadius: 50},\r\n+  username: { fontSize: 18, fontWeight: \"bold\", paddingLeft:20 },\r\n+  lagout: { fontSize: 14, fontWeight: \"bold\"},\r\n+  uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n+  accountContainer: { marginTop: 10, paddingHorizontal: 20 },\r\n+  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 10 },\r\n+  infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n+  row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n+  label: { fontSize: 14, color: \"#333\" },\r\n+  value: { fontSize: 14, color: \"#333\", maxWidth: width * 0.55 },\r\n+\r\n+  // modal\r\n+  modalBack: { flex:1, backgroundColor:\"rgba(0,0,0,0.4)\", justifyContent:\"center\", alignItems:\"center\", padding:20 },\r\n+  modalCard: { width:\"100%\", maxWidth:420, backgroundColor:\"#fff\", borderRadius:12, padding:16 },\r\n+  modalTitle: { fontWeight:\"bold\", fontSize:16, marginBottom:8 },\r\n+  input: { borderWidth:1, borderColor:\"#ddd\", borderRadius:8, paddingHorizontal:12, paddingVertical:10, marginBottom:8 },\r\n+\r\n+  modalBtns: { flexDirection:\"row\", justifyContent:\"flex-end\", gap: 12 },\r\n+  btnGhost: { paddingVertical:10, paddingHorizontal:14 },\r\n+  btnPrimary: { backgroundColor:\"#5089A3\", paddingVertical:10, paddingHorizontal:14, borderRadius:8, minWidth:90, alignItems:\"center\" },\r\n+\r\n+  radioOuter: { width:18, height:18, borderRadius:9, borderWidth:2, borderColor:\"#5089A3\", alignItems:\"center\", justifyContent:\"center\", marginRight:10 },\r\n+  radioInner: { width:10, height:10, borderRadius:5, backgroundColor:\"#5089A3\" },\r\n+});\r\n"
                },
                {
                    "date": 1761938742544,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -373,15 +373,15 @@\n       <View style={styles.profileContainer}>\r\n         <View style={styles.row}>\r\n           <TouchableOpacity onPress={pickSelfieImage}>\r\n             <Image\r\n+              key={(selfieUri || \"empty\") + \"\"}     \r\n               source={\r\n-                selfieImage\r\n-                  ? { uri: selfieImage.uri }\r\n-                  : profile?.selfieImage\r\n-                    ? { uri: profile.selfieImage } // Cloudinary URL stored in DB\r\n-                    : require(\"../../assets/images/profile-placeholder.jpg\")\r\n+                selfieUri\r\n+                  ? { uri: `${String(selfieUri).trim()}?t=${Date.now()}` } \r\n+                  : require(\"../../assets/images/profile-placeholder.jpg\")\r\n               }\r\n+              defaultSource={require(\"../../assets/images/profile-placeholder.jpg\")} \r\n               style={styles.profileImage}\r\n             />\r\n           </TouchableOpacity>\r\n           <View>\r\n@@ -809,811 +809,4 @@\n \r\n   radioOuter: { width:18, height:18, borderRadius:9, borderWidth:2, borderColor:\"#5089A3\", alignItems:\"center\", justifyContent:\"center\", marginRight:10 },\r\n   radioInner: { width:10, height:10, borderRadius:5, backgroundColor:\"#5089A3\" },\r\n });\r\n-import React, { useState } from \"react\";\r\n-import {\r\n-  View, Text, StyleSheet, Dimensions, TouchableOpacity, Image, Alert,\r\n-  Platform, ActionSheetIOS, Modal, TextInput, ActivityIndicator, ScrollView\r\n-} from \"react-native\";\r\n-import { Ionicons, MaterialIcons } from \"@expo/vector-icons\";\r\n-import { router } from 'expo-router';\r\n-import AsyncStorage from '@react-native-async-storage/async-storage';\r\n-import * as ImagePicker from \"expo-image-picker\";\r\n-import { ImagePickerAsset } from \"expo-image-picker\";\r\n-import { API_BASE_URL } from \"../../config\";\r\n-import { useFocusEffect } from \"@react-navigation/native\";\r\n-import DateTimePicker from \"@react-native-community/datetimepicker\";\r\n-import { clearAuth } from \"../utils/authStorage\";\r\n-\r\n-const { width } = Dimensions.get(\"window\");\r\n-\r\n-const asFile = (a: ImagePickerAsset | null, fallback = \"photo.jpg\") =>\r\n-  a\r\n-    ? ({\r\n-        uri: a.uri,\r\n-        name: (a as any).fileName || fallback,\r\n-        type: (a as any).mimeType || \"image/jpeg\",\r\n-      } as any)\r\n-    : null;\r\n-\r\n-\r\n-// enums (mirror backend)\r\n-const SECTORS = [\"East\", \"West\", \"North\", \"South\", \"Other\"] as const;\r\n-const EXP_YEARS = [\"1-5 taon\", \"6-10 taon\", \"16-20 taon\", \"20 taon pataas\"] as const;\r\n-\r\n-export default function DProfile() {\r\n-  const [profile, setProfile] = useState<any>(null);\r\n-  const [selfieImage, setProfileImage] = useState<ImagePickerAsset | null>(null);\r\n-  const [emailSending, setEmailSending] = useState(false);\r\n-\r\n-  // Modals state\r\n-  const [nameOpen, setNameOpen] = useState(false);\r\n-  const [firstNameEdit, setFirstNameEdit] = useState(\"\");\r\n-  const [middleNameEdit, setMiddleNameEdit] = useState(\"\");\r\n-  const [lastNameEdit, setLastNameEdit] = useState(\"\");\r\n-  const [savingName, setSavingName] = useState(false);\r\n-\r\n-  const [genderOpen, setGenderOpen] = useState(false);\r\n-  const [genderChoice, setGenderChoice] = useState<string>(\"\");\r\n-  const [genderOther, setGenderOther] = useState(\"\");\r\n-  const [savingGender, setSavingGender] = useState(false);\r\n-\r\n-  const [bdayOpen, setBdayOpen] = useState(false);           // if you don’t already have it\r\n-  const [bdayValue, setBdayValue] = useState<Date | null>(null);\r\n-  const [savingBday, setSavingBday] = useState(false);\r\n-  const [showAndroidBday, setShowAndroidBday] = useState(false);\r\n-  const [androidBdayConfirmOpen, setAndroidBdayConfirmOpen] = useState(false);\r\n-\r\n-  const [phoneOpen, setPhoneOpen] = useState(false);\r\n-  const [phoneValue, setPhoneValue] = useState(\"\");\r\n-  const [savingPhone, setSavingPhone] = useState(false);\r\n-\r\n-  const [addrOpen, setAddrOpen] = useState(false);\r\n-  const [addrValue, setAddrValue] = useState(\"\");\r\n-  const [savingAddr, setSavingAddr] = useState(false);\r\n-\r\n-  const [vehOpen, setVehOpen] = useState(false);\r\n-  const [franchiseValue, setFranchiseValue] = useState(\"\");\r\n-  const [todaValue, setTodaValue] = useState(\"\");\r\n-  const [sectorValue, setSectorValue] = useState<string>(\"\");\r\n-  const [expValue, setExpValue] = useState<string>(\"\");\r\n-  const [licenseValue, setLicenseValue] = useState(\"\");\r\n-  const [savingVeh, setSavingVeh] = useState(false);\r\n-\r\n-  const resendDriverEmail = async () => {\r\n-    if (!profile?.email) return Alert.alert(\"Error\", \"No email on file.\");\r\n-    try {\r\n-      setEmailSending(true);\r\n-      const r = await fetch(`${API_BASE_URL}/api/auth/driver/resend-verification`, {\r\n-        method: \"POST\",\r\n-        headers: { \"Content-Type\": \"application/json\" },\r\n-        body: JSON.stringify({ email: profile.email }),\r\n-      });\r\n-      const j = await r.json();\r\n-      if (r.ok) Alert.alert(\"Sent\", j.message || \"Verification email sent. Check your Spam Mail\");\r\n-      else Alert.alert(\"Error\", j.message || j.error || \"Failed to send email.\");\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Network error\");\r\n-    } finally {\r\n-      setEmailSending(false);\r\n-    }\r\n-  };\r\n-\r\n-  const fetchProfile = async () => {\r\n-    try {\r\n-      const driverId = await AsyncStorage.getItem(\"driverId\");\r\n-      if (!driverId) return;\r\n-      const response = await fetch(`${API_BASE_URL}/api/driver/${driverId}`);\r\n-      const result = await response.json();\r\n-      if (result.driver) setProfile(result.driver);\r\n-    } catch (error) {\r\n-      console.error(\"❌ Failed to fetch driver profile:\", error);\r\n-    }\r\n-  };\r\n-\r\n-  useFocusEffect(\r\n-    React.useCallback(() => {\r\n-      fetchProfile();\r\n-    }, [])\r\n-  );\r\n-\r\n-  // ---- Selfie upload (unchanged) ----\r\n-  const pickSelfieImage = async () => {\r\n-    if (Platform.OS === \"ios\") {\r\n-      ActionSheetIOS.showActionSheetWithOptions(\r\n-        { options: [\"Take a Photo\", \"Choose from Gallery\", \"Cancel\"], cancelButtonIndex: 2 },\r\n-        async (buttonIndex) => {\r\n-          if (buttonIndex === 0) {\r\n-            const result = await ImagePicker.launchCameraAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n-            if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n-          } else if (buttonIndex === 1) {\r\n-            const result = await ImagePicker.launchImageLibraryAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n-            if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n-          }\r\n-        }\r\n-      );\r\n-    } else {\r\n-      Alert.alert(\"Select Option\", \"\", [\r\n-        { text: \"Take a Photo\", onPress: async () => {\r\n-          const result = await ImagePicker.launchCameraAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n-          if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n-        }},\r\n-        { text: \"Choose from Gallery\", onPress: async () => {\r\n-          const result = await ImagePicker.launchImageLibraryAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n-          if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n-        }},\r\n-        { text: \"Cancel\", style: \"cancel\" },\r\n-      ]);\r\n-    }\r\n-  };\r\n-\r\n-  const handleUploadSelfie = async () => {\r\n-    if (!selfieImage) {\r\n-      Alert.alert(\"Error\", \"Please select an image first.\");\r\n-      return;\r\n-    }\r\n-\r\n-    try {\r\n-      const driverId = await AsyncStorage.getItem(\"driverId\");\r\n-      if (!driverId) {\r\n-        Alert.alert(\"Error\", \"Missing driver ID.\");\r\n-        return;\r\n-      }\r\n-\r\n-      const fd = new FormData();\r\n-      const S = asFile(selfieImage, \"selfie.jpg\");\r\n-      if (S) fd.append(\"selfie\", S); // backend expects \"selfie\"\r\n-\r\n-      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}/photo/selfie`, {\r\n-        method: \"POST\",\r\n-        headers: { Accept: \"application/json\" }, // let RN set the multipart boundary\r\n-        body: fd,\r\n-      });\r\n-\r\n-      const text = await res.text();\r\n-      let j: any;\r\n-      try { j = JSON.parse(text); } catch { throw new Error(text || \"Non-JSON response\"); }\r\n-\r\n-      if (!res.ok) throw new Error(j?.error || j?.message || \"Upload failed\");\r\n-\r\n-      // Update local profile with the returned driver doc (now has new Cloudinary URL)\r\n-      setProfile(j.driver);\r\n-      setProfileImage(null);\r\n-      Alert.alert(\"Success\", \"Profile image updated!\");\r\n-    } catch (e: any) {\r\n-      console.error(\"❌ Upload error:\", e);\r\n-      Alert.alert(\"Error\", e.message || \"Something went wrong. Try again.\");\r\n-    }\r\n-  };\r\n-\r\n-\r\n-  // ---- Helpers ----\r\n-  const fmtDate = (iso?: string) => {\r\n-    if (!iso) return null;\r\n-    const d = new Date(iso);\r\n-    if (Number.isNaN(d.getTime())) return null;\r\n-    return d.toLocaleDateString(undefined, { year: \"numeric\", month: \"short\", day: \"2-digit\" });\r\n-  };\r\n-\r\n-  const patchDriver = async (payload: Record<string, any>) => {\r\n-    const driverId = await AsyncStorage.getItem(\"driverId\");\r\n-    if (!driverId) throw new Error(\"Missing driverId\");\r\n-    const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}`, {\r\n-      method: \"PATCH\",\r\n-      headers: { \"Content-Type\": \"application/json\" },\r\n-      body: JSON.stringify(payload),\r\n-    });\r\n-    const j = await res.json();\r\n-    if (!res.ok) throw new Error(j?.message || \"Update failed\");\r\n-    setProfile(j.driver);\r\n-  };\r\n-\r\n-  // ---- Name modal ----\r\n-  const openName = () => {\r\n-    setFirstNameEdit(profile?.driverFirstName || \"\");\r\n-    setMiddleNameEdit(profile?.driverMiddleName || \"\");\r\n-    setLastNameEdit(profile?.driverLastName || \"\");\r\n-    setNameOpen(true);\r\n-  };\r\n-  const saveName = async () => {\r\n-    try {\r\n-      setSavingName(true);\r\n-      await patchDriver({\r\n-        driverFirstName: firstNameEdit.trim(),\r\n-        driverMiddleName: middleNameEdit.trim(),\r\n-        driverLastName: lastNameEdit.trim(),\r\n-      });\r\n-      setNameOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save name\");\r\n-    } finally {\r\n-      setSavingName(false);\r\n-    }\r\n-  };\r\n-\r\n-  // ---- Gender modal ----\r\n-  const openGender = () => {\r\n-    const current = profile?.gender || \"\";\r\n-    const known = [\"Male\",\"Female\",\"Nonbinary\",\"Prefer not to say\"];\r\n-    if (known.includes(current)) {\r\n-      setGenderChoice(current);\r\n-      setGenderOther(\"\");\r\n-    } else if (current) {\r\n-      setGenderChoice(\"Other\");\r\n-      setGenderOther(current);\r\n-    } else {\r\n-      setGenderChoice(\"\");\r\n-      setGenderOther(\"\");\r\n-    }\r\n-    setGenderOpen(true);\r\n-  };\r\n-  const saveGender = async () => {\r\n-    const value = genderChoice === \"Other\" ? genderOther.trim() : genderChoice;\r\n-    if (!value) return Alert.alert(\"Gender\", \"Please choose an option.\");\r\n-    if (genderChoice === \"Other\" && !genderOther.trim()) {\r\n-      return Alert.alert(\"Gender\", \"Please enter a custom gender.\");\r\n-    }\r\n-    try {\r\n-      setSavingGender(true);\r\n-      await patchDriver({ gender: value });\r\n-      setGenderOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save gender\");\r\n-    } finally {\r\n-      setSavingGender(false);\r\n-    }\r\n-  };\r\n-\r\n-  // ---- Birthday modal / picker ----\r\n-  const openBday = () => {\r\n-    const d = profile?.driverBirthdate ? new Date(profile.driverBirthdate) : null;\r\n-    const initial = d && !Number.isNaN(d.getTime()) ? d : new Date();\r\n-    setBdayValue(initial);\r\n-\r\n-    if (Platform.OS === \"android\") {\r\n-      setShowAndroidBday(true);               \r\n-    } else {\r\n-      setBdayOpen(true);                      \r\n-    }\r\n-  };\r\n-\r\n-\r\n-  const saveBday = async () => {\r\n-    if (!bdayValue) return;\r\n-    const yyyy = bdayValue.getFullYear();\r\n-    const mm = String(bdayValue.getMonth()+1).padStart(2,\"0\");\r\n-    const dd = String(bdayValue.getDate()).padStart(2,\"0\");\r\n-    const iso = `${yyyy}-${mm}-${dd}`;\r\n-    try {\r\n-      setSavingBday(true);\r\n-      await patchDriver({ driverBirthdate: iso });\r\n-      setBdayOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save birthday\");\r\n-    } finally {\r\n-      setSavingBday(false);\r\n-    }\r\n-  };\r\n-\r\n-  // ---- Phone ----\r\n-  const openPhone = () => {\r\n-    setPhoneValue(profile?.driverPhone || \"\");\r\n-    setPhoneOpen(true);\r\n-  };\r\n-  const savePhone = async () => {\r\n-    if (!phoneValue.trim()) return Alert.alert(\"Phone\", \"Enter a phone number.\");\r\n-    try {\r\n-      setSavingPhone(true);\r\n-      await patchDriver({ driverPhone: phoneValue.trim() });\r\n-      setPhoneOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save phone\");\r\n-    } finally {\r\n-      setSavingPhone(false);\r\n-    }\r\n-  };\r\n-\r\n-  // ---- Address ----\r\n-  const openAddr = () => {\r\n-    setAddrValue(profile?.homeAddress || \"\");\r\n-    setAddrOpen(true);\r\n-  };\r\n-  const saveAddr = async () => {\r\n-    try {\r\n-      setSavingAddr(true);\r\n-      await patchDriver({ homeAddress: addrValue.trim() });\r\n-      setAddrOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save address\");\r\n-    } finally {\r\n-      setSavingAddr(false);\r\n-    }\r\n-  };\r\n-\r\n-  // ---- Vehicle block (franchise/toda/sector/experience/licenseId) ----\r\n-  const openVeh = () => {\r\n-    setFranchiseValue(profile?.franchiseNumber || \"\");\r\n-    setTodaValue(profile?.todaName || \"\");\r\n-    setSectorValue(profile?.sector || \"\");\r\n-    setExpValue(profile?.experienceYears || \"\");\r\n-    setLicenseValue(profile?.licenseId || \"\");\r\n-    setVehOpen(true);\r\n-  };\r\n-  const saveVeh = async () => {\r\n-    if (sectorValue && !SECTORS.includes(sectorValue as any)) {\r\n-      return Alert.alert(\"Sector\", \"Please select a valid sector.\");\r\n-    }\r\n-    if (expValue && !EXP_YEARS.includes(expValue as any)) {\r\n-      return Alert.alert(\"Experience\", \"Please select a valid experience range.\");\r\n-    }\r\n-    try {\r\n-      setSavingVeh(true);\r\n-      await patchDriver({\r\n-        franchiseNumber: franchiseValue.trim(),\r\n-        todaName: todaValue.trim(),\r\n-        sector: sectorValue.trim(),\r\n-        experienceYears: expValue.trim(),\r\n-        licenseId: licenseValue.trim(),\r\n-      });\r\n-      setVehOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save vehicle details\");\r\n-    } finally {\r\n-      setSavingVeh(false);\r\n-    }\r\n-  };\r\n-\r\n-  const handleLogout = async () => {\r\n-    try {\r\n-      await AsyncStorage.removeItem(\"driverId\");\r\n-      await clearAuth();\r\n-      Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n-      router.replace(\"../login_and_reg/dlogin\");\r\n-    } catch (error) {\r\n-      console.error(\"❌ Logout error:\", error);\r\n-      Alert.alert(\"Error\", \"Failed to log out. Try again.\");\r\n-    }\r\n-  };\r\n-\r\n-  return (\r\n-    <View style={styles.container}>\r\n-      <View style={styles.profileContainer}>\r\n-        <View style={styles.row}>\r\n-          <TouchableOpacity onPress={pickSelfieImage}>\r\n-            <Image\r\n-              source={\r\n-                selfieImage\r\n-                  ? { uri: selfieImage.uri }\r\n-                  : profile?.selfieImage\r\n-                    ? { uri: profile.selfieImage } // Cloudinary URL stored in DB\r\n-                    : require(\"../../assets/images/profile-placeholder.jpg\")\r\n-              }\r\n-              style={styles.profileImage}\r\n-            />\r\n-          </TouchableOpacity>\r\n-          <View>\r\n-            <Text style={styles.username}>\r\n-              {[profile?.driverFirstName, profile?.driverLastName].filter(Boolean).join(\" \")}\r\n-            </Text>\r\n-            {selfieImage && (\r\n-              <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n-                <Text style={{ color: \"#fff\" }}>Upload Profile Pic</Text>\r\n-              </TouchableOpacity>\r\n-            )}\r\n-          </View>\r\n-        </View>\r\n-        <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n-          <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n-          <Text style={styles.lagout}>LogOut</Text>\r\n-        </TouchableOpacity>\r\n-      </View>\r\n-\r\n-      <ScrollView style={styles.accountContainer} contentContainerStyle={{ paddingBottom: 40 }}>\r\n-        <Text style={styles.sectionTitle}>Personal Information</Text>\r\n-\r\n-        {/* Full Name */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Full Name:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[\r\n-              styles.value,\r\n-              { color: (profile?.driverFirstName || profile?.driverMiddleName || profile?.driverLastName) ? \"#000\" : \"#999\" }\r\n-            ]}>\r\n-              {profile?.driverFirstName || \"\"} {profile?.driverMiddleName || \"\"} {profile?.driverLastName || \"\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openName} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Gender */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Gender:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.gender ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.gender || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openGender} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Phone */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Contact Number:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.driverPhone ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.driverPhone || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openPhone} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Birthday */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Birthday:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.driverBirthdate ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.driverBirthdate ? (fmtDate(profile.driverBirthdate) || profile.driverBirthdate) : \"Not Provided\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openBday} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Email + verify */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Email Address:</Text>\r\n-          <View style={{ alignItems: \"flex-end\" }}>\r\n-            <Text style={[styles.value, { color: profile?.email ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.email || \"Set Now\"}\r\n-            </Text>\r\n-            <View style={{ flexDirection: \"row\", alignItems: \"center\", marginTop: 4 }}>\r\n-              <View style={{\r\n-                paddingHorizontal: 8, paddingVertical: 2, borderRadius: 12,\r\n-                backgroundColor: profile?.isVerified ? \"#E6F7E9\" : \"#FFF4E5\",\r\n-                marginRight: 8,\r\n-              }}>\r\n-                <Text style={{ color: profile?.isVerified ? \"#2E7D32\" : \"#B26A00\", fontSize: 12 }}>\r\n-                  {profile?.isVerified ? \"Verified\" : \"Not verified\"}\r\n-                </Text>\r\n-              </View>\r\n-              {!profile?.isVerified && (\r\n-                <TouchableOpacity\r\n-                  disabled={emailSending}\r\n-                  onPress={resendDriverEmail}\r\n-                  style={{ paddingHorizontal: 10, paddingVertical: 6, borderRadius: 8, backgroundColor: emailSending ? \"#ccc\" : \"#5089A3\" }}\r\n-                >\r\n-                  <Text style={{ color: \"#fff\", fontSize: 12 }}>\r\n-                    {emailSending ? \"Sending...\" : \"Verify email\"}\r\n-                  </Text>\r\n-                </TouchableOpacity>\r\n-              )}\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Address */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Home Address:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.homeAddress ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.homeAddress || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openAddr} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        <Text style={styles.sectionTitle}>Vehicle Details</Text>\r\n-\r\n-        {/* License ID */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>License Number:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.licenseId ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.licenseId || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Franchise */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Franchise Number:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.franchiseNumber ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.franchiseNumber || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* TODA */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>TODA Name:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.todaName ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.todaName || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Sector */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Sector:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.sector ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.sector || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Experience */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Experience:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.experienceYears ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.experienceYears || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-      </ScrollView>\r\n-\r\n-      {/* ------- Modals ------- */}\r\n-\r\n-      {/* Name */}\r\n-      <Modal transparent visible={nameOpen} animationType=\"fade\" onRequestClose={() => !savingName && setNameOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Edit Name</Text>\r\n-\r\n-            <TextInput placeholder=\"First name\" placeholderTextColor=\"#A0A0A0\" value={firstNameEdit} onChangeText={setFirstNameEdit} style={styles.input} />\r\n-            <TextInput placeholder=\"Middle name (optional)\" placeholderTextColor=\"#A0A0A0\" value={middleNameEdit} onChangeText={setMiddleNameEdit} style={styles.input} />\r\n-            <TextInput placeholder=\"Last name\" placeholderTextColor=\"#A0A0A0\" value={lastNameEdit} onChangeText={setLastNameEdit} style={styles.input} />\r\n-\r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingName} onPress={() => setNameOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingName} onPress={saveName} style={styles.btnPrimary}>\r\n-                {savingName ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n-\r\n-      {/* Gender */}\r\n-      <Modal transparent visible={genderOpen} animationType=\"fade\" onRequestClose={() => !savingGender && setGenderOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Select Gender</Text>\r\n-\r\n-            {[\"Male\",\"Female\",\"Nonbinary\",\"Prefer not to say\",\"Other\"].map((opt) => (\r\n-              <TouchableOpacity key={opt} onPress={() => setGenderChoice(opt)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:8 }}>\r\n-                <View style={styles.radioOuter}>\r\n-                  {genderChoice === opt ? <View style={styles.radioInner} /> : null}\r\n-                </View>\r\n-                <Text>{opt}</Text>\r\n-              </TouchableOpacity>\r\n-            ))}\r\n-\r\n-            {genderChoice === \"Other\" && (\r\n-              <TextInput placeholder=\"Enter your gender\" placeholderTextColor=\"#A0A0A0\" value={genderOther} onChangeText={setGenderOther} style={[styles.input, { marginTop:8 }]} />\r\n-            )}\r\n-\r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingGender} onPress={() => setGenderOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingGender} onPress={saveGender} style={styles.btnPrimary}>\r\n-                {savingGender ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n-\r\n-      {/* Birthday (iOS styled modal) */}\r\n-      <Modal transparent visible={bdayOpen && Platform.OS === \"ios\"} animationType=\"fade\" onRequestClose={() => !savingBday && setBdayOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Select Birthday</Text>\r\n-\r\n-            {bdayValue && (\r\n-              <DateTimePicker\r\n-                mode=\"date\"\r\n-                value={bdayValue}\r\n-                display=\"spinner\"\r\n-                onChange={(_, d) => d && setBdayValue(d)}\r\n-                maximumDate={new Date()}\r\n-              />\r\n-            )}\r\n-\r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingBday} onPress={() => setBdayOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingBday} onPress={saveBday} style={styles.btnPrimary}>\r\n-                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n-\r\n-      {/* Android Date Picker */}\r\n-      {Platform.OS === \"android\" && showAndroidBday && (\r\n-        <DateTimePicker\r\n-          mode=\"date\"\r\n-          value={bdayValue ?? new Date()}\r\n-          display=\"calendar\"\r\n-          maximumDate={new Date()}\r\n-          onChange={(_, date) => {\r\n-            setShowAndroidBday(false);            \r\n-            if (date) {\r\n-              setBdayValue(date);                 \r\n-              setAndroidBdayConfirmOpen(true);    \r\n-            }\r\n-          }}\r\n-        />\r\n-      )}\r\n-\r\n-      <Modal\r\n-        transparent\r\n-        visible={androidBdayConfirmOpen}\r\n-        animationType=\"fade\"\r\n-        onRequestClose={() => !savingBday && setAndroidBdayConfirmOpen(false)}\r\n-      >\r\n-        <View style={{ flex:1, backgroundColor:\"rgba(0,0,0,0.4)\", justifyContent:\"center\", alignItems:\"center\", padding:20 }}>\r\n-          <View style={{ width:\"100%\", maxWidth:420, backgroundColor:\"#fff\", borderRadius:12, padding:16 }}>\r\n-            <Text style={{ fontWeight:\"bold\", fontSize:16, marginBottom:12 }}>Confirm Birthday</Text>\r\n-\r\n-            <Text style={{ fontSize:14, marginBottom:16 }}>\r\n-              {bdayValue\r\n-                ? bdayValue.toLocaleDateString(undefined, { year:\"numeric\", month:\"short\", day:\"2-digit\" })\r\n-                : \"—\"}\r\n-            </Text>\r\n-\r\n-            <View style={{ flexDirection:\"row\", justifyContent:\"flex-end\" }}>\r\n-              <TouchableOpacity\r\n-                disabled={savingBday}\r\n-                onPress={() => setAndroidBdayConfirmOpen(false)}\r\n-                style={{ padding:10, marginRight:8 }}\r\n-              >\r\n-                <Text>Cancel</Text>\r\n-              </TouchableOpacity>\r\n-\r\n-              <TouchableOpacity\r\n-                disabled={savingBday}\r\n-                onPress={async () => {\r\n-                  await saveBday();                 // uses your existing saveBday()\r\n-                  setAndroidBdayConfirmOpen(false); // close after save\r\n-                }}\r\n-                style={{ backgroundColor:\"#5089A3\", padding:10, borderRadius:8, minWidth:90, alignItems:\"center\" }}\r\n-              >\r\n-                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n-\r\n-\r\n-\r\n-\r\n-      {/* Phone */}\r\n-      <Modal transparent visible={phoneOpen} animationType=\"fade\" onRequestClose={() => !savingPhone && setPhoneOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Edit Contact Number</Text>\r\n-            <TextInput placeholder=\"Phone number\" placeholderTextColor=\"#A0A0A0\" keyboardType=\"phone-pad\" value={phoneValue} onChangeText={setPhoneValue} style={styles.input} />\r\n-\r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingPhone} onPress={() => setPhoneOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingPhone} onPress={savePhone} style={styles.btnPrimary}>\r\n-                {savingPhone ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n-\r\n-      {/* Address */}\r\n-      <Modal transparent visible={addrOpen} animationType=\"fade\" onRequestClose={() => !savingAddr && setAddrOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Edit Home Address</Text>\r\n-            <TextInput placeholder=\"Home address\" placeholderTextColor=\"#A0A0A0\" value={addrValue} onChangeText={setAddrValue} style={styles.input} />\r\n-\r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingAddr} onPress={() => setAddrOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingAddr} onPress={saveAddr} style={styles.btnPrimary}>\r\n-                {savingAddr ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n-\r\n-      {/* Vehicle details */}\r\n-      <Modal transparent visible={vehOpen} animationType=\"fade\" onRequestClose={() => !savingVeh && setVehOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Vehicle / Franchise</Text>\r\n-\r\n-            <TextInput placeholder=\"License Number\" placeholderTextColor=\"#A0A0A0\" value={licenseValue} onChangeText={setLicenseValue} style={styles.input} />\r\n-            <TextInput placeholder=\"Franchise Number\" placeholderTextColor=\"#A0A0A0\" value={franchiseValue} onChangeText={setFranchiseValue} style={styles.input} />\r\n-            <TextInput placeholder=\"TODA Name\" placeholderTextColor=\"#A0A0A0\" value={todaValue} onChangeText={setTodaValue} style={styles.input} />\r\n-\r\n-            <Text style={{ marginTop: 8, marginBottom: 6, fontWeight: \"600\" }}>Sector</Text>\r\n-            {SECTORS.map((s) => (\r\n-              <TouchableOpacity key={s} onPress={() => setSectorValue(s)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:6 }}>\r\n-                <View style={styles.radioOuter}>{sectorValue === s ? <View style={styles.radioInner} /> : null}</View>\r\n-                <Text>{s}</Text>\r\n-              </TouchableOpacity>\r\n-            ))}\r\n-\r\n-            <Text style={{ marginTop: 12, marginBottom: 6, fontWeight: \"600\" }}>Experience</Text>\r\n-            {EXP_YEARS.map((e) => (\r\n-              <TouchableOpacity key={e} onPress={() => setExpValue(e)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:6 }}>\r\n-                <View style={styles.radioOuter}>{expValue === e ? <View style={styles.radioInner} /> : null}</View>\r\n-                <Text>{e}</Text>\r\n-              </TouchableOpacity>\r\n-            ))}\r\n-\r\n-            <View style={[styles.modalBtns, { marginTop: 12 }]}>\r\n-              <TouchableOpacity disabled={savingVeh} onPress={() => setVehOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingVeh} onPress={saveVeh} style={styles.btnPrimary}>\r\n-                {savingVeh ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n-\r\n-    </View>\r\n-  );\r\n-}\r\n-\r\n-const styles = StyleSheet.create({\r\n-  container: { flex: 1, backgroundColor: \"#fff\" },\r\n-  profileContainer: { alignItems: \"center\", paddingTop: 50, flexDirection:\"row\", marginHorizontal:20, justifyContent: \"space-between\"},\r\n-  profileImage: { width: 100, height: 100, borderRadius: 50},\r\n-  username: { fontSize: 18, fontWeight: \"bold\", paddingLeft:20 },\r\n-  lagout: { fontSize: 14, fontWeight: \"bold\"},\r\n-  uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n-  accountContainer: { marginTop: 10, paddingHorizontal: 20 },\r\n-  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 10 },\r\n-  infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n-  row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n-  label: { fontSize: 14, color: \"#333\" },\r\n-  value: { fontSize: 14, color: \"#333\", maxWidth: width * 0.55 },\r\n-\r\n-  // modal\r\n-  modalBack: { flex:1, backgroundColor:\"rgba(0,0,0,0.4)\", justifyContent:\"center\", alignItems:\"center\", padding:20 },\r\n-  modalCard: { width:\"100%\", maxWidth:420, backgroundColor:\"#fff\", borderRadius:12, padding:16 },\r\n-  modalTitle: { fontWeight:\"bold\", fontSize:16, marginBottom:8 },\r\n-  input: { borderWidth:1, borderColor:\"#ddd\", borderRadius:8, paddingHorizontal:12, paddingVertical:10, marginBottom:8 },\r\n-\r\n-  modalBtns: { flexDirection:\"row\", justifyContent:\"flex-end\", gap: 12 },\r\n-  btnGhost: { paddingVertical:10, paddingHorizontal:14 },\r\n-  btnPrimary: { backgroundColor:\"#5089A3\", paddingVertical:10, paddingHorizontal:14, borderRadius:8, minWidth:90, alignItems:\"center\" },\r\n-\r\n-  radioOuter: { width:18, height:18, borderRadius:9, borderWidth:2, borderColor:\"#5089A3\", alignItems:\"center\", justifyContent:\"center\", marginRight:10 },\r\n-  radioInner: { width:10, height:10, borderRadius:5, backgroundColor:\"#5089A3\" },\r\n-});\r\n"
                },
                {
                    "date": 1761940696428,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,16 +90,30 @@\n   const fetchProfile = async () => {\r\n     try {\r\n       const driverId = await AsyncStorage.getItem(\"driverId\");\r\n       if (!driverId) return;\r\n-      const response = await fetch(`${API_BASE_URL}/api/driver/${driverId}`);\r\n-      const result = await response.json();\r\n-      if (result.driver) setProfile(result.driver);\r\n-    } catch (error) {\r\n-      console.error(\"❌ Failed to fetch driver profile:\", error);\r\n+\r\n+      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}`, {\r\n+        headers: { Accept: \"application/json\" },\r\n+      });\r\n+      const j = await res.json();\r\n+\r\n+      if (res.ok && j?.driver) {\r\n+        const d = j.driver;\r\n+        // normalize selfie field for UI\r\n+        setProfile({\r\n+          ...d,\r\n+          selfieImage: (d.selfieImage || d.selfie || null)?.toString().trim() || null,\r\n+        });\r\n+      } else {\r\n+        console.warn(\"⚠️ fetchProfile not ok:\", j);\r\n+      }\r\n+    } catch (e) {\r\n+      console.error(\"❌ Failed to fetch driver profile:\", e);\r\n     }\r\n   };\r\n \r\n+\r\n   useFocusEffect(\r\n     React.useCallback(() => {\r\n       fetchProfile();\r\n     }, [])\r\n"
                },
                {
                    "date": 1762443171303,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,826 +1,346 @@\n-import React, { useState } from \"react\";\r\n+// app/homedriver/dprofile.tsx\r\n+import React, { useEffect, useState } from \"react\";\r\n import {\r\n-  View, Text, StyleSheet, Dimensions, TouchableOpacity, Image, Alert,\r\n-  Platform, ActionSheetIOS, Modal, TextInput, ActivityIndicator, ScrollView\r\n+  View, Text, StyleSheet, Dimensions, TouchableOpacity, Image, Alert, ScrollView,\r\n+  ActionSheetIOS, Platform, Modal\r\n } from \"react-native\";\r\n-import { Ionicons, MaterialIcons } from \"@expo/vector-icons\";\r\n-import { router } from 'expo-router';\r\n-import AsyncStorage from '@react-native-async-storage/async-storage';\r\n-import * as ImagePicker from \"expo-image-picker\";\r\n-import { ImagePickerAsset } from \"expo-image-picker\";\r\n+import AsyncStorage from \"@react-native-async-storage/async-storage\";\r\n+import { Ionicons } from \"@expo/vector-icons\";\r\n import { API_BASE_URL } from \"../../config\";\r\n-import { useFocusEffect } from \"@react-navigation/native\";\r\n-import DateTimePicker from \"@react-native-community/datetimepicker\";\r\n-import { clearAuth } from \"../utils/authStorage\";\r\n+import { useNavigation } from \"@react-navigation/native\";\r\n+import { router } from \"expo-router\";\r\n \r\n const { width } = Dimensions.get(\"window\");\r\n+type WindowKey = \"today\" | \"7d\" | \"30d\" | \"overall\";\r\n+type ReportKey = \"day\" | \"week\" | \"month\" | \"overall\";\r\n \r\n-const asFile = (a: ImagePickerAsset | null, fallback = \"photo.jpg\") =>\r\n-  a\r\n-    ? ({\r\n-        uri: a.uri,\r\n-        name: (a as any).fileName || fallback,\r\n-        type: (a as any).mimeType || \"image/jpeg\",\r\n-      } as any)\r\n-    : null;\r\n-\r\n-\r\n-// enums (mirror backend)\r\n-const SECTORS = [\"East\", \"West\", \"North\", \"South\", \"Other\"] as const;\r\n-const EXP_YEARS = [\"1-5 taon\", \"6-10 taon\", \"16-20 taon\", \"20 taon pataas\"] as const;\r\n-\r\n export default function DProfile() {\r\n-  const [profile, setProfile] = useState<any>(null);\r\n-  const [selfieImage, setProfileImage] = useState<ImagePickerAsset | null>(null);\r\n-  const [emailSending, setEmailSending] = useState(false);\r\n+  const navigation = useNavigation<any>();\r\n \r\n-  // Modals state\r\n-  const [nameOpen, setNameOpen] = useState(false);\r\n-  const [firstNameEdit, setFirstNameEdit] = useState(\"\");\r\n-  const [middleNameEdit, setMiddleNameEdit] = useState(\"\");\r\n-  const [lastNameEdit, setLastNameEdit] = useState(\"\");\r\n-  const [savingName, setSavingName] = useState(false);\r\n+  const [driverId, setDriverId] = useState<string | null>(null);\r\n \r\n-  const [genderOpen, setGenderOpen] = useState(false);\r\n-  const [genderChoice, setGenderChoice] = useState<string>(\"\");\r\n-  const [genderOther, setGenderOther] = useState(\"\");\r\n-  const [savingGender, setSavingGender] = useState(false);\r\n+  const [profile, setProfile] = useState<{name:string; selfieUrl?:string|null; avgRating:number; ratingCount:number; totalTrips:number} | null>(null);\r\n+  const [kpis, setKpis] = useState<any>(null);\r\n+  const [daily, setDaily] = useState<any[]>([]);\r\n+  const [monthly, setMonthly] = useState<any[]>([]);\r\n+  const [reportRows, setReportRows] = useState<any[]>([]);\r\n \r\n-  const [bdayOpen, setBdayOpen] = useState(false);           // if you don’t already have it\r\n-  const [bdayValue, setBdayValue] = useState<Date | null>(null);\r\n-  const [savingBday, setSavingBday] = useState(false);\r\n-  const [showAndroidBday, setShowAndroidBday] = useState(false);\r\n-  const [androidBdayConfirmOpen, setAndroidBdayConfirmOpen] = useState(false);\r\n+  const [win, setWin] = useState<WindowKey>(\"7d\");\r\n+  const [reportWin, setReportWin] = useState<ReportKey>(\"day\");\r\n+  const [menuOpen, setMenuOpen] = useState(false); // android fallback\r\n \r\n-  const [phoneOpen, setPhoneOpen] = useState(false);\r\n-  const [phoneValue, setPhoneValue] = useState(\"\");\r\n-  const [savingPhone, setSavingPhone] = useState(false);\r\n+  // ---- load driver id ----\r\n+  useEffect(() => {\r\n+    AsyncStorage.getItem(\"driverId\").then(setDriverId);\r\n+  }, []);\r\n \r\n-  const [addrOpen, setAddrOpen] = useState(false);\r\n-  const [addrValue, setAddrValue] = useState(\"\");\r\n-  const [savingAddr, setSavingAddr] = useState(false);\r\n+  // ---- fetchers ----\r\n+  const fetchProfile = async (id: string) => {\r\n+    const r = await fetch(`${API_BASE_URL}/api/stats/driver/${id}/profile`);\r\n+    const j = await r.json();\r\n+    if (!r.ok) throw new Error(j?.message || \"profile failed\");\r\n+    setProfile(j);\r\n+  };\r\n \r\n-  const [vehOpen, setVehOpen] = useState(false);\r\n-  const [franchiseValue, setFranchiseValue] = useState(\"\");\r\n-  const [todaValue, setTodaValue] = useState(\"\");\r\n-  const [sectorValue, setSectorValue] = useState<string>(\"\");\r\n-  const [expValue, setExpValue] = useState<string>(\"\");\r\n-  const [licenseValue, setLicenseValue] = useState(\"\");\r\n-  const [savingVeh, setSavingVeh] = useState(false);\r\n-\r\n-  const resendDriverEmail = async () => {\r\n-    if (!profile?.email) return Alert.alert(\"Error\", \"No email on file.\");\r\n-    try {\r\n-      setEmailSending(true);\r\n-      const r = await fetch(`${API_BASE_URL}/api/auth/driver/resend-verification`, {\r\n-        method: \"POST\",\r\n-        headers: { \"Content-Type\": \"application/json\" },\r\n-        body: JSON.stringify({ email: profile.email }),\r\n-      });\r\n-      const j = await r.json();\r\n-      if (r.ok) Alert.alert(\"Sent\", j.message || \"Verification email sent. Check your Spam Mail\");\r\n-      else Alert.alert(\"Error\", j.message || j.error || \"Failed to send email.\");\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Network error\");\r\n-    } finally {\r\n-      setEmailSending(false);\r\n-    }\r\n+  const fetchSummary = async (id: string, windowKey: WindowKey) => {\r\n+    const r = await fetch(`${API_BASE_URL}/api/stats/driver/${id}/summary?window=${windowKey}`);\r\n+    const j = await r.json();\r\n+    if (!r.ok) throw new Error(j?.message || \"summary failed\");\r\n+    setKpis(j.kpis);\r\n+    setDaily(j.daily || []);\r\n   };\r\n \r\n-  const fetchProfile = async () => {\r\n-    try {\r\n-      const driverId = await AsyncStorage.getItem(\"driverId\");\r\n-      if (!driverId) return;\r\n-\r\n-      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}`, {\r\n-        headers: { Accept: \"application/json\" },\r\n-      });\r\n-      const j = await res.json();\r\n-\r\n-      if (res.ok && j?.driver) {\r\n-        const d = j.driver;\r\n-        // normalize selfie field for UI\r\n-        setProfile({\r\n-          ...d,\r\n-          selfieImage: (d.selfieImage || d.selfie || null)?.toString().trim() || null,\r\n-        });\r\n-      } else {\r\n-        console.warn(\"⚠️ fetchProfile not ok:\", j);\r\n-      }\r\n-    } catch (e) {\r\n-      console.error(\"❌ Failed to fetch driver profile:\", e);\r\n-    }\r\n+  const fetchMonthly = async (id: string) => {\r\n+    const year = new Date().getFullYear();\r\n+    const r = await fetch(`${API_BASE_URL}/api/stats/driver/${id}/monthly?year=${year}`);\r\n+    const j = await r.json();\r\n+    if (!r.ok) throw new Error(j?.message || \"monthly failed\");\r\n+    setMonthly(j.months || []);\r\n   };\r\n \r\n-\r\n-  useFocusEffect(\r\n-    React.useCallback(() => {\r\n-      fetchProfile();\r\n-    }, [])\r\n-  );\r\n-\r\n-  // ---- Selfie upload (unchanged) ----\r\n-  const pickSelfieImage = async () => {\r\n-    if (Platform.OS === \"ios\") {\r\n-      ActionSheetIOS.showActionSheetWithOptions(\r\n-        { options: [\"Take a Photo\", \"Choose from Gallery\", \"Cancel\"], cancelButtonIndex: 2 },\r\n-        async (buttonIndex) => {\r\n-          if (buttonIndex === 0) {\r\n-            const result = await ImagePicker.launchCameraAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n-            if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n-          } else if (buttonIndex === 1) {\r\n-            const result = await ImagePicker.launchImageLibraryAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n-            if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n-          }\r\n-        }\r\n-      );\r\n-    } else {\r\n-      Alert.alert(\"Select Option\", \"\", [\r\n-        { text: \"Take a Photo\", onPress: async () => {\r\n-          const result = await ImagePicker.launchCameraAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n-          if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n-        }},\r\n-        { text: \"Choose from Gallery\", onPress: async () => {\r\n-          const result = await ImagePicker.launchImageLibraryAsync({ mediaTypes: ImagePicker.MediaTypeOptions.Images, allowsEditing: true, quality: 1 });\r\n-          if (!result.canceled && result.assets.length > 0) setProfileImage(result.assets[0]);\r\n-        }},\r\n-        { text: \"Cancel\", style: \"cancel\" },\r\n-      ]);\r\n-    }\r\n+  const fetchReport = async (id: string, windowKey: ReportKey) => {\r\n+    const r = await fetch(`${API_BASE_URL}/api/stats/driver/${id}/report?window=${windowKey}`);\r\n+    const j = await r.json();\r\n+    if (!r.ok) throw new Error(j?.message || \"report failed\");\r\n+    setReportRows(j.rows || []);\r\n   };\r\n \r\n-  const handleUploadSelfie = async () => {\r\n-    if (!selfieImage) {\r\n-      Alert.alert(\"Error\", \"Please select an image first.\");\r\n-      return;\r\n-    }\r\n-\r\n-    try {\r\n-      const driverId = await AsyncStorage.getItem(\"driverId\");\r\n-      if (!driverId) {\r\n-        Alert.alert(\"Error\", \"Missing driver ID.\");\r\n-        return;\r\n+  useEffect(() => {\r\n+    if (!driverId) return;\r\n+    (async () => {\r\n+      try {\r\n+        await Promise.all([\r\n+          fetchProfile(driverId),\r\n+          fetchSummary(driverId, win),\r\n+          fetchMonthly(driverId),\r\n+          fetchReport(driverId, reportWin),\r\n+        ]);\r\n+      } catch (e:any) {\r\n+        Alert.alert(\"Stats\", e.message || \"Failed to load stats\");\r\n       }\r\n+    })();\r\n+  }, [driverId]);\r\n \r\n-      const fd = new FormData();\r\n-      const S = asFile(selfieImage, \"selfie.jpg\");\r\n-      if (S) fd.append(\"selfie\", S); // backend expects \"selfie\"\r\n+  // refresh when window changes\r\n+  useEffect(() => {\r\n+    if (!driverId) return;\r\n+    fetchSummary(driverId, win).catch(() => {});\r\n+  }, [win, driverId]);\r\n \r\n-      const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}/photo/selfie`, {\r\n-        method: \"POST\",\r\n-        headers: { Accept: \"application/json\" }, // let RN set the multipart boundary\r\n-        body: fd,\r\n-      });\r\n+  useEffect(() => {\r\n+    if (!driverId) return;\r\n+    fetchReport(driverId, reportWin).catch(() => {});\r\n+  }, [reportWin, driverId]);\r\n \r\n-      const text = await res.text();\r\n-      let j: any;\r\n-      try { j = JSON.parse(text); } catch { throw new Error(text || \"Non-JSON response\"); }\r\n-\r\n-      if (!res.ok) throw new Error(j?.error || j?.message || \"Upload failed\");\r\n-\r\n-      // Update local profile with the returned driver doc (now has new Cloudinary URL)\r\n-      setProfile(j.driver);\r\n-      setProfileImage(null);\r\n-      Alert.alert(\"Success\", \"Profile image updated!\");\r\n-    } catch (e: any) {\r\n-      console.error(\"❌ Upload error:\", e);\r\n-      Alert.alert(\"Error\", e.message || \"Something went wrong. Try again.\");\r\n-    }\r\n-  };\r\n-\r\n-\r\n-  // ---- Helpers ----\r\n-  const fmtDate = (iso?: string) => {\r\n-    if (!iso) return null;\r\n-    const d = new Date(iso);\r\n-    if (Number.isNaN(d.getTime())) return null;\r\n-    return d.toLocaleDateString(undefined, { year: \"numeric\", month: \"short\", day: \"2-digit\" });\r\n-  };\r\n-\r\n-  const patchDriver = async (payload: Record<string, any>) => {\r\n-    const driverId = await AsyncStorage.getItem(\"driverId\");\r\n-    if (!driverId) throw new Error(\"Missing driverId\");\r\n-    const res = await fetch(`${API_BASE_URL}/api/driver/${driverId}`, {\r\n-      method: \"PATCH\",\r\n-      headers: { \"Content-Type\": \"application/json\" },\r\n-      body: JSON.stringify(payload),\r\n-    });\r\n-    const j = await res.json();\r\n-    if (!res.ok) throw new Error(j?.message || \"Update failed\");\r\n-    setProfile(j.driver);\r\n-  };\r\n-\r\n-  // ---- Name modal ----\r\n-  const openName = () => {\r\n-    setFirstNameEdit(profile?.driverFirstName || \"\");\r\n-    setMiddleNameEdit(profile?.driverMiddleName || \"\");\r\n-    setLastNameEdit(profile?.driverLastName || \"\");\r\n-    setNameOpen(true);\r\n-  };\r\n-  const saveName = async () => {\r\n+  // ---- logout (AsyncStorage only) ----\r\n+  const handleLogout = async () => {\r\n     try {\r\n-      setSavingName(true);\r\n-      await patchDriver({\r\n-        driverFirstName: firstNameEdit.trim(),\r\n-        driverMiddleName: middleNameEdit.trim(),\r\n-        driverLastName: lastNameEdit.trim(),\r\n-      });\r\n-      setNameOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save name\");\r\n-    } finally {\r\n-      setSavingName(false);\r\n+      await AsyncStorage.removeItem(\"driverId\");\r\n+      Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n+      // same pattern you used before\r\n+      router.replace(\"../login_and_reg/dlogin\");\r\n+    } catch (error:any) {\r\n+      Alert.alert(\"Error\", error.message || \"Failed to log out.\");\r\n     }\r\n   };\r\n-  const selfieUri =\r\n-    selfieImage?.uri ??\r\n-    profile?.selfieImage ??\r\n-    profile?.selfie ??\r\n-    null;\r\n \r\n-  // ---- Gender modal ----\r\n-  const openGender = () => {\r\n-    const current = profile?.gender || \"\";\r\n-    const known = [\"Male\",\"Female\",\"Nonbinary\",\"Prefer not to say\"];\r\n-    if (known.includes(current)) {\r\n-      setGenderChoice(current);\r\n-      setGenderOther(\"\");\r\n-    } else if (current) {\r\n-      setGenderChoice(\"Other\");\r\n-      setGenderOther(current);\r\n+  // ---- menu handlers ----\r\n+  const openMenu = () => {\r\n+    if (Platform.OS === \"ios\") {\r\n+      ActionSheetIOS.showActionSheetWithOptions(\r\n+        {\r\n+          options: [\"Settings\", \"Logout\", \"Cancel\"],\r\n+          cancelButtonIndex: 2,\r\n+          destructiveButtonIndex: 1,\r\n+        },\r\n+        (i) => {\r\n+          if (i === 0) navigation.navigate(\"dsettings\");\r\n+          if (i === 1) handleLogout();\r\n+        }\r\n+      );\r\n     } else {\r\n-      setGenderChoice(\"\");\r\n-      setGenderOther(\"\");\r\n+      setMenuOpen(true);\r\n     }\r\n-    setGenderOpen(true);\r\n   };\r\n-  const saveGender = async () => {\r\n-    const value = genderChoice === \"Other\" ? genderOther.trim() : genderChoice;\r\n-    if (!value) return Alert.alert(\"Gender\", \"Please choose an option.\");\r\n-    if (genderChoice === \"Other\" && !genderOther.trim()) {\r\n-      return Alert.alert(\"Gender\", \"Please enter a custom gender.\");\r\n-    }\r\n-    try {\r\n-      setSavingGender(true);\r\n-      await patchDriver({ gender: value });\r\n-      setGenderOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save gender\");\r\n-    } finally {\r\n-      setSavingGender(false);\r\n-    }\r\n-  };\r\n \r\n-  // ---- Birthday modal / picker ----\r\n-  const openBday = () => {\r\n-    const d = profile?.driverBirthdate ? new Date(profile.driverBirthdate) : null;\r\n-    const initial = d && !Number.isNaN(d.getTime()) ? d : new Date();\r\n-    setBdayValue(initial);\r\n-\r\n-    if (Platform.OS === \"android\") {\r\n-      setShowAndroidBday(true);               \r\n-    } else {\r\n-      setBdayOpen(true);                      \r\n-    }\r\n-  };\r\n-\r\n-\r\n-  const saveBday = async () => {\r\n-    if (!bdayValue) return;\r\n-    const yyyy = bdayValue.getFullYear();\r\n-    const mm = String(bdayValue.getMonth()+1).padStart(2,\"0\");\r\n-    const dd = String(bdayValue.getDate()).padStart(2,\"0\");\r\n-    const iso = `${yyyy}-${mm}-${dd}`;\r\n-    try {\r\n-      setSavingBday(true);\r\n-      await patchDriver({ driverBirthdate: iso });\r\n-      setBdayOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save birthday\");\r\n-    } finally {\r\n-      setSavingBday(false);\r\n-    }\r\n-  };\r\n-\r\n-  // ---- Phone ----\r\n-  const openPhone = () => {\r\n-    setPhoneValue(profile?.driverPhone || \"\");\r\n-    setPhoneOpen(true);\r\n-  };\r\n-  const savePhone = async () => {\r\n-    if (!phoneValue.trim()) return Alert.alert(\"Phone\", \"Enter a phone number.\");\r\n-    try {\r\n-      setSavingPhone(true);\r\n-      await patchDriver({ driverPhone: phoneValue.trim() });\r\n-      setPhoneOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save phone\");\r\n-    } finally {\r\n-      setSavingPhone(false);\r\n-    }\r\n-  };\r\n-\r\n-  // ---- Address ----\r\n-  const openAddr = () => {\r\n-    setAddrValue(profile?.homeAddress || \"\");\r\n-    setAddrOpen(true);\r\n-  };\r\n-  const saveAddr = async () => {\r\n-    try {\r\n-      setSavingAddr(true);\r\n-      await patchDriver({ homeAddress: addrValue.trim() });\r\n-      setAddrOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save address\");\r\n-    } finally {\r\n-      setSavingAddr(false);\r\n-    }\r\n-  };\r\n-\r\n-  // ---- Vehicle block (franchise/toda/sector/experience/licenseId) ----\r\n-  const openVeh = () => {\r\n-    setFranchiseValue(profile?.franchiseNumber || \"\");\r\n-    setTodaValue(profile?.todaName || \"\");\r\n-    setSectorValue(profile?.sector || \"\");\r\n-    setExpValue(profile?.experienceYears || \"\");\r\n-    setLicenseValue(profile?.licenseId || \"\");\r\n-    setVehOpen(true);\r\n-  };\r\n-  const saveVeh = async () => {\r\n-    if (sectorValue && !SECTORS.includes(sectorValue as any)) {\r\n-      return Alert.alert(\"Sector\", \"Please select a valid sector.\");\r\n-    }\r\n-    if (expValue && !EXP_YEARS.includes(expValue as any)) {\r\n-      return Alert.alert(\"Experience\", \"Please select a valid experience range.\");\r\n-    }\r\n-    try {\r\n-      setSavingVeh(true);\r\n-      await patchDriver({\r\n-        franchiseNumber: franchiseValue.trim(),\r\n-        todaName: todaValue.trim(),\r\n-        sector: sectorValue.trim(),\r\n-        experienceYears: expValue.trim(),\r\n-        licenseId: licenseValue.trim(),\r\n-      });\r\n-      setVehOpen(false);\r\n-    } catch (e:any) {\r\n-      Alert.alert(\"Error\", e.message || \"Failed to save vehicle details\");\r\n-    } finally {\r\n-      setSavingVeh(false);\r\n-    }\r\n-  };\r\n-\r\n-  const handleLogout = async () => {\r\n-    try {\r\n-      await AsyncStorage.removeItem(\"driverId\");\r\n-      await clearAuth();\r\n-      Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n-      router.replace(\"../login_and_reg/dlogin\");\r\n-    } catch (error) {\r\n-      console.error(\"❌ Logout error:\", error);\r\n-      Alert.alert(\"Error\", \"Failed to log out. Try again.\");\r\n-    }\r\n-  };\r\n-\r\n   return (\r\n     <View style={styles.container}>\r\n-      <View style={styles.profileContainer}>\r\n-        <View style={styles.row}>\r\n-          <TouchableOpacity onPress={pickSelfieImage}>\r\n-            <Image\r\n-              key={(selfieUri || \"empty\") + \"\"}     \r\n-              source={\r\n-                selfieUri\r\n-                  ? { uri: `${String(selfieUri).trim()}?t=${Date.now()}` } \r\n-                  : require(\"../../assets/images/profile-placeholder.jpg\")\r\n-              }\r\n-              defaultSource={require(\"../../assets/images/profile-placeholder.jpg\")} \r\n-              style={styles.profileImage}\r\n-            />\r\n-          </TouchableOpacity>\r\n+      {/* Header */}\r\n+      <View style={styles.header}>\r\n+        <View style={{flexDirection:\"row\", alignItems:\"center\"}}>\r\n+          <Image\r\n+            source={\r\n+              profile?.selfieUrl\r\n+                ? { uri: `${profile.selfieUrl}?t=${Date.now()}` }\r\n+                : require(\"../../assets/images/profile-placeholder.jpg\") // ✅ fixed relative path\r\n+            }\r\n+            style={styles.avatar}\r\n+          />\r\n           <View>\r\n-            <Text style={styles.username}>\r\n-              {[profile?.driverFirstName, profile?.driverLastName].filter(Boolean).join(\" \")}\r\n+            <Text style={styles.name} numberOfLines={1}>\r\n+              {profile?.name || \"Driver\"}\r\n             </Text>\r\n-            {selfieImage && (\r\n-              <TouchableOpacity style={styles.uploadButton} onPress={handleUploadSelfie}>\r\n-                <Text style={{ color: \"#fff\" }}>Upload Profile Pic</Text>\r\n-              </TouchableOpacity>\r\n-            )}\r\n+            <Text style={styles.rating}>\r\n+              ★ {profile?.avgRating?.toFixed?.(2) || \"0.00\"} ({profile?.ratingCount || 0})\r\n+            </Text>\r\n           </View>\r\n         </View>\r\n-        <TouchableOpacity style={styles.row} onPress={handleLogout}>\r\n-          <Ionicons name=\"log-out-outline\" size={30} color=\"black\" />\r\n-          <Text style={styles.lagout}>LogOut</Text>\r\n+\r\n+        <TouchableOpacity onPress={openMenu} hitSlop={{ top:10, left:10, right:10, bottom:10 }}>\r\n+          <Ionicons name=\"ellipsis-vertical\" size={24} color=\"#222\" />\r\n         </TouchableOpacity>\r\n       </View>\r\n \r\n-      <ScrollView style={styles.accountContainer} contentContainerStyle={{ paddingBottom: 40 }}>\r\n-        <Text style={styles.sectionTitle}>Personal Information</Text>\r\n-\r\n-        {/* Full Name */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Full Name:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[\r\n-              styles.value,\r\n-              { color: (profile?.driverFirstName || profile?.driverMiddleName || profile?.driverLastName) ? \"#000\" : \"#999\" }\r\n-            ]}>\r\n-              {profile?.driverFirstName || \"\"} {profile?.driverMiddleName || \"\"} {profile?.driverLastName || \"\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openName} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n+      <ScrollView contentContainerStyle={{ paddingBottom: 40 }}>\r\n+        {/* Window Toggle */}\r\n+        <View style={styles.toggleRow}>\r\n+          {([\"today\",\"7d\",\"30d\",\"overall\"] as WindowKey[]).map((w) => (\r\n+            <TouchableOpacity\r\n+              key={w}\r\n+              onPress={() => setWin(w)}\r\n+              style={[styles.toggleBtn, win === w && styles.toggleBtnActive]}\r\n+            >\r\n+              <Text style={[styles.toggleTxt, win === w && styles.toggleTxtActive]}>\r\n+                {w === \"7d\" ? \"7d\" : w}\r\n+              </Text>\r\n             </TouchableOpacity>\r\n-          </View>\r\n+          ))}\r\n         </View>\r\n \r\n-        {/* Gender */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Gender:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.gender ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.gender || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openGender} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n+        {/* KPI Row */}\r\n+        <View style={styles.kpiRow}>\r\n+          <KPI label=\"Income\" value={`₱ ${fmtMoney(kpis?.income)}`} />\r\n+          <KPI label=\"Trips\" value={kpis?.trips ?? 0} />\r\n+          <KPI label=\"Hours\" value={`${(kpis?.hoursOnline ?? 0).toFixed(1)}h`} />\r\n         </View>\r\n-\r\n-        {/* Phone */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Contact Number:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.driverPhone ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.driverPhone || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openPhone} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n+        <View style={styles.kpiRow}>\r\n+          <KPI label=\"Avg Fare\" value={`₱ ${fmtMoney(kpis?.avgFare)}`} />\r\n+          <KPI label=\"Accept\" value={`${pct(kpis?.acceptance)}%`} />\r\n+          <KPI label=\"Cancel\" value={`${pct(kpis?.cancellation)}%`} />\r\n         </View>\r\n \r\n-        {/* Birthday */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Birthday:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.driverBirthdate ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.driverBirthdate ? (fmtDate(profile.driverBirthdate) || profile.driverBirthdate) : \"Not Provided\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openBday} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n+        {/* Charts */}\r\n+        <Text style={styles.sectionTitle}>Monthly Income</Text>\r\n+        <MiniBars data={monthly} />\r\n \r\n-        {/* Email + verify */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Email Address:</Text>\r\n-          <View style={{ alignItems: \"flex-end\" }}>\r\n-            <Text style={[styles.value, { color: profile?.email ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.email || \"Set Now\"}\r\n-            </Text>\r\n-            <View style={{ flexDirection: \"row\", alignItems: \"center\", marginTop: 4 }}>\r\n-              <View style={{\r\n-                paddingHorizontal: 8, paddingVertical: 2, borderRadius: 12,\r\n-                backgroundColor: profile?.isVerified ? \"#E6F7E9\" : \"#FFF4E5\",\r\n-                marginRight: 8,\r\n-              }}>\r\n-                <Text style={{ color: profile?.isVerified ? \"#2E7D32\" : \"#B26A00\", fontSize: 12 }}>\r\n-                  {profile?.isVerified ? \"Verified\" : \"Not verified\"}\r\n-                </Text>\r\n-              </View>\r\n-              {!profile?.isVerified && (\r\n-                <TouchableOpacity\r\n-                  disabled={emailSending}\r\n-                  onPress={resendDriverEmail}\r\n-                  style={{ paddingHorizontal: 10, paddingVertical: 6, borderRadius: 8, backgroundColor: emailSending ? \"#ccc\" : \"#5089A3\" }}\r\n-                >\r\n-                  <Text style={{ color: \"#fff\", fontSize: 12 }}>\r\n-                    {emailSending ? \"Sending...\" : \"Verify email\"}\r\n-                  </Text>\r\n-                </TouchableOpacity>\r\n-              )}\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n+        <Text style={styles.sectionTitle}>Daily Performance</Text>\r\n+        <MiniLine data={daily} metric=\"income\" />\r\n \r\n-        {/* Address */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Home Address:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.homeAddress ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.homeAddress || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openAddr} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        <Text style={styles.sectionTitle}>Vehicle Details</Text>\r\n-\r\n-        {/* License ID */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>License Number:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.licenseId ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.licenseId || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Franchise */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Franchise Number:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.franchiseNumber ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.franchiseNumber || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* TODA */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>TODA Name:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.todaName ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.todaName || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Sector */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Sector:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.sector ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.sector || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-\r\n-        {/* Experience */}\r\n-        <View style={styles.infoRow}>\r\n-          <Text style={styles.label}>Experience:</Text>\r\n-          <View style={styles.row}>\r\n-            <Text style={[styles.value, { color: profile?.experienceYears ? \"#000\" : \"#999\" }]}>\r\n-              {profile?.experienceYears || \"Set Now\"}\r\n-            </Text>\r\n-            <TouchableOpacity onPress={openVeh} style={{ marginLeft: 5 }}>\r\n-              <MaterialIcons name=\"edit\" size={20} color=\"#888\" />\r\n-            </TouchableOpacity>\r\n-          </View>\r\n-        </View>\r\n-      </ScrollView>\r\n-\r\n-      {/* ------- Modals ------- */}\r\n-\r\n-      {/* Name */}\r\n-      <Modal transparent visible={nameOpen} animationType=\"fade\" onRequestClose={() => !savingName && setNameOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Edit Name</Text>\r\n-\r\n-            <TextInput placeholder=\"First name\" placeholderTextColor=\"#A0A0A0\" value={firstNameEdit} onChangeText={setFirstNameEdit} style={styles.input} />\r\n-            <TextInput placeholder=\"Middle name (optional)\" placeholderTextColor=\"#A0A0A0\" value={middleNameEdit} onChangeText={setMiddleNameEdit} style={styles.input} />\r\n-            <TextInput placeholder=\"Last name\" placeholderTextColor=\"#A0A0A0\" value={lastNameEdit} onChangeText={setLastNameEdit} style={styles.input} />\r\n-\r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingName} onPress={() => setNameOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingName} onPress={saveName} style={styles.btnPrimary}>\r\n-                {savingName ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n+        {/* Report Table */}\r\n+        <View style={styles.reportHeader}>\r\n+          <Text style={styles.sectionTitle}>Report</Text>\r\n+          <View style={styles.toggleRowSmall}>\r\n+            {([\"day\",\"week\",\"month\",\"overall\"] as ReportKey[]).map((r) => (\r\n+              <TouchableOpacity\r\n+                key={r}\r\n+                onPress={() => setReportWin(r)}\r\n+                style={[styles.toggleSm, reportWin === r && styles.toggleSmActive]}\r\n+              >\r\n+                <Text style={[styles.toggleSmTxt, reportWin === r && styles.toggleSmTxtActive]}>{r}</Text>\r\n               </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n-\r\n-      {/* Gender */}\r\n-      <Modal transparent visible={genderOpen} animationType=\"fade\" onRequestClose={() => !savingGender && setGenderOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Select Gender</Text>\r\n-\r\n-            {[\"Male\",\"Female\",\"Nonbinary\",\"Prefer not to say\",\"Other\"].map((opt) => (\r\n-              <TouchableOpacity key={opt} onPress={() => setGenderChoice(opt)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:8 }}>\r\n-                <View style={styles.radioOuter}>\r\n-                  {genderChoice === opt ? <View style={styles.radioInner} /> : null}\r\n-                </View>\r\n-                <Text>{opt}</Text>\r\n-              </TouchableOpacity>\r\n             ))}\r\n-\r\n-            {genderChoice === \"Other\" && (\r\n-              <TextInput placeholder=\"Enter your gender\" placeholderTextColor=\"#A0A0A0\" value={genderOther} onChangeText={setGenderOther} style={[styles.input, { marginTop:8 }]} />\r\n-            )}\r\n-\r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingGender} onPress={() => setGenderOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingGender} onPress={saveGender} style={styles.btnPrimary}>\r\n-                {savingGender ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n           </View>\r\n         </View>\r\n-      </Modal>\r\n \r\n-      {/* Birthday (iOS styled modal) */}\r\n-      <Modal transparent visible={bdayOpen && Platform.OS === \"ios\"} animationType=\"fade\" onRequestClose={() => !savingBday && setBdayOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Select Birthday</Text>\r\n-\r\n-            {bdayValue && (\r\n-              <DateTimePicker\r\n-                mode=\"date\"\r\n-                value={bdayValue}\r\n-                display=\"spinner\"\r\n-                onChange={(_, d) => d && setBdayValue(d)}\r\n-                maximumDate={new Date()}\r\n-              />\r\n-            )}\r\n-\r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingBday} onPress={() => setBdayOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingBday} onPress={saveBday} style={styles.btnPrimary}>\r\n-                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n+        <View style={styles.table}>\r\n+          {reportRows.map((row) => (\r\n+            <View key={row.key} style={styles.row}>\r\n+              <Text style={styles.cellLeft}>{row.label}</Text>\r\n+              <Text style={styles.cellRight}>\r\n+                {formatCell(row)}\r\n+              </Text>\r\n             </View>\r\n-          </View>\r\n+          ))}\r\n         </View>\r\n-      </Modal>\r\n+      </ScrollView>\r\n \r\n-      {/* Android Date Picker */}\r\n-      {Platform.OS === \"android\" && showAndroidBday && (\r\n-        <DateTimePicker\r\n-          mode=\"date\"\r\n-          value={bdayValue ?? new Date()}\r\n-          display=\"calendar\"\r\n-          maximumDate={new Date()}\r\n-          onChange={(_, date) => {\r\n-            setShowAndroidBday(false);            \r\n-            if (date) {\r\n-              setBdayValue(date);                 \r\n-              setAndroidBdayConfirmOpen(true);    \r\n-            }\r\n-          }}\r\n-        />\r\n-      )}\r\n-\r\n-      <Modal\r\n-        transparent\r\n-        visible={androidBdayConfirmOpen}\r\n-        animationType=\"fade\"\r\n-        onRequestClose={() => !savingBday && setAndroidBdayConfirmOpen(false)}\r\n-      >\r\n-        <View style={{ flex:1, backgroundColor:\"rgba(0,0,0,0.4)\", justifyContent:\"center\", alignItems:\"center\", padding:20 }}>\r\n-          <View style={{ width:\"100%\", maxWidth:420, backgroundColor:\"#fff\", borderRadius:12, padding:16 }}>\r\n-            <Text style={{ fontWeight:\"bold\", fontSize:16, marginBottom:12 }}>Confirm Birthday</Text>\r\n-\r\n-            <Text style={{ fontSize:14, marginBottom:16 }}>\r\n-              {bdayValue\r\n-                ? bdayValue.toLocaleDateString(undefined, { year:\"numeric\", month:\"short\", day:\"2-digit\" })\r\n-                : \"—\"}\r\n-            </Text>\r\n-\r\n-            <View style={{ flexDirection:\"row\", justifyContent:\"flex-end\" }}>\r\n-              <TouchableOpacity\r\n-                disabled={savingBday}\r\n-                onPress={() => setAndroidBdayConfirmOpen(false)}\r\n-                style={{ padding:10, marginRight:8 }}\r\n-              >\r\n-                <Text>Cancel</Text>\r\n-              </TouchableOpacity>\r\n-\r\n-              <TouchableOpacity\r\n-                disabled={savingBday}\r\n-                onPress={async () => {\r\n-                  await saveBday();                 // uses your existing saveBday()\r\n-                  setAndroidBdayConfirmOpen(false); // close after save\r\n-                }}\r\n-                style={{ backgroundColor:\"#5089A3\", padding:10, borderRadius:8, minWidth:90, alignItems:\"center\" }}\r\n-              >\r\n-                {savingBday ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n+      {/* Android menu */}\r\n+      <Modal transparent visible={menuOpen} onRequestClose={() => setMenuOpen(false)}>\r\n+        <TouchableOpacity style={styles.backdrop} onPress={() => setMenuOpen(false)}>\r\n+          <View style={styles.sheet}>\r\n+            <TouchableOpacity\r\n+              style={styles.sheetItem}\r\n+              onPress={() => { setMenuOpen(false); navigation.navigate(\"dsettings\"); }}\r\n+            >\r\n+              <Text style={styles.sheetItemTxt}>Settings</Text>\r\n+            </TouchableOpacity>\r\n+            <TouchableOpacity\r\n+              style={styles.sheetItem}\r\n+              onPress={() => { setMenuOpen(false); handleLogout(); }}\r\n+            >\r\n+              <Text style={[styles.sheetItemTxt, {color:\"#C00\"}]}>Logout</Text>\r\n+            </TouchableOpacity>\r\n           </View>\r\n-        </View>\r\n+        </TouchableOpacity>\r\n       </Modal>\r\n+    </View>\r\n+  );\r\n+}\r\n \r\n+// --- small UI helpers (no external chart lib; lightweight visuals) ---\r\n+function KPI({ label, value }: { label: string; value: any }) {\r\n+  return (\r\n+    <View style={styles.kpi}>\r\n+      <Text style={styles.kpiLabel}>{label}</Text>\r\n+      <Text style={styles.kpiValue}>{String(value)}</Text>\r\n+    </View>\r\n+  );\r\n+}\r\n \r\n-\r\n-\r\n-      {/* Phone */}\r\n-      <Modal transparent visible={phoneOpen} animationType=\"fade\" onRequestClose={() => !savingPhone && setPhoneOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Edit Contact Number</Text>\r\n-            <TextInput placeholder=\"Phone number\" placeholderTextColor=\"#A0A0A0\" keyboardType=\"phone-pad\" value={phoneValue} onChangeText={setPhoneValue} style={styles.input} />\r\n-\r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingPhone} onPress={() => setPhoneOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingPhone} onPress={savePhone} style={styles.btnPrimary}>\r\n-                {savingPhone ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n+function MiniBars({ data }: { data: { month:number; income:number }[] }) {\r\n+  if (!data || !data.length) return <Text style={styles.empty}>No data</Text>;\r\n+  const max = Math.max(1, ...data.map(d => d.income || 0));\r\n+  return (\r\n+    <View style={styles.barsWrap}>\r\n+      {data.map((d, i) => {\r\n+        const h = Math.max(4, (120 * d.income) / max);\r\n+        return (\r\n+          <View key={i} style={styles.barCol}>\r\n+            <View style={[styles.bar, { height: h }]} />\r\n+            <Text style={styles.barLabel}>{d.month}</Text>\r\n           </View>\r\n-        </View>\r\n-      </Modal>\r\n+        );\r\n+      })}\r\n+    </View>\r\n+  );\r\n+}\r\n \r\n-      {/* Address */}\r\n-      <Modal transparent visible={addrOpen} animationType=\"fade\" onRequestClose={() => !savingAddr && setAddrOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Edit Home Address</Text>\r\n-            <TextInput placeholder=\"Home address\" placeholderTextColor=\"#A0A0A0\" value={addrValue} onChangeText={setAddrValue} style={styles.input} />\r\n+function MiniLine({ data, metric }: { data: any[]; metric: \"income\"|\"trips\" }) {\r\n+  if (!data || !data.length) return <Text style={styles.empty}>No data</Text>;\r\n+  const vals = data.map(d => Number(d[metric] || 0));\r\n+  const max = Math.max(1, ...vals);\r\n+  const H = 120, W = width - 40;\r\n+  return (\r\n+    <View style={{ height: H, marginHorizontal: 20 }}>\r\n+      <View style={{ position: \"absolute\", left: 0, right: 0, top: 0, bottom: 0, justifyContent:\"flex-end\" }}>\r\n+        <View style={{ height:1, backgroundColor:\"#EEE\" }} />\r\n+      </View>\r\n+      <View style={{ flex:1, flexDirection:\"row\", alignItems:\"flex-end\" }}>\r\n+        {vals.map((v, i) => {\r\n+          const h = Math.max(2, (H * v) / max);\r\n+          return <View key={i} style={{ width: Math.max(2, W/vals.length - 4), height: h, marginHorizontal:2, backgroundColor:\"#5089A3\", borderRadius:2 }} />;\r\n+        })}\r\n+      </View>\r\n+    </View>\r\n+  );\r\n+}\r\n \r\n-            <View style={styles.modalBtns}>\r\n-              <TouchableOpacity disabled={savingAddr} onPress={() => setAddrOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingAddr} onPress={saveAddr} style={styles.btnPrimary}>\r\n-                {savingAddr ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n+// formatters\r\n+const fmtMoney = (n?: number) =>\r\n+  (Number(n || 0).toFixed(2)).replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n+const pct = (n?: number) => Math.round(Number(n || 0) * 100);\r\n \r\n-      {/* Vehicle details */}\r\n-      <Modal transparent visible={vehOpen} animationType=\"fade\" onRequestClose={() => !savingVeh && setVehOpen(false)}>\r\n-        <View style={styles.modalBack}>\r\n-          <View style={styles.modalCard}>\r\n-            <Text style={styles.modalTitle}>Vehicle / Franchise</Text>\r\n+function formatCell(row: any) {\r\n+  if (row.key === \"income\") return `₱ ${fmtMoney(row.value)}`;\r\n+  if (row.key === \"distance\") return `${Number(row.value || 0).toFixed(1)} km`;\r\n+  if (row.key === \"avgRating\") return `${Number(row.value || 0).toFixed(2)} ★`;\r\n+  if (row.key === \"hoursOnline\") return `${Number(row.value || 0).toFixed(1)} h`;\r\n+  if (row.key === \"acceptance\" || row.key === \"cancellation\") return `${pct(row.value)}%`;\r\n+  return String(row.value ?? \"—\");\r\n+}\r\n \r\n-            <TextInput placeholder=\"License Number\" placeholderTextColor=\"#A0A0A0\" value={licenseValue} onChangeText={setLicenseValue} style={styles.input} />\r\n-            <TextInput placeholder=\"Franchise Number\" placeholderTextColor=\"#A0A0A0\" value={franchiseValue} onChangeText={setFranchiseValue} style={styles.input} />\r\n-            <TextInput placeholder=\"TODA Name\" placeholderTextColor=\"#A0A0A0\" value={todaValue} onChangeText={setTodaValue} style={styles.input} />\r\n+const styles = StyleSheet.create({\r\n+  container: { flex: 1, backgroundColor: \"#fff\" },\r\n+  header: { paddingTop: 50, paddingHorizontal: 20, paddingBottom: 12, flexDirection: \"row\", justifyContent: \"space-between\", alignItems: \"center\" },\r\n+  avatar: { width: 64, height: 64, borderRadius: 32, marginRight: 12, backgroundColor:\"#eee\" },\r\n+  name: { fontSize: 18, fontWeight: \"700\", maxWidth: width * 0.55 },\r\n+  rating: { color: \"#666\", marginTop: 4 },\r\n \r\n-            <Text style={{ marginTop: 8, marginBottom: 6, fontWeight: \"600\" }}>Sector</Text>\r\n-            {SECTORS.map((s) => (\r\n-              <TouchableOpacity key={s} onPress={() => setSectorValue(s)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:6 }}>\r\n-                <View style={styles.radioOuter}>{sectorValue === s ? <View style={styles.radioInner} /> : null}</View>\r\n-                <Text>{s}</Text>\r\n-              </TouchableOpacity>\r\n-            ))}\r\n+  toggleRow: { flexDirection: \"row\", justifyContent: \"space-around\", marginVertical: 8 },\r\n+  toggleBtn: { paddingVertical: 6, paddingHorizontal: 10, borderRadius: 8, borderWidth:1, borderColor:\"#ddd\" },\r\n+  toggleBtnActive: { backgroundColor: \"#5089A3\" },\r\n+  toggleTxt: { color: \"#333\", fontWeight: \"600\" },\r\n+  toggleTxtActive: { color: \"#fff\" },\r\n \r\n-            <Text style={{ marginTop: 12, marginBottom: 6, fontWeight: \"600\" }}>Experience</Text>\r\n-            {EXP_YEARS.map((e) => (\r\n-              <TouchableOpacity key={e} onPress={() => setExpValue(e)} style={{ flexDirection:\"row\", alignItems:\"center\", paddingVertical:6 }}>\r\n-                <View style={styles.radioOuter}>{expValue === e ? <View style={styles.radioInner} /> : null}</View>\r\n-                <Text>{e}</Text>\r\n-              </TouchableOpacity>\r\n-            ))}\r\n+  kpiRow: { flexDirection: \"row\", justifyContent: \"space-around\", marginTop: 8 },\r\n+  kpi: { backgroundColor: \"#F6FAFC\", padding: 12, borderRadius: 12, minWidth: (width-60)/3, alignItems: \"center\" },\r\n+  kpiLabel: { color: \"#555\", fontSize: 12 },\r\n+  kpiValue: { fontSize: 16, fontWeight: \"700\", marginTop: 4 },\r\n \r\n-            <View style={[styles.modalBtns, { marginTop: 12 }]}>\r\n-              <TouchableOpacity disabled={savingVeh} onPress={() => setVehOpen(false)} style={styles.btnGhost}><Text>Cancel</Text></TouchableOpacity>\r\n-              <TouchableOpacity disabled={savingVeh} onPress={saveVeh} style={styles.btnPrimary}>\r\n-                {savingVeh ? <ActivityIndicator color=\"#fff\" /> : <Text style={{ color:\"#fff\" }}>Save</Text>}\r\n-              </TouchableOpacity>\r\n-            </View>\r\n-          </View>\r\n-        </View>\r\n-      </Modal>\r\n+  sectionTitle: { fontWeight: \"700\", fontSize: 16, marginHorizontal: 20, marginTop: 16, marginBottom: 8 },\r\n \r\n-    </View>\r\n-  );\r\n-}\r\n+  barsWrap: { flexDirection: \"row\", alignItems: \"flex-end\", height: 150, paddingHorizontal: 10, marginHorizontal: 10 },\r\n+  barCol: { alignItems: \"center\", justifyContent: \"flex-end\", flex: 1 },\r\n+  bar: { width: 12, backgroundColor: \"#5089A3\", borderRadius: 4 },\r\n+  barLabel: { fontSize: 10, color: \"#666\", marginTop: 4 },\r\n \r\n-const styles = StyleSheet.create({\r\n-  container: { flex: 1, backgroundColor: \"#fff\" },\r\n-  profileContainer: { alignItems: \"center\", paddingTop: 50, flexDirection:\"row\", marginHorizontal:20, justifyContent: \"space-between\"},\r\n-  profileImage: { width: 100, height: 100, borderRadius: 50},\r\n-  username: { fontSize: 18, fontWeight: \"bold\", paddingLeft:20 },\r\n-  lagout: { fontSize: 14, fontWeight: \"bold\"},\r\n-  uploadButton: { backgroundColor: \"#5089A3\", borderRadius: 8, padding: 10, marginTop: 10 },\r\n-  accountContainer: { marginTop: 10, paddingHorizontal: 20 },\r\n-  sectionTitle: { fontWeight: \"bold\", fontSize: 16, marginVertical: 10 },\r\n-  infoRow: { flexDirection: \"row\", justifyContent: \"space-between\", paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\" },\r\n-  row: { flexDirection: \"row\", alignItems: \"center\", justifyContent: \"center\" },\r\n-  label: { fontSize: 14, color: \"#333\" },\r\n-  value: { fontSize: 14, color: \"#333\", maxWidth: width * 0.55 },\r\n+  reportHeader: { marginTop: 12, marginHorizontal: 20, flexDirection: \"row\", justifyContent: \"space-between\", alignItems: \"center\" },\r\n+  toggleRowSmall: { flexDirection: \"row\", gap: 6 },\r\n+  toggleSm: { paddingVertical: 4, paddingHorizontal: 8, borderRadius: 8, borderWidth:1, borderColor:\"#ddd\" },\r\n+  toggleSmActive: { backgroundColor:\"#5089A3\" },\r\n+  toggleSmTxt: { fontSize: 12, color:\"#333\" },\r\n+  toggleSmTxtActive: { color:\"#fff\" },\r\n \r\n-  // modal\r\n-  modalBack: { flex:1, backgroundColor:\"rgba(0,0,0,0.4)\", justifyContent:\"center\", alignItems:\"center\", padding:20 },\r\n-  modalCard: { width:\"100%\", maxWidth:420, backgroundColor:\"#fff\", borderRadius:12, padding:16 },\r\n-  modalTitle: { fontWeight:\"bold\", fontSize:16, marginBottom:8 },\r\n-  input: { borderWidth:1, borderColor:\"#ddd\", borderRadius:8, paddingHorizontal:12, paddingVertical:10, marginBottom:8 },\r\n+  table: { marginTop: 8, marginHorizontal: 20, borderRadius: 12, borderWidth: 1, borderColor: \"#eee\" },\r\n+  row: { paddingHorizontal: 12, paddingVertical: 10, borderBottomWidth: 1, borderBottomColor: \"#eee\", flexDirection:\"row\", justifyContent:\"space-between\" },\r\n+  cellLeft: { color: \"#333\" },\r\n+  cellRight: { fontWeight: \"700\" },\r\n \r\n-  modalBtns: { flexDirection:\"row\", justifyContent:\"flex-end\", gap: 12 },\r\n-  btnGhost: { paddingVertical:10, paddingHorizontal:14 },\r\n-  btnPrimary: { backgroundColor:\"#5089A3\", paddingVertical:10, paddingHorizontal:14, borderRadius:8, minWidth:90, alignItems:\"center\" },\r\n+  empty: { marginHorizontal: 20, color: \"#888\" },\r\n \r\n-  radioOuter: { width:18, height:18, borderRadius:9, borderWidth:2, borderColor:\"#5089A3\", alignItems:\"center\", justifyContent:\"center\", marginRight:10 },\r\n-  radioInner: { width:10, height:10, borderRadius:5, backgroundColor:\"#5089A3\" },\r\n+  // android sheet\r\n+  backdrop: { flex:1, backgroundColor:\"rgba(0,0,0,0.25)\", justifyContent:\"flex-end\" },\r\n+  sheet: { backgroundColor:\"#fff\", paddingBottom: 20, borderTopLeftRadius: 16, borderTopRightRadius: 16 },\r\n+  sheetItem: { padding: 16 },\r\n+  sheetItemTxt: { fontSize: 16, color: \"#222\", textAlign:\"center\" },\r\n });\r\n"
                },
                {
                    "date": 1762443679792,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -97,9 +97,9 @@\n     try {\r\n       await AsyncStorage.removeItem(\"driverId\");\r\n       Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n       // same pattern you used before\r\n-      router.replace(\"../login_and_reg/dlogin\");\r\n+      router.replace(\"../../login_and_reg/dlogin\");\r\n     } catch (error:any) {\r\n       Alert.alert(\"Error\", error.message || \"Failed to log out.\");\r\n     }\r\n   };\r\n"
                },
                {
                    "date": 1762462362324,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,9 +96,8 @@\n   const handleLogout = async () => {\r\n     try {\r\n       await AsyncStorage.removeItem(\"driverId\");\r\n       Alert.alert(\"Logged out\", \"You have been logged out successfully.\");\r\n-      // same pattern you used before\r\n       router.replace(\"../../login_and_reg/dlogin\");\r\n     } catch (error:any) {\r\n       Alert.alert(\"Error\", error.message || \"Failed to log out.\");\r\n     }\r\n"
                },
                {
                    "date": 1762470068518,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -173,10 +173,10 @@\n           <KPI label=\"Hours\" value={`${(kpis?.hoursOnline ?? 0).toFixed(1)}h`} />\r\n         </View>\r\n         <View style={styles.kpiRow}>\r\n           <KPI label=\"Avg Fare\" value={`₱ ${fmtMoney(kpis?.avgFare)}`} />\r\n-          <KPI label=\"Accept\" value={`${pct(kpis?.acceptance)}%`} />\r\n-          <KPI label=\"Cancel\" value={`${pct(kpis?.cancellation)}%`} />\r\n+          <KPI label=\"Complete\" value={`${pct(kpis?.completeRate)}%`} />\r\n+          <KPI label=\"Cancel\" value={`${pct(kpis?.cancelRate)}%`} />\r\n         </View>\r\n \r\n         {/* Charts */}\r\n         <Text style={styles.sectionTitle}>Monthly Income</Text>\r\n"
                }
            ],
            "date": 1748350667311,
            "name": "Commit-0",
            "content": "import React from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Dimensions } from 'react-native';\r\nimport { Ionicons, MaterialIcons } from \"@expo/vector-icons\";\r\nimport { router } from 'expo-router'; \r\nconst { width, height } = Dimensions.get(\"window\");\r\n\r\nexport default function PHistory() {\r\n  return (\r\n    <View style={styles.container}>\r\n        <Text>Passenger Profile Page</Text>\r\n        <View style={styles.bottomNav}>\r\n            <TouchableOpacity onPress={() => router.push(\"/homedriver/dhome\")}><Ionicons name=\"home-outline\" size={30} color=\"black\" /><Text>Home</Text></TouchableOpacity>\r\n            <TouchableOpacity onPress={() => router.push(\"/homedriver/dhistory\")}><Ionicons name=\"document-text-outline\" size={30} color=\"black\" /><Text>History</Text></TouchableOpacity>\r\n            <TouchableOpacity onPress={() => router.push(\"/homedriver/dchats\")}><Ionicons name=\"chatbubbles\" size={30} color=\"black\" /><Text>Chats</Text></TouchableOpacity>\r\n            <TouchableOpacity onPress={() => router.push(\"/homedriver/dprofile\")}><Ionicons name=\"person-outline\" size={30} color=\"black\" /><Text>Profile</Text></TouchableOpacity>\r\n        </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: { flex: 1, justifyContent: 'center', alignItems: 'center' },\r\n  bottomNav: { position: \"absolute\", bottom: 0, flexDirection: \"row\", justifyContent: \"space-around\", width: width, height: 70, backgroundColor: \"white\", borderTopLeftRadius: 30, borderTopRightRadius: 30, alignItems: \"center\", borderWidth: 1, borderColor: \"black\" },\r\n});\r\n"
        }
    ]
}